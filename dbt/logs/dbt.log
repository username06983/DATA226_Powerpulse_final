[0m23:50:39.100078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8b8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafff2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa1e420>]}


============================== 23:50:39.102967 | b78639fa-2d9b-4734-a400-6db231f679a2 ==============================
[0m23:50:39.102967 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:50:39.103391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m23:50:39.447801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b78639fa-2d9b-4734-a400-6db231f679a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a603650>]}
[0m23:50:39.493265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b78639fa-2d9b-4734-a400-6db231f679a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8756d0>]}
[0m23:50:39.493614 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m23:50:39.496738 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:50:39.497349 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:50:39.497651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b78639fa-2d9b-4734-a400-6db231f679a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31ae750>]}
[0m23:50:39.944832 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_prices' in the 'models' section of file 'models/schema.yml'
[0m23:50:39.945678 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'daily_change' in the 'models' section of file 'models/schema.yml'
[0m23:50:40.034673 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.energy_consumption_analytics.snapshot_stock_prices' (snapshots/symbols.sql) depends on a node named 'stg_prices' which was not found
[0m23:50:40.035391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.95808077, "process_user_time": 2.652593, "process_kernel_time": 0.087647, "process_mem_max_rss": "220004", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m23:50:40.035652 [debug] [MainThread]: Command `dbt run` failed at 23:50:40.035603 after 0.96 seconds
[0m23:50:40.035855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8b8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dcd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89de6360>]}
[0m23:50:40.036073 [debug] [MainThread]: Flushing usage events
[0m00:00:03.650852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b39760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bea9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b39790>]}


============================== 00:00:03.654219 | 7a93e4ff-ac5b-4a8c-93ea-1feb8346366e ==============================
[0m00:00:03.654219 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:03.654550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:04.103113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b381f40>]}
[0m00:00:04.153942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d12720>]}
[0m00:00:04.154453 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:00:04.157793 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:00:04.158584 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:00:04.158943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64986750>]}
[0m00:00:04.617490 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_prices' in the 'models' section of file 'models/schema.yml'
[0m00:00:04.618181 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'daily_change' in the 'models' section of file 'models/schema.yml'
[0m00:00:04.708863 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.energy_consumption_analytics.not_null_stg_prices_SYMBOL.0033653bc8' (models/schema.yml) depends on a node named 'stg_prices' in package '' which was not found
[0m00:00:04.709179 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.energy_consumption_analytics.not_null_stg_prices_DT.fceca565ec' (models/schema.yml) depends on a node named 'stg_prices' in package '' which was not found
[0m00:00:04.709387 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.energy_consumption_analytics.not_null_daily_change_SYMBOL.2c8a530c54' (models/schema.yml) depends on a node named 'daily_change' in package '' which was not found
[0m00:00:04.709620 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.energy_consumption_analytics.not_null_daily_change_DT.58267ead0f' (models/schema.yml) depends on a node named 'daily_change' in package '' which was not found
[0m00:00:04.709846 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.energy_consumption_analytics.accepted_values_daily_change_direction__UP__DOWN__FLAT.7d84f2853f' (models/schema.yml) depends on a node named 'daily_change' in package '' which was not found
[0m00:00:04.722402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64009130>]}
[0m00:00:04.729877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641a6600>]}
[0m00:00:04.730085 [info ] [MainThread]: Found 4 models, 1 snapshot, 3 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:00:04.730227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6491fcb0>]}
[0m00:00:04.731049 [info ] [MainThread]: 
[0m00:00:04.731795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:04.732484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m00:00:04.737888 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:00:04.738076 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:00:04.738201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.284742 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m00:00:05.286637 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:00:05.428309 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:00:05.429026 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:00:05.429548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:06.971451 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.0 seconds
[0m00:00:06.973836 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:00:07.211226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:00:07.219443 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:00:07.219928 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:00:07.220210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:07.860241 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:00:07.863432 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:00:08.024271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now list_USER_DB_MONKEY_snapshot)
[0m00:00:08.028056 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:00:08.028529 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:00:08.029439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:08.589166 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:00:08.590114 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:00:08.737551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m00:00:08.739004 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:00:08.739243 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:00:08.739416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:09.816922 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:09.817930 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:00:10.017375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fb3c230>]}
[0m00:00:10.018904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:10.019604 [info ] [MainThread]: 
[0m00:00:10.031317 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m00:00:10.032230 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m00:00:10.033318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m00:00:10.033813 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m00:00:10.042693 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m00:00:10.045565 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 00:00:10.034117 => 00:00:10.045355
[0m00:00:10.045885 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m00:00:10.063274 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m00:00:10.065339 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m00:00:10.065586 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m00:00:10.065829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:11.354524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:11.370746 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 00:00:10.046069 => 00:00:11.370589
[0m00:00:11.371088 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m00:00:12.166768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f7e7440>]}
[0m00:00:12.168244 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 2.13s]
[0m00:00:12.169198 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m00:00:12.171193 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m00:00:12.171853 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m00:00:12.172811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m00:00:12.173270 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m00:00:12.177575 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m00:00:12.180542 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 00:00:12.173566 => 00:00:12.180093
[0m00:00:12.181092 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m00:00:12.198462 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m00:00:12.200476 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m00:00:12.200773 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m00:00:12.201001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:17.280587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m00:00:17.288085 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 00:00:12.181424 => 00:00:17.287835
[0m00:00:17.288728 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m00:00:17.596866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3de390>]}
[0m00:00:17.597782 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSUCCESS 1[0m in 5.42s]
[0m00:00:17.598653 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m00:00:17.599118 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m00:00:17.599619 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.region_comp ................... [RUN]
[0m00:00:17.600292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m00:00:17.600666 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m00:00:17.604065 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m00:00:17.605503 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 00:00:17.600905 => 00:00:17.605320
[0m00:00:17.605796 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m00:00:17.607987 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m00:00:17.609990 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m00:00:17.610414 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m00:00:17.610819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:30.464593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 13.0 seconds
[0m00:00:30.469985 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 00:00:17.605999 => 00:00:30.469689
[0m00:00:30.470625 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m00:00:31.004748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef115e0>]}
[0m00:00:31.006277 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.region_comp .............. [[32mSUCCESS 1[0m in 13.40s]
[0m00:00:31.007498 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m00:00:31.009339 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m00:00:31.010176 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.weekday_weekend ............... [RUN]
[0m00:00:31.011466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m00:00:31.012018 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m00:00:31.017100 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:00:31.019282 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 00:00:31.012461 => 00:00:31.018874
[0m00:00:31.019812 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m00:00:31.022875 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:00:31.024825 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m00:00:31.025327 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m00:00:31.025777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:38.171493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m00:00:38.175644 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 00:00:31.020129 => 00:00:38.175379
[0m00:00:38.176264 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m00:00:38.357071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a93e4ff-ac5b-4a8c-93ea-1feb8346366e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef2ec00>]}
[0m00:00:38.357592 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.weekday_weekend .......... [[32mSUCCESS 1[0m in 7.35s]
[0m00:00:38.358052 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m00:00:38.359329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:38.359522 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m00:00:38.359691 [info ] [MainThread]: 
[0m00:00:38.359840 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 33.63 seconds (33.63s).
[0m00:00:38.360277 [debug] [MainThread]: Command end result
[0m00:00:38.364947 [info ] [MainThread]: 
[0m00:00:38.365145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:38.365303 [info ] [MainThread]: 
[0m00:00:38.365468 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:00:38.366074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.73834, "process_user_time": 3.309014, "process_kernel_time": 0.215915, "process_mem_max_rss": "229508", "process_out_blocks": "2721", "process_in_blocks": "0"}
[0m00:00:38.366335 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:38.366288 after 34.74 seconds
[0m00:00:38.366521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d172c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64729190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fbf7ef0>]}
[0m00:00:38.366680 [debug] [MainThread]: Flushing usage events
[0m00:00:41.294671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb09520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb08350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb0bdd0>]}


============================== 00:00:41.297402 | 87da5dbb-4ed3-4a5a-bc58-47d72a9b3607 ==============================
[0m00:00:41.297402 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:41.297821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:41.651731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923d68d0>]}
[0m00:00:41.698593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0d7da0>]}
[0m00:00:41.698925 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:00:41.702087 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:00:41.728071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:41.728235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:41.730734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8787dc40>]}
[0m00:00:41.735726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8766d070>]}
[0m00:00:41.735902 [info ] [MainThread]: Found 4 models, 1 snapshot, 3 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:00:41.736205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ee76b0>]}
[0m00:00:41.736939 [info ] [MainThread]: 
[0m00:00:41.737386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:41.737984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_analytics'
[0m00:00:41.743312 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:00:41.743460 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:00:41.743574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:43.189014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:43.192157 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:00:43.371677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now list_USER_DB_MONKEY_snapshot)
[0m00:00:43.376361 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:00:43.376871 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:00:43.377282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:44.251794 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:00:44.254419 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:00:44.399624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m00:00:44.403862 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:00:44.404419 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:00:44.405408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:49.339258 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 5.0 seconds
[0m00:00:49.342699 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:00:49.669286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87da5dbb-4ed3-4a5a-bc58-47d72a9b3607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876b0380>]}
[0m00:00:49.670709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:49.672092 [info ] [MainThread]: 
[0m00:00:49.681629 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723
[0m00:00:49.682006 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA .. [RUN]
[0m00:00:49.682903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723)
[0m00:00:49.683302 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723
[0m00:00:49.694263 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723"
[0m00:00:49.695766 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723 (compile): 00:00:49.683558 => 00:00:49.695559
[0m00:00:49.696072 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723
[0m00:00:49.709158 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723"
[0m00:00:49.710552 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723"
[0m00:00:49.710821 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend_signal as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_analytics.moving_avg
    group by trend_signal

)

select *
from all_values
where value_field not in (
    'ABOVE_MA','BELOW_MA'
)



      
    ) dbt_internal_test
[0m00:00:49.711041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:51.359499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:51.362858 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723 (execute): 00:00:49.696317 => 00:00:51.362725
[0m00:00:51.363045 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723: Close
[0m00:00:52.196939 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA ........ [[32mPASS[0m in 2.51s]
[0m00:00:52.197967 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723
[0m00:00:52.198754 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1
[0m00:00:52.199072 [info ] [Thread-1 (]: 2 of 3 START test not_null_moving_avg_DT ....................................... [RUN]
[0m00:00:52.199784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_moving_avg_trend_signal__ABOVE_MA__BELOW_MA.4e7c648723, now test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1)
[0m00:00:52.200066 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1
[0m00:00:52.203786 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1"
[0m00:00:52.204785 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1 (compile): 00:00:52.200205 => 00:00:52.204672
[0m00:00:52.204972 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1
[0m00:00:52.206279 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1"
[0m00:00:52.207008 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1"
[0m00:00:52.207203 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DT
from USER_DB_MONKEY.analytics_analytics.moving_avg
where DT is null



      
    ) dbt_internal_test
[0m00:00:52.207384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:53.868288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:53.870891 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1 (execute): 00:00:52.205087 => 00:00:53.870635
[0m00:00:53.871313 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1: Close
[0m00:00:54.023490 [info ] [Thread-1 (]: 2 of 3 PASS not_null_moving_avg_DT ............................................. [[32mPASS[0m in 1.82s]
[0m00:00:54.024890 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1
[0m00:00:54.025331 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb
[0m00:00:54.025785 [info ] [Thread-1 (]: 3 of 3 START test not_null_moving_avg_SYMBOL ................................... [RUN]
[0m00:00:54.026670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DT.ad282bd2b1, now test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb)
[0m00:00:54.026984 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb
[0m00:00:54.030979 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb"
[0m00:00:54.032232 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb (compile): 00:00:54.027196 => 00:00:54.032066
[0m00:00:54.032524 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb
[0m00:00:54.034538 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb"
[0m00:00:54.035637 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb"
[0m00:00:54.035863 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SYMBOL
from USER_DB_MONKEY.analytics_analytics.moving_avg
where SYMBOL is null



      
    ) dbt_internal_test
[0m00:00:54.036063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:55.008558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:55.012393 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb (execute): 00:00:54.032737 => 00:00:55.012051
[0m00:00:55.013201 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb: Close
[0m00:00:55.150939 [info ] [Thread-1 (]: 3 of 3 PASS not_null_moving_avg_SYMBOL ......................................... [[32mPASS[0m in 1.12s]
[0m00:00:55.152927 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb
[0m00:00:55.156083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:55.156609 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_moving_avg_SYMBOL.b7075880fb' was properly closed.
[0m00:00:55.157125 [info ] [MainThread]: 
[0m00:00:55.157839 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 13.42 seconds (13.42s).
[0m00:00:55.158970 [debug] [MainThread]: Command end result
[0m00:00:55.170208 [info ] [MainThread]: 
[0m00:00:55.171012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:55.171312 [info ] [MainThread]: 
[0m00:00:55.171753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:00:55.172874 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.898784, "process_user_time": 2.44838, "process_kernel_time": 0.120461, "process_mem_max_rss": "218092", "process_out_blocks": "1822", "process_in_blocks": "0"}
[0m00:00:55.173370 [debug] [MainThread]: Command `dbt test` succeeded at 00:00:55.173271 after 13.90 seconds
[0m00:00:55.173772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad741520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8760faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87769610>]}
[0m00:00:55.174072 [debug] [MainThread]: Flushing usage events
[0m00:01:02.547118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6359220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6358c50>]}


============================== 00:01:02.549878 | 83cdfa3f-c12b-4191-b8bc-4f8bed86db73 ==============================
[0m00:01:02.549878 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:01:02.550137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:02.915645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85457560>]}
[0m00:01:02.961644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39308c0>]}
[0m00:01:02.961963 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:01:02.964930 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:01:02.983256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:02.983401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:02.985844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8509cb30>]}
[0m00:01:02.990466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8501ce60>]}
[0m00:01:02.990652 [info ] [MainThread]: Found 4 models, 1 snapshot, 3 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:01:02.990790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8547c620>]}
[0m00:01:02.991468 [info ] [MainThread]: 
[0m00:01:02.991798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:02.992290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m00:01:02.997108 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:01:02.997255 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:01:02.997390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:03.484737 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m00:01:03.487208 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:01:04.004325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m00:01:04.012823 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:01:04.013175 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:01:04.013435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:05.674682 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m00:01:05.676381 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:01:07.254866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:01:07.259037 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:01:07.259671 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:01:07.260656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:08.929405 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m00:01:08.932593 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:01:09.132825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m00:01:09.135433 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:01:09.135722 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:01:09.136031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:10.668481 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m00:01:10.671349 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:01:11.576742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8518b980>]}
[0m00:01:11.577320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:11.577645 [info ] [MainThread]: 
[0m00:01:11.583114 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m00:01:11.583403 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m00:01:11.583824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m00:01:11.584054 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m00:01:11.588474 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 00:01:11.584197 => 00:01:11.588359
[0m00:01:11.588682 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m00:01:11.615870 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m00:01:11.617380 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m00:01:11.617604 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace transient table USER_DB_MONKEY.snapshot.eia_rto_hourly_snapshot
         as
        (

    select *,
        md5(coalesce(cast(REGION || SERIES || to_char(DATE, YYYY-MM-DD"T"HH24:MI:SS) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

    ) sbq



        );
[0m00:01:11.617813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:12.171285 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d5e1-0307-2daa-000f-c0df00ac2c62
[0m00:01:12.172094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 70 unexpected '"T"'.
syntax error line 6 at position 85 unexpected 'as'.
syntax error line 6 at position 97 unexpected ','.
[0m00:01:12.172833 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 00:01:11.588809 => 00:01:12.172600
[0m00:01:12.173277 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m00:01:13.057693 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 70 unexpected '"T"'.
  syntax error line 6 at position 85 unexpected 'as'.
  syntax error line 6 at position 97 unexpected ','.
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m00:01:13.058756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83cdfa3f-c12b-4191-b8bc-4f8bed86db73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f89100>]}
[0m00:01:13.059764 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 1.47s]
[0m00:01:13.060465 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m00:01:13.063279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:13.063779 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m00:01:13.064137 [info ] [MainThread]: 
[0m00:01:13.064572 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.07 seconds (10.07s).
[0m00:01:13.065398 [debug] [MainThread]: Command end result
[0m00:01:13.076501 [info ] [MainThread]: 
[0m00:01:13.077241 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:13.077698 [info ] [MainThread]: 
[0m00:01:13.078092 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 70 unexpected '"T"'.
  syntax error line 6 at position 85 unexpected 'as'.
  syntax error line 6 at position 97 unexpected ','.
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m00:01:13.078503 [info ] [MainThread]: 
[0m00:01:13.079120 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:13.080141 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 10.554123, "process_user_time": 2.439356, "process_kernel_time": 0.095326, "process_mem_max_rss": "217252", "process_out_blocks": "1808", "command_success": false, "process_in_blocks": "0"}
[0m00:01:13.080770 [debug] [MainThread]: Command `dbt snapshot` failed at 00:01:13.080683 after 10.55 seconds
[0m00:01:13.081108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64a4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8547c620>]}
[0m00:01:13.081477 [debug] [MainThread]: Flushing usage events
[0m00:16:41.894667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee98290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f07c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f07f080>]}


============================== 00:16:41.897479 | 65a8d0d1-595e-4170-afc7-87c13155d68e ==============================
[0m00:16:41.897479 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:16:41.897855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:42.245857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a8d0d1-595e-4170-afc7-87c13155d68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ded1280>]}
[0m00:16:42.290932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65a8d0d1-595e-4170-afc7-87c13155d68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e1c8e00>]}
[0m00:16:42.291244 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:16:42.294325 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:16:42.321742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:42.322068 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m00:16:42.463039 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_moving_avg_REGION__ref_stg_eia___REGION (models/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'to_field'
[0m00:16:42.463785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5902081, "process_user_time": 2.273636, "process_kernel_time": 0.098722, "process_mem_max_rss": "215380", "process_in_blocks": "16", "process_out_blocks": "21", "command_success": false}
[0m00:16:42.464004 [debug] [MainThread]: Command `dbt run` failed at 00:16:42.463955 after 0.59 seconds
[0m00:16:42.464194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813214f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efe4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d867e30>]}
[0m00:16:42.464373 [debug] [MainThread]: Flushing usage events
[0m00:17:43.091651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f15d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4278680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa73590>]}


============================== 00:17:43.094373 | 44c978ad-558c-4388-b922-ba230caff829 ==============================
[0m00:17:43.094373 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:17:43.094742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:17:43.435100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44c978ad-558c-4388-b922-ba230caff829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1e9160>]}
[0m00:17:43.480173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44c978ad-558c-4388-b922-ba230caff829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f166750>]}
[0m00:17:43.480481 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:17:43.483524 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:17:43.508478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:43.508820 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m00:17:43.647516 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_moving_avg_REGION__ref_stg_eia___REGION (models/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'to_field'
[0m00:17:43.648136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5779287, "process_user_time": 2.238177, "process_kernel_time": 0.090208, "process_mem_max_rss": "215632", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m00:17:43.648341 [debug] [MainThread]: Command `dbt run` failed at 00:17:43.648296 after 0.58 seconds
[0m00:17:43.648504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4278680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db44950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d70b140>]}
[0m00:17:43.648681 [debug] [MainThread]: Flushing usage events
[0m00:18:01.891524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d582c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e40ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72f6cc0>]}


============================== 00:18:01.894398 | a7c29f9e-1cd3-4c30-aad5-3a37c236758b ==============================
[0m00:18:01.894398 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:18:01.894778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m00:18:02.237760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c29f9e-1cd3-4c30-aad5-3a37c236758b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862ef560>]}
[0m00:18:02.284016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c29f9e-1cd3-4c30-aad5-3a37c236758b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c05ca0>]}
[0m00:18:02.284318 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:18:02.287324 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:18:02.310978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:18:02.311276 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m00:18:02.448358 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_moving_avg_REGION__ref_stg_eia___REGION (models/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'to_field'
[0m00:18:02.449025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5782031, "process_user_time": 2.260278, "process_kernel_time": 0.080045, "process_mem_max_rss": "215352", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m00:18:02.449235 [debug] [MainThread]: Command `dbt run` failed at 00:18:02.449191 after 0.58 seconds
[0m00:18:02.449387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e40ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85797980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85378830>]}
[0m00:18:02.449534 [debug] [MainThread]: Flushing usage events
[0m00:21:31.790379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c6d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f2f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88af080>]}


============================== 00:21:31.793438 | 0b047e36-ea8b-4f1e-a61c-ed61a01203ac ==============================
[0m00:21:31.793438 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:21:31.793829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:32.146112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b047e36-ea8b-4f1e-a61c-ed61a01203ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b53c50>]}
[0m00:21:32.190690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b047e36-ea8b-4f1e-a61c-ed61a01203ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e33980>]}
[0m00:21:32.191032 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:21:32.194062 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:21:32.220499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:21:32.220820 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m00:21:32.221024 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://snapshots/electricity.sql
[0m00:21:32.422512 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_moving_avg_REGION__ref_stg_eia___REGION (models/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'to_field'
[0m00:21:32.423204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6552422, "process_user_time": 2.351823, "process_kernel_time": 0.096279, "process_mem_max_rss": "219184", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m00:21:32.423408 [debug] [MainThread]: Command `dbt run` failed at 00:21:32.423366 after 0.66 seconds
[0m00:21:32.423599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f2f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8215d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d25880>]}
[0m00:21:32.423759 [debug] [MainThread]: Flushing usage events
[0m00:29:57.814697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1331280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1330440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1331c10>]}


============================== 00:29:57.817634 | 27cd8aa1-55b1-41a9-8612-fd37a3ade904 ==============================
[0m00:29:57.817634 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:29:57.818078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:58.162601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800cf7a0>]}
[0m00:29:58.209031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f2d640>]}
[0m00:29:58.209365 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:29:58.212451 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:29:58.241194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:29:58.241529 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m00:29:58.241723 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://snapshots/electricity.sql
[0m00:29:58.500765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7604a0>]}
[0m00:29:58.506897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bffcd10>]}
[0m00:29:58.507101 [info ] [MainThread]: Found 4 models, 1 snapshot, 13 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:29:58.507424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bffc2f0>]}
[0m00:29:58.508232 [info ] [MainThread]: 
[0m00:29:58.508613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:58.509218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m00:29:58.514220 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:29:58.514380 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:29:58.514515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:59.174564 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m00:29:59.177450 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:29:59.981993 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:29:59.982819 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:29:59.983342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:00.515992 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m00:30:00.517519 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:30:00.671606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m00:30:00.679618 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:30:00.679993 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:30:00.680260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:01.755979 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:30:01.759218 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:30:01.939693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m00:30:01.943670 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:30:01.944278 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:30:01.945362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:02.412452 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:30:02.414781 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:30:02.583471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:30:02.587878 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:30:02.588560 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:30:02.589023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:03.291026 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:30:03.292272 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:30:03.469105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b76ef90>]}
[0m00:30:03.469787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:03.470176 [info ] [MainThread]: 
[0m00:30:03.474253 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m00:30:03.474516 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m00:30:03.474894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now model.energy_consumption_analytics.stg_eia)
[0m00:30:03.475066 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m00:30:03.478146 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m00:30:03.479363 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 00:30:03.475189 => 00:30:03.479282
[0m00:30:03.479555 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m00:30:03.489965 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m00:30:03.490834 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m00:30:03.491001 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m00:30:03.491199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:04.381763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:04.397617 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 00:30:03.479705 => 00:30:04.397476
[0m00:30:04.397946 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m00:30:04.560010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab9ee70>]}
[0m00:30:04.560645 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m00:30:04.561461 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m00:30:04.562182 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m00:30:04.562591 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m00:30:04.563318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m00:30:04.563611 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m00:30:04.565817 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m00:30:04.566972 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 00:30:04.563802 => 00:30:04.566809
[0m00:30:04.567236 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m00:30:04.579880 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m00:30:04.581082 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m00:30:04.581331 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m00:30:04.581585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:07.183890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m00:30:07.188421 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 00:30:04.567414 => 00:30:07.188142
[0m00:30:07.189154 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m00:30:07.328896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abbec00>]}
[0m00:30:07.330208 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSUCCESS 1[0m in 2.77s]
[0m00:30:07.331689 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m00:30:07.332392 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m00:30:07.333024 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.region_comp ................... [RUN]
[0m00:30:07.334214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m00:30:07.334709 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m00:30:07.339450 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m00:30:07.341358 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 00:30:07.335091 => 00:30:07.341124
[0m00:30:07.341730 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m00:30:07.346877 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m00:30:07.349041 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m00:30:07.349436 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m00:30:07.349779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:09.334083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:30:09.337869 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 00:30:07.341948 => 00:30:09.337624
[0m00:30:09.338406 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m00:30:09.491727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abae840>]}
[0m00:30:09.493071 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.region_comp .............. [[32mSUCCESS 1[0m in 2.16s]
[0m00:30:09.494367 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m00:30:09.495063 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m00:30:09.495681 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.weekday_weekend ............... [RUN]
[0m00:30:09.496866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m00:30:09.497300 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m00:30:09.501726 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:30:09.504108 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 00:30:09.497566 => 00:30:09.503882
[0m00:30:09.504471 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m00:30:09.507159 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:30:09.508716 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m00:30:09.509086 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m00:30:09.509447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:11.179427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:30:11.184067 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 00:30:09.504724 => 00:30:11.183796
[0m00:30:11.184676 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m00:30:11.324837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cd8aa1-55b1-41a9-8612-fd37a3ade904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abb8e00>]}
[0m00:30:11.326024 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.weekday_weekend .......... [[32mSUCCESS 1[0m in 1.83s]
[0m00:30:11.327456 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m00:30:11.330341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:11.330842 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m00:30:11.331349 [info ] [MainThread]: 
[0m00:30:11.332253 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 12.82 seconds (12.82s).
[0m00:30:11.333327 [debug] [MainThread]: Command end result
[0m00:30:11.346012 [info ] [MainThread]: 
[0m00:30:11.346699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:11.347027 [info ] [MainThread]: 
[0m00:30:11.347347 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:30:11.348218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.554969, "process_user_time": 2.888096, "process_kernel_time": 0.149367, "process_mem_max_rss": "226780", "process_out_blocks": "2797", "process_in_blocks": "0"}
[0m00:30:11.348593 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:11.348511 after 13.56 seconds
[0m00:30:11.348885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa162a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1422720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d80740>]}
[0m00:30:11.349193 [debug] [MainThread]: Flushing usage events
[0m00:30:13.906403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84eb5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851acbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84eb4620>]}


============================== 00:30:13.909048 | f85ad621-97be-4569-8283-8bcbb4086cbf ==============================
[0m00:30:13.909048 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:30:13.909439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:30:14.243613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c61ee0>]}
[0m00:30:14.288634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641bcf80>]}
[0m00:30:14.288957 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:30:14.291949 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:30:14.316262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:30:14.316424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:30:14.318627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a72bef0>]}
[0m00:30:14.323796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5faf1310>]}
[0m00:30:14.323996 [info ] [MainThread]: Found 4 models, 1 snapshot, 13 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:30:14.324284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fc27aa0>]}
[0m00:30:14.325208 [info ] [MainThread]: 
[0m00:30:14.325631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:30:14.326211 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m00:30:14.331575 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:30:14.331726 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:30:14.331851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:14.822543 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:30:14.825289 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:30:15.012418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m00:30:15.017108 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:30:15.017684 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:30:15.018207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:15.662720 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:30:15.665740 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:30:15.796998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:30:15.799603 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:30:15.799989 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:30:15.800619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:16.319686 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:30:16.322845 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:30:16.733256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85ad621-97be-4569-8283-8bcbb4086cbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fc26660>]}
[0m00:30:16.733853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:16.734426 [info ] [MainThread]: 
[0m00:30:16.740009 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:30:16.740395 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m00:30:16.740897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m00:30:16.741142 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:30:16.750713 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:30:16.752103 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 00:30:16.741265 => 00:30:16.751918
[0m00:30:16.752568 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:30:16.763377 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:30:16.764905 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:30:16.765159 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m00:30:16.765358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:17.728219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:17.731144 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 00:30:16.752833 => 00:30:17.731040
[0m00:30:17.731357 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m00:30:17.840767 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.10s]
[0m00:30:17.841311 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:30:17.841559 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:30:17.841783 [info ] [Thread-1 (]: 2 of 13 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m00:30:17.842243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m00:30:17.842409 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:30:17.844874 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:30:17.845697 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 00:30:17.842525 => 00:30:17.845607
[0m00:30:17.845870 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:30:17.846938 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:30:17.847661 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:30:17.847860 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m00:30:17.848087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:18.445252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:18.447377 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 00:30:17.845999 => 00:30:18.447167
[0m00:30:18.447782 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m00:30:18.574609 [info ] [Thread-1 (]: 2 of 13 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.73s]
[0m00:30:18.576325 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:30:18.577051 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:30:18.577634 [info ] [Thread-1 (]: 3 of 13 START test not_null_moving_avg_DATE .................................... [RUN]
[0m00:30:18.579205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m00:30:18.579805 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:30:18.589143 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:30:18.590787 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 00:30:18.580255 => 00:30:18.590560
[0m00:30:18.591245 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:30:18.593878 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:30:18.595289 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:30:18.595676 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m00:30:18.596013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:19.248351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:19.251914 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 00:30:18.591528 => 00:30:19.251615
[0m00:30:19.252621 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m00:30:19.400537 [info ] [Thread-1 (]: 3 of 13 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.82s]
[0m00:30:19.402190 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:30:19.403225 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:30:19.404526 [info ] [Thread-1 (]: 4 of 13 START test not_null_moving_avg_REGION .................................. [RUN]
[0m00:30:19.406700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m00:30:19.407366 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:30:19.413304 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:30:19.415615 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 00:30:19.407700 => 00:30:19.415268
[0m00:30:19.416136 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:30:19.419145 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:30:19.421952 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:30:19.422471 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m00:30:19.422883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:19.970069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:19.974507 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 00:30:19.416453 => 00:30:19.974184
[0m00:30:19.975125 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m00:30:20.113206 [info ] [Thread-1 (]: 4 of 13 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.71s]
[0m00:30:20.115197 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:30:20.115852 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:30:20.116373 [info ] [Thread-1 (]: 5 of 13 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m00:30:20.117461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m00:30:20.117904 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:30:20.124116 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:30:20.126167 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 00:30:20.118279 => 00:30:20.125952
[0m00:30:20.126546 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:30:20.129877 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:30:20.131884 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:30:20.132381 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m00:30:20.132748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:20.580188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:30:20.582324 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 00:30:20.126780 => 00:30:20.582109
[0m00:30:20.582718 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m00:30:20.726859 [info ] [Thread-1 (]: 5 of 13 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.61s]
[0m00:30:20.728803 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:30:20.729805 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:30:20.730555 [info ] [Thread-1 (]: 6 of 13 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m00:30:20.732255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m00:30:20.732809 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:30:20.740160 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:30:20.742279 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 00:30:20.733175 => 00:30:20.741963
[0m00:30:20.742794 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:30:20.745704 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:30:20.747162 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:30:20.747502 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m00:30:20.747890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:21.832110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:21.834516 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 00:30:20.743141 => 00:30:21.834024
[0m00:30:21.835732 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m00:30:21.996127 [info ] [Thread-1 (]: 6 of 13 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 1.26s]
[0m00:30:21.999400 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:30:22.000581 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:30:22.001416 [info ] [Thread-1 (]: 7 of 13 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m00:30:22.004721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m00:30:22.006090 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:30:22.011909 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:30:22.013734 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 00:30:22.006703 => 00:30:22.013521
[0m00:30:22.014100 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:30:22.016506 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:30:22.017899 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:30:22.018197 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics_analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m00:30:22.018459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:22.644100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:22.647728 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 00:30:22.014338 => 00:30:22.647094
[0m00:30:22.648518 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m00:30:22.823309 [info ] [Thread-1 (]: 7 of 13 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.82s]
[0m00:30:22.824468 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:30:22.825124 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:30:22.825601 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m00:30:22.826742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m00:30:22.827341 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:30:22.833462 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:30:22.835334 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 00:30:22.827680 => 00:30:22.835111
[0m00:30:22.835772 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:30:22.839347 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:30:22.841624 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:30:22.842165 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m00:30:22.842499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:23.565515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:23.567257 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 00:30:22.836104 => 00:30:23.567100
[0m00:30:23.567558 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m00:30:23.697990 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.87s]
[0m00:30:23.699310 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:30:23.699858 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:30:23.700434 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m00:30:23.701751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m00:30:23.702303 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:30:23.707035 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:30:23.708538 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 00:30:23.702628 => 00:30:23.708332
[0m00:30:23.708912 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:30:23.712557 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:30:23.713783 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:30:23.714083 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m00:30:23.714368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:24.387707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:24.391570 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 00:30:23.709152 => 00:30:24.391220
[0m00:30:24.392223 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m00:30:24.552066 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.85s]
[0m00:30:24.553118 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:30:24.553550 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:30:24.554017 [info ] [Thread-1 (]: 10 of 13 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m00:30:24.554891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m00:30:24.555267 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:30:24.559386 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:30:24.560770 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 00:30:24.555528 => 00:30:24.560524
[0m00:30:24.561129 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:30:24.563299 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:30:24.564395 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:30:24.564730 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m00:30:24.564979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:25.268047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:30:25.271555 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 00:30:24.561354 => 00:30:25.271174
[0m00:30:25.272182 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m00:30:25.414795 [info ] [Thread-1 (]: 10 of 13 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.86s]
[0m00:30:25.416406 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:30:25.417108 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:30:25.417698 [info ] [Thread-1 (]: 11 of 13 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m00:30:25.418906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m00:30:25.419468 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:30:25.426026 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:30:25.428128 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 00:30:25.419818 => 00:30:25.427858
[0m00:30:25.428853 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:30:25.432303 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:30:25.434126 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:30:25.434583 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m00:30:25.435052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:25.912200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:30:25.916062 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 00:30:25.429266 => 00:30:25.915635
[0m00:30:25.916808 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m00:30:26.124523 [info ] [Thread-1 (]: 11 of 13 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.71s]
[0m00:30:26.126112 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:30:26.126779 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:30:26.127294 [info ] [Thread-1 (]: 12 of 13 START test relationships_moving_avg_REGION__ref_stg_eia_ .............. [RUN]
[0m00:30:26.128466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb, now test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d)
[0m00:30:26.129094 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:30:26.139405 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:30:26.141376 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d (compile): 00:30:26.129492 => 00:30:26.141130
[0m00:30:26.141827 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:30:26.144519 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:30:26.146143 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:30:26.146566 [debug] [Thread-1 (]: On test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select  as from_field
    from USER_DB_MONKEY.analytics_analytics.moving_avg
    where  is not null
),

parent as (
    select REGION as to_field
    from USER_DB_MONKEY.analytics_staging.stg_eia
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:30:26.146954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:26.716556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d5fe-0307-3209-000f-c0df00ac713a
[0m00:30:26.717448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 12 unexpected 'as'.
syntax error line 13 at position 11 unexpected 'is'.
[0m00:30:26.718234 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d (execute): 00:30:26.142159 => 00:30:26.717991
[0m00:30:26.718897 [debug] [Thread-1 (]: On test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d: Close
[0m00:30:27.155600 [debug] [Thread-1 (]: Database Error in test relationships_moving_avg_REGION__ref_stg_eia_ (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected 'as'.
  syntax error line 13 at position 11 unexpected 'is'.
  compiled Code at target/run/energy_consumption_analytics/models/schema.yml/relationships_moving_avg_REGION__ref_stg_eia_.sql
[0m00:30:27.156329 [error] [Thread-1 (]: 12 of 13 ERROR relationships_moving_avg_REGION__ref_stg_eia_ ................... [[31mERROR[0m in 1.03s]
[0m00:30:27.157321 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:30:27.157807 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:30:27.158919 [info ] [Thread-1 (]: 13 of 13 START test unique_moving_avg_REGION__DATE__SERIES ..................... [RUN]
[0m00:30:27.159868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d, now test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6)
[0m00:30:27.160186 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:30:27.166338 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:30:27.167452 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (compile): 00:30:27.160392 => 00:30:27.167300
[0m00:30:27.167733 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:30:27.169550 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:30:27.170598 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:30:27.170862 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ['REGION', 'DATE', 'SERIES'] as unique_field,
    count(*) as n_records

from USER_DB_MONKEY.analytics_analytics.moving_avg
where ['REGION', 'DATE', 'SERIES'] is not null
group by ['REGION', 'DATE', 'SERIES']
having count(*) > 1



      
    ) dbt_internal_test
[0m00:30:27.171086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:27.567588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:30:27.571330 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (execute): 00:30:27.167903 => 00:30:27.570944
[0m00:30:27.572198 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: Close
[0m00:30:27.715542 [error] [Thread-1 (]: 13 of 13 FAIL 1 unique_moving_avg_REGION__DATE__SERIES ......................... [[31mFAIL 1[0m in 0.56s]
[0m00:30:27.717149 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:30:27.720005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:27.720713 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6' was properly closed.
[0m00:30:27.721496 [info ] [MainThread]: 
[0m00:30:27.722776 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m00:30:27.725403 [debug] [MainThread]: Command end result
[0m00:30:27.741228 [info ] [MainThread]: 
[0m00:30:27.741986 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:30:27.742255 [info ] [MainThread]: 
[0m00:30:27.742570 [error] [MainThread]:   Database Error in test relationships_moving_avg_REGION__ref_stg_eia_ (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected 'as'.
  syntax error line 13 at position 11 unexpected 'is'.
  compiled Code at target/run/energy_consumption_analytics/models/schema.yml/relationships_moving_avg_REGION__ref_stg_eia_.sql
[0m00:30:27.742837 [info ] [MainThread]: 
[0m00:30:27.743121 [error] [MainThread]: [31mFailure in test unique_moving_avg_REGION__DATE__SERIES (models/schema.yml)[0m
[0m00:30:27.743462 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:30:27.743782 [info ] [MainThread]: 
[0m00:30:27.744144 [info ] [MainThread]:   compiled Code at target/compiled/energy_consumption_analytics/models/schema.yml/unique_moving_avg_REGION__DATE__SERIES.sql
[0m00:30:27.744444 [info ] [MainThread]: 
[0m00:30:27.744732 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 TOTAL=13
[0m00:30:27.745951 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 13.858863, "process_user_time": 2.913101, "process_kernel_time": 0.147852, "process_mem_max_rss": "217984", "process_out_blocks": "1983", "command_success": false, "process_in_blocks": "0"}
[0m00:30:27.746422 [debug] [MainThread]: Command `dbt test` failed at 00:30:27.746291 after 13.86 seconds
[0m00:30:27.746811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1b6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85095970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b63950>]}
[0m00:30:27.747126 [debug] [MainThread]: Flushing usage events
[0m00:36:55.823547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85816180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85db3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858157c0>]}


============================== 00:36:55.826593 | 4c3a5e75-de78-4fd4-a1cf-659a1dcc1161 ==============================
[0m00:36:55.826593 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:36:55.827007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:36:56.176548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6452b500>]}
[0m00:36:56.222520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b63d40>]}
[0m00:36:56.222879 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:36:56.226048 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:36:56.230692 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:36:56.230977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645285f0>]}
[0m00:36:56.771621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6440f6e0>]}
[0m00:36:56.776821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643c7020>]}
[0m00:36:56.777028 [info ] [MainThread]: Found 4 models, 1 snapshot, 13 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:36:56.777386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64391d60>]}
[0m00:36:56.778208 [info ] [MainThread]: 
[0m00:36:56.778626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:36:56.779207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m00:36:56.784106 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:36:56.784284 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:36:56.784448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:57.408817 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m00:36:57.410962 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:36:57.626660 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m00:36:57.627527 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m00:36:57.628145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:36:58.135304 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m00:36:58.138286 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m00:36:58.277719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m00:36:58.287723 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:36:58.288174 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:36:58.288498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:36:58.734398 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:36:58.736264 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:36:58.870552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m00:36:58.874859 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:36:58.875726 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:36:58.877003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:36:59.328945 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:36:59.331752 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:37:00.172979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:37:00.177521 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:37:00.178207 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:37:00.178720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:01.001148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:37:01.004108 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:37:01.216428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64400a10>]}
[0m00:37:01.217824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:01.218432 [info ] [MainThread]: 
[0m00:37:01.229764 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m00:37:01.230613 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m00:37:01.231952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now model.energy_consumption_analytics.stg_eia)
[0m00:37:01.232425 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m00:37:01.239728 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m00:37:01.242434 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 00:37:01.232732 => 00:37:01.242262
[0m00:37:01.242734 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m00:37:01.260174 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m00:37:01.261110 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m00:37:01.261342 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m00:37:01.261550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:01.910810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:01.936465 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 00:37:01.242954 => 00:37:01.936244
[0m00:37:01.937032 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m00:37:02.075118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5efe6540>]}
[0m00:37:02.076402 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m00:37:02.078471 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m00:37:02.079972 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m00:37:02.080536 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m00:37:02.081704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m00:37:02.082272 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m00:37:02.086542 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m00:37:02.088372 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 00:37:02.082583 => 00:37:02.088179
[0m00:37:02.088744 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m00:37:02.107380 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m00:37:02.109219 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m00:37:02.109545 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m00:37:02.109798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:03.445580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:03.448246 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 00:37:02.089015 => 00:37:03.448069
[0m00:37:03.448627 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m00:37:03.597865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eb00410>]}
[0m00:37:03.599359 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSUCCESS 1[0m in 1.52s]
[0m00:37:03.601102 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m00:37:03.601880 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m00:37:03.602628 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.region_comp ................... [RUN]
[0m00:37:03.604197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m00:37:03.604785 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m00:37:03.609426 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m00:37:03.612282 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 00:37:03.605177 => 00:37:03.612034
[0m00:37:03.612721 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m00:37:03.615636 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m00:37:03.617662 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m00:37:03.618124 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m00:37:03.618475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:04.987349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:04.991649 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 00:37:03.613029 => 00:37:04.991403
[0m00:37:04.992240 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m00:37:05.130512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef65730>]}
[0m00:37:05.131867 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.region_comp .............. [[32mSUCCESS 1[0m in 1.53s]
[0m00:37:05.133447 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m00:37:05.134136 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m00:37:05.134810 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.weekday_weekend ............... [RUN]
[0m00:37:05.136387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m00:37:05.137085 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m00:37:05.141884 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:37:05.144148 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 00:37:05.137543 => 00:37:05.143779
[0m00:37:05.144645 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m00:37:05.147760 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m00:37:05.149535 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m00:37:05.150009 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics_analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m00:37:05.150464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:06.620665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:06.622491 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 00:37:05.144972 => 00:37:06.622365
[0m00:37:06.622767 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m00:37:06.764435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c3a5e75-de78-4fd4-a1cf-659a1dcc1161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5efe6f90>]}
[0m00:37:06.765651 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.weekday_weekend .......... [[32mSUCCESS 1[0m in 1.63s]
[0m00:37:06.767023 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m00:37:06.769611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:06.770202 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m00:37:06.770733 [info ] [MainThread]: 
[0m00:37:06.771404 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m00:37:06.772540 [debug] [MainThread]: Command end result
[0m00:37:06.785048 [info ] [MainThread]: 
[0m00:37:06.785705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:06.786146 [info ] [MainThread]: 
[0m00:37:06.786622 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:37:06.787470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.9851, "process_user_time": 3.202938, "process_kernel_time": 0.131366, "process_mem_max_rss": "229596", "process_out_blocks": "2796", "process_in_blocks": "0"}
[0m00:37:06.787947 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:06.787798 after 10.99 seconds
[0m00:37:06.788303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b0a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ff6e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640b5a60>]}
[0m00:37:06.788610 [debug] [MainThread]: Flushing usage events
[0m00:37:09.851864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940992b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942751f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94636f00>]}


============================== 00:37:09.854505 | 51d0bbfc-0b01-4cd6-b26e-360a62d5aead ==============================
[0m00:37:09.854505 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:37:09.854884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:37:10.192191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef01f40>]}
[0m00:37:10.237399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7470b200>]}
[0m00:37:10.237708 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m00:37:10.240741 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:37:10.263173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:10.263320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:10.265379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f11dd90>]}
[0m00:37:10.270240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed519a0>]}
[0m00:37:10.270439 [info ] [MainThread]: Found 4 models, 1 snapshot, 13 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:37:10.270710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee14650>]}
[0m00:37:10.271618 [info ] [MainThread]: 
[0m00:37:10.272002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:10.272574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m00:37:10.277883 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m00:37:10.278048 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m00:37:10.278164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:10.778692 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:37:10.780786 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m00:37:10.905606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m00:37:10.909674 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m00:37:10.910210 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m00:37:10.910665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:11.340937 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m00:37:11.343761 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m00:37:11.501817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics_analytics)
[0m00:37:11.505685 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_analytics"
[0m00:37:11.506200 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_analytics"} */
show terse objects in USER_DB_MONKEY.analytics_analytics limit 10000
[0m00:37:11.507097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:12.479548 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:37:12.481283 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_analytics: Close
[0m00:37:12.627713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0bbfc-0b01-4cd6-b26e-360a62d5aead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed51ca0>]}
[0m00:37:12.629241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:12.630533 [info ] [MainThread]: 
[0m00:37:12.641377 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:37:12.641995 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m00:37:12.643155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m00:37:12.643560 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:37:12.658241 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:37:12.659642 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 00:37:12.643799 => 00:37:12.659452
[0m00:37:12.659959 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:37:12.672472 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:37:12.673474 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m00:37:12.673691 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m00:37:12.673909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:13.600693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:13.610503 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 00:37:12.660151 => 00:37:13.610129
[0m00:37:13.611255 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m00:37:13.774053 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.13s]
[0m00:37:13.774568 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m00:37:13.774793 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:37:13.775068 [info ] [Thread-1 (]: 2 of 13 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m00:37:13.775524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m00:37:13.775720 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:37:13.778429 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:37:13.779154 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 00:37:13.775845 => 00:37:13.779037
[0m00:37:13.779346 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:37:13.780488 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:37:13.781141 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m00:37:13.781306 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m00:37:13.781448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:14.504372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:14.505451 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 00:37:13.779463 => 00:37:14.505353
[0m00:37:14.505646 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m00:37:14.626917 [info ] [Thread-1 (]: 2 of 13 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.85s]
[0m00:37:14.632555 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m00:37:14.635166 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:37:14.637203 [info ] [Thread-1 (]: 3 of 13 START test not_null_moving_avg_DATE .................................... [RUN]
[0m00:37:14.644315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m00:37:14.644842 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:37:14.660873 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:37:14.665995 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 00:37:14.648931 => 00:37:14.665685
[0m00:37:14.666378 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:37:14.669271 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:37:14.676098 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m00:37:14.676654 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m00:37:14.678079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:15.338758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:15.339794 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 00:37:14.666578 => 00:37:15.339704
[0m00:37:15.339987 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m00:37:15.476664 [info ] [Thread-1 (]: 3 of 13 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.83s]
[0m00:37:15.477162 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m00:37:15.477417 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:37:15.477620 [info ] [Thread-1 (]: 4 of 13 START test not_null_moving_avg_REGION .................................. [RUN]
[0m00:37:15.478070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m00:37:15.478261 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:37:15.480660 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:37:15.481416 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 00:37:15.478391 => 00:37:15.481315
[0m00:37:15.481609 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:37:15.482833 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:37:15.483444 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m00:37:15.483600 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m00:37:15.483753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:15.950609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:37:15.954214 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 00:37:15.481739 => 00:37:15.953874
[0m00:37:15.954937 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m00:37:16.078017 [info ] [Thread-1 (]: 4 of 13 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.60s]
[0m00:37:16.079423 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m00:37:16.080130 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:37:16.080668 [info ] [Thread-1 (]: 5 of 13 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m00:37:16.082018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m00:37:16.082540 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:37:16.090886 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:37:16.093308 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 00:37:16.082887 => 00:37:16.092943
[0m00:37:16.093834 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:37:16.096866 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:37:16.098249 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m00:37:16.098772 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m00:37:16.099126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:16.768077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:16.771668 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 00:37:16.094342 => 00:37:16.771348
[0m00:37:16.772302 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m00:37:16.922113 [info ] [Thread-1 (]: 5 of 13 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.84s]
[0m00:37:16.923931 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m00:37:16.924554 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:37:16.925065 [info ] [Thread-1 (]: 6 of 13 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m00:37:16.925938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m00:37:16.926297 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:37:16.930289 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:37:16.931602 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 00:37:16.926528 => 00:37:16.931371
[0m00:37:16.932015 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:37:16.934152 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:37:16.935439 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m00:37:16.935762 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m00:37:16.936100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:17.484983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:17.488789 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 00:37:16.932235 => 00:37:17.488429
[0m00:37:17.489495 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m00:37:17.624329 [info ] [Thread-1 (]: 6 of 13 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.70s]
[0m00:37:17.625418 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m00:37:17.626108 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:37:17.626634 [info ] [Thread-1 (]: 7 of 13 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m00:37:17.627823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m00:37:17.628478 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:37:17.634491 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:37:17.637126 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 00:37:17.628822 => 00:37:17.636862
[0m00:37:17.637690 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:37:17.640939 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:37:17.642533 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m00:37:17.642912 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics_analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m00:37:17.643246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:18.057214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:37:18.061174 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 00:37:17.638189 => 00:37:18.060762
[0m00:37:18.062105 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m00:37:18.216646 [info ] [Thread-1 (]: 7 of 13 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.59s]
[0m00:37:18.218137 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m00:37:18.218844 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:37:18.219564 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m00:37:18.220602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m00:37:18.221119 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:37:18.227005 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:37:18.228806 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 00:37:18.221432 => 00:37:18.228611
[0m00:37:18.229202 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:37:18.232422 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:37:18.234170 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m00:37:18.234555 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m00:37:18.234952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:18.642973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:37:18.646774 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 00:37:18.229450 => 00:37:18.646454
[0m00:37:18.647437 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m00:37:18.792646 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.57s]
[0m00:37:18.794120 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m00:37:18.794771 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:37:18.795233 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m00:37:18.796416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m00:37:18.796977 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:37:18.801858 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:37:18.803187 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 00:37:18.797282 => 00:37:18.802986
[0m00:37:18.803617 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:37:18.805953 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:37:18.807108 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m00:37:18.807439 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m00:37:18.807734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:19.853375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:19.857059 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 00:37:18.803858 => 00:37:19.856716
[0m00:37:19.857694 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m00:37:20.016026 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 1.22s]
[0m00:37:20.018078 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m00:37:20.019019 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:37:20.019742 [info ] [Thread-1 (]: 10 of 13 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m00:37:20.021932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m00:37:20.022666 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:37:20.031859 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:37:20.033753 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 00:37:20.023079 => 00:37:20.033479
[0m00:37:20.034284 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:37:20.036789 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:37:20.038045 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m00:37:20.038337 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m00:37:20.038626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:20.487587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:37:20.491529 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 00:37:20.034574 => 00:37:20.491226
[0m00:37:20.492124 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m00:37:20.619671 [info ] [Thread-1 (]: 10 of 13 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.60s]
[0m00:37:20.620252 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m00:37:20.620479 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:37:20.620668 [info ] [Thread-1 (]: 11 of 13 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m00:37:20.621098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m00:37:20.621299 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:37:20.623564 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:37:20.624418 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 00:37:20.621459 => 00:37:20.624327
[0m00:37:20.624629 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:37:20.625826 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:37:20.626484 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m00:37:20.626669 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m00:37:20.626855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:21.202683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:21.206270 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 00:37:20.624796 => 00:37:21.205964
[0m00:37:21.206874 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m00:37:21.372713 [info ] [Thread-1 (]: 11 of 13 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.75s]
[0m00:37:21.374259 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m00:37:21.374936 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:37:21.375466 [info ] [Thread-1 (]: 12 of 13 START test relationships_moving_avg_REGION__ref_stg_eia_ .............. [RUN]
[0m00:37:21.376577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb, now test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d)
[0m00:37:21.377172 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:37:21.387730 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:37:21.389357 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d (compile): 00:37:21.377559 => 00:37:21.389114
[0m00:37:21.389760 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:37:21.392433 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:37:21.393864 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"
[0m00:37:21.394232 [debug] [Thread-1 (]: On test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select  as from_field
    from USER_DB_MONKEY.analytics_analytics.moving_avg
    where  is not null
),

parent as (
    select REGION as to_field
    from USER_DB_MONKEY.analytics_staging.stg_eia
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:37:21.394554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:21.786509 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d605-0307-2daa-000f-c0df00ac2e56
[0m00:37:21.787109 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 12 unexpected 'as'.
syntax error line 13 at position 11 unexpected 'is'.
[0m00:37:21.787797 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d (execute): 00:37:21.390110 => 00:37:21.787521
[0m00:37:21.788326 [debug] [Thread-1 (]: On test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d: Close
[0m00:37:21.913174 [debug] [Thread-1 (]: Database Error in test relationships_moving_avg_REGION__ref_stg_eia_ (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected 'as'.
  syntax error line 13 at position 11 unexpected 'is'.
  compiled Code at target/run/energy_consumption_analytics/models/schema.yml/relationships_moving_avg_REGION__ref_stg_eia_.sql
[0m00:37:21.914316 [error] [Thread-1 (]: 12 of 13 ERROR relationships_moving_avg_REGION__ref_stg_eia_ ................... [[31mERROR[0m in 0.54s]
[0m00:37:21.915716 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d
[0m00:37:21.916325 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:37:21.917520 [info ] [Thread-1 (]: 13 of 13 START test unique_moving_avg_REGION__DATE__SERIES ..................... [RUN]
[0m00:37:21.918751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.relationships_moving_avg_REGION__ref_stg_eia_.0e232f722d, now test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6)
[0m00:37:21.919330 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:37:21.927828 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:37:21.929190 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (compile): 00:37:21.919675 => 00:37:21.929014
[0m00:37:21.929529 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:37:21.932050 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:37:21.933341 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m00:37:21.933744 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ['REGION', 'DATE', 'SERIES'] as unique_field,
    count(*) as n_records

from USER_DB_MONKEY.analytics_analytics.moving_avg
where ['REGION', 'DATE', 'SERIES'] is not null
group by ['REGION', 'DATE', 'SERIES']
having count(*) > 1



      
    ) dbt_internal_test
[0m00:37:21.934077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:22.496188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:37:22.499619 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (execute): 00:37:21.929775 => 00:37:22.499285
[0m00:37:22.500224 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: Close
[0m00:37:22.648608 [error] [Thread-1 (]: 13 of 13 FAIL 1 unique_moving_avg_REGION__DATE__SERIES ......................... [[31mFAIL 1[0m in 0.73s]
[0m00:37:22.650157 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m00:37:22.652950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:22.653558 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6' was properly closed.
[0m00:37:22.654075 [info ] [MainThread]: 
[0m00:37:22.654829 [info ] [MainThread]: Finished running 13 tests in 0 hours 0 minutes and 12.38 seconds (12.38s).
[0m00:37:22.657236 [debug] [MainThread]: Command end result
[0m00:37:22.671422 [info ] [MainThread]: 
[0m00:37:22.672098 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:37:22.672385 [info ] [MainThread]: 
[0m00:37:22.672724 [error] [MainThread]:   Database Error in test relationships_moving_avg_REGION__ref_stg_eia_ (models/schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 12 unexpected 'as'.
  syntax error line 13 at position 11 unexpected 'is'.
  compiled Code at target/run/energy_consumption_analytics/models/schema.yml/relationships_moving_avg_REGION__ref_stg_eia_.sql
[0m00:37:22.673028 [info ] [MainThread]: 
[0m00:37:22.673371 [error] [MainThread]: [31mFailure in test unique_moving_avg_REGION__DATE__SERIES (models/schema.yml)[0m
[0m00:37:22.673627 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:37:22.673841 [info ] [MainThread]: 
[0m00:37:22.674096 [info ] [MainThread]:   compiled Code at target/compiled/energy_consumption_analytics/models/schema.yml/unique_moving_avg_REGION__DATE__SERIES.sql
[0m00:37:22.674331 [info ] [MainThread]: 
[0m00:37:22.674596 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 TOTAL=13
[0m00:37:22.675426 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.843529, "process_user_time": 2.924491, "process_kernel_time": 0.120805, "process_mem_max_rss": "217940", "process_out_blocks": "1983", "command_success": false, "process_in_blocks": "0"}
[0m00:37:22.675801 [debug] [MainThread]: Command `dbt test` failed at 00:37:22.675718 after 12.84 seconds
[0m00:37:22.676103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94636f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7996fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941e5940>]}
[0m00:37:22.676382 [debug] [MainThread]: Flushing usage events
[0m01:06:24.131649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cf84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3932fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb380fd40>]}


============================== 01:06:24.134606 | 616b265a-dc3d-4d6f-b8e2-6847ce726524 ==============================
[0m01:06:24.134606 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:06:24.134978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:24.486989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cf98e0>]}
[0m01:06:24.531892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cf0650>]}
[0m01:06:24.532190 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:06:24.535206 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:06:24.564197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m01:06:24.564526 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m01:06:24.564716 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/weekday_weekend.sql
[0m01:06:24.564858 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/moving_avg.sql
[0m01:06:24.565010 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/region_comp.sql
[0m01:06:24.710207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f4b140>]}
[0m01:06:24.716028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918340b0>]}
[0m01:06:24.716191 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:06:24.716535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913859d0>]}
[0m01:06:24.717320 [info ] [MainThread]: 
[0m01:06:24.717662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:24.718196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m01:06:24.722982 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m01:06:24.723109 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m01:06:24.723252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:25.337152 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m01:06:25.339132 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m01:06:25.560196 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m01:06:25.560998 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m01:06:25.561488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:26.510325 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m01:06:26.513085 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m01:06:26.667541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m01:06:26.678066 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:06:26.678785 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:06:26.679338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:27.379922 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:06:27.381434 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:06:27.519755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m01:06:27.523701 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:06:27.524325 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:06:27.525298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:28.050836 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m01:06:28.053927 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:06:28.338049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m01:06:28.343589 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:06:28.344213 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:06:28.344665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:29.210385 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:06:29.212081 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:06:29.340735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913e6d50>]}
[0m01:06:29.342127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:29.343320 [info ] [MainThread]: 
[0m01:06:29.354337 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m01:06:29.355051 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m01:06:29.356058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m01:06:29.356521 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m01:06:29.363227 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m01:06:29.365659 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 01:06:29.356802 => 01:06:29.365476
[0m01:06:29.365963 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m01:06:29.384577 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m01:06:29.385531 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m01:06:29.385754 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m01:06:29.385960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:30.249320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:30.273739 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 01:06:29.366170 => 01:06:30.273569
[0m01:06:30.274168 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m01:06:30.449656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916d4950>]}
[0m01:06:30.451095 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m01:06:30.452573 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m01:06:30.453899 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m01:06:30.454424 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m01:06:30.455421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m01:06:30.455912 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m01:06:30.460259 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m01:06:30.462304 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 01:06:30.456271 => 01:06:30.461948
[0m01:06:30.462688 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m01:06:30.478430 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m01:06:30.479634 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m01:06:30.479902 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m01:06:30.480189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:32.498841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:06:32.500255 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 01:06:30.462912 => 01:06:32.500156
[0m01:06:32.500481 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m01:06:32.653738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9187a600>]}
[0m01:06:32.654199 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.20s]
[0m01:06:32.654647 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m01:06:32.654867 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m01:06:32.655139 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m01:06:32.655555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m01:06:32.655723 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m01:06:32.657173 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m01:06:32.657718 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 01:06:32.655825 => 01:06:32.657630
[0m01:06:32.657860 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m01:06:32.659112 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m01:06:32.660050 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m01:06:32.660225 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m01:06:32.660380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:34.345111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:06:34.348943 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 01:06:32.657949 => 01:06:34.348706
[0m01:06:34.349642 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m01:06:34.477531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bae7e0>]}
[0m01:06:34.478747 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.82s]
[0m01:06:34.480300 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m01:06:34.480977 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m01:06:34.481738 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m01:06:34.483046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m01:06:34.483548 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m01:06:34.487901 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m01:06:34.490509 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 01:06:34.483870 => 01:06:34.490275
[0m01:06:34.490911 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m01:06:34.494403 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m01:06:34.496665 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m01:06:34.497156 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m01:06:34.497534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:35.676225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:35.680207 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 01:06:34.491174 => 01:06:35.679932
[0m01:06:35.680864 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m01:06:35.846365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '616b265a-dc3d-4d6f-b8e2-6847ce726524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918d1c40>]}
[0m01:06:35.847642 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.36s]
[0m01:06:35.849261 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m01:06:35.851966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:35.852435 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m01:06:35.852903 [info ] [MainThread]: 
[0m01:06:35.853634 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 11.14 seconds (11.14s).
[0m01:06:35.854889 [debug] [MainThread]: Command end result
[0m01:06:35.869503 [info ] [MainThread]: 
[0m01:06:35.870227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:06:35.870508 [info ] [MainThread]: 
[0m01:06:35.870954 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:06:35.872009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.761806, "process_user_time": 2.827377, "process_kernel_time": 0.128789, "process_mem_max_rss": "223448", "process_out_blocks": "2783", "process_in_blocks": "0"}
[0m01:06:35.872499 [debug] [MainThread]: Command `dbt run` succeeded at 01:06:35.872406 after 11.76 seconds
[0m01:06:35.872822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3932fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917079e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c1fb00>]}
[0m01:06:35.873137 [debug] [MainThread]: Flushing usage events
[0m01:06:39.179619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0a49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad18e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad18e420>]}


============================== 01:06:39.182558 | c0a572b5-53cf-4d63-8e72-b249c9edcb2c ==============================
[0m01:06:39.182558 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:06:39.183002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:06:39.549110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ee3c50>]}
[0m01:06:39.621094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc2acc0>]}
[0m01:06:39.621533 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:06:39.624730 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:06:39.651920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:39.652149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:39.654395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dfe0f0>]}
[0m01:06:39.659870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b60bf0>]}
[0m01:06:39.660086 [info ] [MainThread]: Found 4 models, 1 snapshot, 12 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:06:39.660413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b604d0>]}
[0m01:06:39.661348 [info ] [MainThread]: 
[0m01:06:39.661748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:39.662360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics'
[0m01:06:39.668071 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:06:39.668249 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:06:39.668487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:40.079447 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:06:40.080383 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:06:40.204790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m01:06:40.206571 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:06:40.206770 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:06:40.206919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:40.551422 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m01:06:40.554167 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:06:40.775434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m01:06:40.778999 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:06:40.779530 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:06:40.780448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:41.226392 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m01:06:41.228125 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:06:41.720798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a572b5-53cf-4d63-8e72-b249c9edcb2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ee08f0>]}
[0m01:06:41.722153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:06:41.723346 [info ] [MainThread]: 
[0m01:06:41.734625 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:06:41.735183 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m01:06:41.736330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m01:06:41.736904 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:06:41.751470 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:06:41.753460 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 01:06:41.737228 => 01:06:41.753319
[0m01:06:41.753709 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:06:41.765740 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:06:41.766962 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:06:41.767195 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m01:06:41.767402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:42.261597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:06:42.271227 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 01:06:41.753888 => 01:06:42.270883
[0m01:06:42.271858 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m01:06:42.396976 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.66s]
[0m01:06:42.398325 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:06:42.399061 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:06:42.399596 [info ] [Thread-1 (]: 2 of 12 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m01:06:42.400810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m01:06:42.401351 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:06:42.408832 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:06:42.410666 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 01:06:42.401654 => 01:06:42.410446
[0m01:06:42.411039 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:06:42.414313 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:06:42.416178 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:06:42.416620 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m01:06:42.417091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:43.152099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:43.155898 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 01:06:42.411262 => 01:06:43.155536
[0m01:06:43.156632 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m01:06:43.471612 [info ] [Thread-1 (]: 2 of 12 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 1.07s]
[0m01:06:43.473345 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:06:43.474062 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:06:43.474626 [info ] [Thread-1 (]: 3 of 12 START test not_null_moving_avg_DATE .................................... [RUN]
[0m01:06:43.475818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m01:06:43.476342 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:06:43.484885 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:06:43.487703 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 01:06:43.476665 => 01:06:43.487393
[0m01:06:43.488222 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:06:43.491000 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:06:43.492416 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:06:43.492789 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m01:06:43.493123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:44.156473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:44.160251 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 01:06:43.488525 => 01:06:44.159935
[0m01:06:44.160870 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m01:06:44.311145 [info ] [Thread-1 (]: 3 of 12 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.84s]
[0m01:06:44.312679 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:06:44.313316 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:06:44.313867 [info ] [Thread-1 (]: 4 of 12 START test not_null_moving_avg_REGION .................................. [RUN]
[0m01:06:44.315460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m01:06:44.316006 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:06:44.321809 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:06:44.323645 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 01:06:44.316385 => 01:06:44.323378
[0m01:06:44.324051 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:06:44.327388 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:06:44.329163 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:06:44.329563 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m01:06:44.329912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:45.126964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:45.129231 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 01:06:44.324291 => 01:06:45.128995
[0m01:06:45.129635 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m01:06:45.277657 [info ] [Thread-1 (]: 4 of 12 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.96s]
[0m01:06:45.278988 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:06:45.279660 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:06:45.280315 [info ] [Thread-1 (]: 5 of 12 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m01:06:45.281458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m01:06:45.282012 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:06:45.286738 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:06:45.288055 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 01:06:45.282370 => 01:06:45.287861
[0m01:06:45.288386 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:06:45.291995 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:06:45.293374 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:06:45.293669 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m01:06:45.294013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:46.011266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:46.014724 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 01:06:45.288591 => 01:06:46.014362
[0m01:06:46.015417 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m01:06:46.238280 [info ] [Thread-1 (]: 5 of 12 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.96s]
[0m01:06:46.239836 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:06:46.240613 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:06:46.241216 [info ] [Thread-1 (]: 6 of 12 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m01:06:46.242463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m01:06:46.243016 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:06:46.249154 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:06:46.251267 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 01:06:46.243450 => 01:06:46.250993
[0m01:06:46.251982 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:06:46.255453 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:06:46.257334 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:06:46.257774 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m01:06:46.258172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:46.743844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:06:46.747881 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 01:06:46.252555 => 01:06:46.747542
[0m01:06:46.748634 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m01:06:46.900727 [info ] [Thread-1 (]: 6 of 12 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.66s]
[0m01:06:46.902472 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:06:46.903203 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:06:46.903804 [info ] [Thread-1 (]: 7 of 12 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m01:06:46.905074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m01:06:46.905668 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:06:46.911607 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:06:46.913182 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 01:06:46.905979 => 01:06:46.912959
[0m01:06:46.913539 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:06:46.916780 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:06:46.918449 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:06:46.918835 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m01:06:46.919155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:47.473301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:47.477104 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 01:06:46.913920 => 01:06:47.476791
[0m01:06:47.477654 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m01:06:47.648366 [info ] [Thread-1 (]: 7 of 12 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.74s]
[0m01:06:47.650038 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:06:47.650621 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:06:47.651111 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m01:06:47.652214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m01:06:47.652680 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:06:47.658784 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:06:47.661210 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 01:06:47.653004 => 01:06:47.660990
[0m01:06:47.661554 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:06:47.664768 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:06:47.666498 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:06:47.666884 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m01:06:47.667246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:48.681294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:48.684721 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 01:06:47.661776 => 01:06:48.684424
[0m01:06:48.685325 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m01:06:48.829012 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 1.18s]
[0m01:06:48.830574 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:06:48.831371 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:06:48.832136 [info ] [Thread-1 (]: 9 of 12 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m01:06:48.833469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m01:06:48.833968 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:06:48.839608 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:06:48.841397 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 01:06:48.834351 => 01:06:48.841171
[0m01:06:48.842138 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:06:48.845444 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:06:48.847321 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:06:48.847687 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m01:06:48.848017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:49.325071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:06:49.328619 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 01:06:48.842610 => 01:06:49.328312
[0m01:06:49.329231 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m01:06:49.529258 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.70s]
[0m01:06:49.530798 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:06:49.531564 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:06:49.532193 [info ] [Thread-1 (]: 10 of 12 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m01:06:49.533345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m01:06:49.533894 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:06:49.539691 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:06:49.541437 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 01:06:49.534184 => 01:06:49.541102
[0m01:06:49.541958 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:06:49.546751 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:06:49.548044 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:06:49.548420 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m01:06:49.548776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:50.131449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:06:50.135391 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 01:06:49.542309 => 01:06:50.135071
[0m01:06:50.135996 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m01:06:50.288756 [info ] [Thread-1 (]: 10 of 12 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.76s]
[0m01:06:50.289743 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:06:50.290200 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:06:50.290566 [info ] [Thread-1 (]: 11 of 12 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m01:06:50.291406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m01:06:50.291851 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:06:50.295686 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:06:50.296809 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 01:06:50.292097 => 01:06:50.296660
[0m01:06:50.297112 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:06:50.298994 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:06:50.300013 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:06:50.300334 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m01:06:50.300603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:50.781337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:06:50.785229 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 01:06:50.297308 => 01:06:50.784903
[0m01:06:50.785853 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m01:06:50.968265 [info ] [Thread-1 (]: 11 of 12 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.68s]
[0m01:06:50.969379 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:06:50.970061 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m01:06:50.970601 [info ] [Thread-1 (]: 12 of 12 START test unique_moving_avg_REGION__DATE__SERIES ..................... [RUN]
[0m01:06:50.971702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb, now test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6)
[0m01:06:50.972241 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m01:06:50.982503 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m01:06:50.985259 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (compile): 01:06:50.972636 => 01:06:50.985012
[0m01:06:50.985633 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m01:06:50.988305 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m01:06:50.989616 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"
[0m01:06:50.989991 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ['REGION', 'DATE', 'SERIES'] as unique_field,
    count(*) as n_records

from USER_DB_MONKEY.analytics.moving_avg
where ['REGION', 'DATE', 'SERIES'] is not null
group by ['REGION', 'DATE', 'SERIES']
having count(*) > 1



      
    ) dbt_internal_test
[0m01:06:50.990363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:51.420227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:06:51.423654 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6 (execute): 01:06:50.985884 => 01:06:51.423322
[0m01:06:51.424219 [debug] [Thread-1 (]: On test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6: Close
[0m01:06:51.553519 [error] [Thread-1 (]: 12 of 12 FAIL 1 unique_moving_avg_REGION__DATE__SERIES ......................... [[31mFAIL 1[0m in 0.58s]
[0m01:06:51.555269 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6
[0m01:06:51.559637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:51.560492 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.unique_moving_avg_REGION__DATE__SERIES.dcacb24db6' was properly closed.
[0m01:06:51.561211 [info ] [MainThread]: 
[0m01:06:51.562934 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 11.90 seconds (11.90s).
[0m01:06:51.566636 [debug] [MainThread]: Command end result
[0m01:06:51.578353 [info ] [MainThread]: 
[0m01:06:51.579469 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:06:51.579931 [info ] [MainThread]: 
[0m01:06:51.580579 [error] [MainThread]: [31mFailure in test unique_moving_avg_REGION__DATE__SERIES (models/schema.yml)[0m
[0m01:06:51.581104 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:06:51.581668 [info ] [MainThread]: 
[0m01:06:51.582191 [info ] [MainThread]:   compiled Code at target/compiled/energy_consumption_analytics/models/schema.yml/unique_moving_avg_REGION__DATE__SERIES.sql
[0m01:06:51.582693 [info ] [MainThread]: 
[0m01:06:51.583110 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m01:06:51.583870 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.425464, "process_user_time": 2.908213, "process_kernel_time": 0.123923, "process_mem_max_rss": "217156", "process_out_blocks": "1953", "command_success": false, "process_in_blocks": "0"}
[0m01:06:51.584320 [debug] [MainThread]: Command `dbt test` failed at 01:06:51.584230 after 12.43 seconds
[0m01:06:51.584784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad397260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad18e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87158170>]}
[0m01:06:51.585218 [debug] [MainThread]: Flushing usage events
[0m01:09:28.982609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95468cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95645100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95644d70>]}


============================== 01:09:28.985542 | 72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5 ==============================
[0m01:09:28.985542 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:09:28.985957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:09:29.326951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75e22c00>]}
[0m01:09:29.374036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74a3c620>]}
[0m01:09:29.374347 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:09:29.377411 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:09:29.403699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:09:29.404017 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/schema.yml
[0m01:09:29.544454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdd6a80>]}
[0m01:09:29.550055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7416cf50>]}
[0m01:09:29.550249 [info ] [MainThread]: Found 4 models, 1 snapshot, 11 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:09:29.550583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f9af5f0>]}
[0m01:09:29.551450 [info ] [MainThread]: 
[0m01:09:29.551820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:09:29.552392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m01:09:29.557959 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:09:29.558132 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:09:29.558279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:30.781163 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:09:30.783441 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:09:30.937663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m01:09:31.002274 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:09:31.002638 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:09:31.002869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:32.012715 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m01:09:32.015913 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:09:32.171238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m01:09:32.176709 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:09:32.177311 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:09:32.177731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:32.711880 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:09:32.714632 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:09:32.849796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d8ed2a-f7f5-4bfa-ab55-9e281c7e9de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f1689e0>]}
[0m01:09:32.851178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:32.851699 [info ] [MainThread]: 
[0m01:09:32.863370 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:09:32.864037 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m01:09:32.865287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m01:09:32.865849 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:09:32.880117 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:09:32.882166 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 01:09:32.866115 => 01:09:32.881956
[0m01:09:32.882521 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:09:32.895381 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:09:32.896530 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m01:09:32.896794 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m01:09:32.897026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:33.751382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:33.761160 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 01:09:32.882722 => 01:09:33.760739
[0m01:09:33.761899 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m01:09:33.908813 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.04s]
[0m01:09:33.909441 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m01:09:33.909740 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:09:33.910007 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m01:09:33.910452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m01:09:33.910658 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:09:33.913609 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:09:33.914356 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 01:09:33.910785 => 01:09:33.914248
[0m01:09:33.914588 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:09:33.915921 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:09:33.916725 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m01:09:33.916927 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m01:09:33.917121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:34.289152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:09:34.292741 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 01:09:33.914735 => 01:09:34.292366
[0m01:09:34.293422 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m01:09:34.458880 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.55s]
[0m01:09:34.460527 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m01:09:34.461163 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:09:34.461762 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m01:09:34.462980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m01:09:34.463515 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:09:34.472308 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:09:34.474277 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 01:09:34.463831 => 01:09:34.473914
[0m01:09:34.474786 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:09:34.479616 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:09:34.480978 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m01:09:34.481305 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m01:09:34.481657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:35.084306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:35.088238 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 01:09:34.475090 => 01:09:35.087782
[0m01:09:35.088843 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m01:09:35.259963 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.80s]
[0m01:09:35.261523 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m01:09:35.262169 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:09:35.262733 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m01:09:35.263824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m01:09:35.264319 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:09:35.270402 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:09:35.272145 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 01:09:35.264641 => 01:09:35.271935
[0m01:09:35.272520 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:09:35.275780 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:09:35.277600 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m01:09:35.278048 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m01:09:35.278451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:35.794186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:35.798058 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 01:09:35.272754 => 01:09:35.797753
[0m01:09:35.798707 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m01:09:35.927816 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.66s]
[0m01:09:35.929479 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m01:09:35.930171 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:09:35.930895 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m01:09:35.932298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m01:09:35.932888 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:09:35.940006 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:09:35.942505 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 01:09:35.933438 => 01:09:35.942160
[0m01:09:35.943011 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:09:35.946006 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:09:35.947648 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m01:09:35.948061 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m01:09:35.948499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:36.432917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:09:36.435516 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 01:09:35.943335 => 01:09:36.435297
[0m01:09:36.435992 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m01:09:36.572493 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.64s]
[0m01:09:36.573998 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m01:09:36.574671 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:09:36.575309 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m01:09:36.576577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m01:09:36.577109 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:09:36.582940 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:09:36.584966 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 01:09:36.577498 => 01:09:36.584739
[0m01:09:36.585356 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:09:36.588719 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:09:36.590551 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m01:09:36.590897 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m01:09:36.591187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:37.243974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:37.245368 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 01:09:36.585885 => 01:09:37.245231
[0m01:09:37.245699 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m01:09:37.364618 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.79s]
[0m01:09:37.365977 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m01:09:37.366594 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:09:37.367118 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m01:09:37.368405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m01:09:37.369025 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:09:37.374154 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:09:37.375478 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 01:09:37.369398 => 01:09:37.375280
[0m01:09:37.375868 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:09:37.378265 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:09:37.379420 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m01:09:37.379737 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m01:09:37.380060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:37.948679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:37.951786 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 01:09:37.376132 => 01:09:37.951497
[0m01:09:37.952512 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m01:09:38.106757 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.74s]
[0m01:09:38.108396 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m01:09:38.109159 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:09:38.109810 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m01:09:38.111046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m01:09:38.111622 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:09:38.117641 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:09:38.119416 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 01:09:38.111952 => 01:09:38.119210
[0m01:09:38.119857 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:09:38.125308 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:09:38.126897 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m01:09:38.127337 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m01:09:38.127743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:38.972027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:38.974432 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 01:09:38.120086 => 01:09:38.974182
[0m01:09:38.974844 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m01:09:39.109995 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 1.00s]
[0m01:09:39.111577 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m01:09:39.112276 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:09:39.112824 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m01:09:39.113953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m01:09:39.114429 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:09:39.120523 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:09:39.122235 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 01:09:39.114743 => 01:09:39.122009
[0m01:09:39.122595 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:09:39.125873 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:09:39.127707 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m01:09:39.128097 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m01:09:39.128483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:39.640879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:39.644508 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 01:09:39.123050 => 01:09:39.644174
[0m01:09:39.645129 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m01:09:39.785069 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.67s]
[0m01:09:39.786615 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m01:09:39.787246 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:09:39.787749 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m01:09:39.788814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m01:09:39.789333 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:09:39.795315 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:09:39.797010 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 01:09:39.789641 => 01:09:39.796816
[0m01:09:39.797355 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:09:39.800713 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:09:39.802818 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m01:09:39.803230 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m01:09:39.803590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:40.176395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:09:40.178656 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 01:09:39.797590 => 01:09:40.178430
[0m01:09:40.179076 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m01:09:40.326890 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.54s]
[0m01:09:40.328449 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m01:09:40.329084 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:09:40.329615 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m01:09:40.330679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m01:09:40.331139 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:09:40.337169 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:09:40.339063 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 01:09:40.331492 => 01:09:40.338813
[0m01:09:40.339530 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:09:40.342762 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:09:40.344395 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m01:09:40.344773 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m01:09:40.345133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:41.018397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:09:41.021911 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 01:09:40.339989 => 01:09:41.021562
[0m01:09:41.022546 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m01:09:41.202331 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.87s]
[0m01:09:41.203968 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m01:09:41.206512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:41.206958 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m01:09:41.207490 [info ] [MainThread]: 
[0m01:09:41.208114 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 11.66 seconds (11.66s).
[0m01:09:41.210142 [debug] [MainThread]: Command end result
[0m01:09:41.224750 [info ] [MainThread]: 
[0m01:09:41.225443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:41.225740 [info ] [MainThread]: 
[0m01:09:41.226055 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m01:09:41.226884 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.265875, "process_user_time": 3.077403, "process_kernel_time": 0.142481, "process_mem_max_rss": "224136", "process_out_blocks": "2818", "process_in_blocks": "0"}
[0m01:09:41.227298 [debug] [MainThread]: Command `dbt test` succeeded at 01:09:41.227213 after 12.27 seconds
[0m01:09:41.227581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d32f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff746b00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955b5850>]}
[0m01:09:41.227868 [debug] [MainThread]: Flushing usage events
[0m01:09:47.157350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7c56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7c4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7c6870>]}


============================== 01:09:47.159966 | d230f644-0129-4251-bc5b-015a6e7bd8aa ==============================
[0m01:09:47.159966 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:09:47.160354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:09:47.480274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c64f560>]}
[0m01:09:47.526708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7c95b0>]}
[0m01:09:47.527015 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:09:47.530131 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:09:47.554213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:09:47.554367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:09:47.556487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c31d5b0>]}
[0m01:09:47.561326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c469100>]}
[0m01:09:47.561524 [info ] [MainThread]: Found 4 models, 1 snapshot, 11 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:09:47.561793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829271a0>]}
[0m01:09:47.562508 [info ] [MainThread]: 
[0m01:09:47.562869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:09:47.563375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m01:09:47.568218 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m01:09:47.568388 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m01:09:47.568527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:48.202004 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m01:09:48.204918 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m01:09:48.341589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m01:09:48.352039 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:09:48.352630 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:09:48.353071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:48.797968 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m01:09:48.800147 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:09:48.974545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m01:09:48.978873 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:09:48.979416 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:09:48.980314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:49.638371 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m01:09:49.641332 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:09:49.798802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m01:09:49.804403 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:09:49.805020 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:09:49.805491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:50.544939 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:09:50.547911 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:09:50.674481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c432750>]}
[0m01:09:50.675861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:09:50.676920 [info ] [MainThread]: 
[0m01:09:50.687222 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:09:50.687852 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m01:09:50.688846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m01:09:50.689228 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:09:50.695507 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 01:09:50.689471 => 01:09:50.695329
[0m01:09:50.695827 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:09:50.730739 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:09:50.732935 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:09:50.733169 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace transient table USER_DB_MONKEY.snapshot.eia_rto_hourly_snapshot
         as
        (

    select *,
        md5(coalesce(cast(REGION || SERIES || to_char(DATE, YYYY-MM-DD HH24:MI:SS) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

    ) sbq



        );
[0m01:09:50.733419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:51.200110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d625-0307-2daa-000f-c0df00acc0d6
[0m01:09:51.200399 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 71 unexpected 'HH24'.
syntax error line 6 at position 75 unexpected ':'.
syntax error line 6 at position 83 unexpected 'as'.
syntax error line 6 at position 95 unexpected ','.
[0m01:09:51.200645 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 01:09:50.696039 => 01:09:51.200564
[0m01:09:51.200832 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m01:09:51.320631 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 71 unexpected 'HH24'.
  syntax error line 6 at position 75 unexpected ':'.
  syntax error line 6 at position 83 unexpected 'as'.
  syntax error line 6 at position 95 unexpected ','.
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m01:09:51.320938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd230f644-0129-4251-bc5b-015a6e7bd8aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c115b50>]}
[0m01:09:51.321302 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 0.63s]
[0m01:09:51.321699 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:09:51.322824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:51.323000 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m01:09:51.323158 [info ] [MainThread]: 
[0m01:09:51.323427 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m01:09:51.323717 [debug] [MainThread]: Command end result
[0m01:09:51.328008 [info ] [MainThread]: 
[0m01:09:51.328275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:09:51.328430 [info ] [MainThread]: 
[0m01:09:51.328650 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 71 unexpected 'HH24'.
  syntax error line 6 at position 75 unexpected ':'.
  syntax error line 6 at position 83 unexpected 'as'.
  syntax error line 6 at position 95 unexpected ','.
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m01:09:51.328832 [info ] [MainThread]: 
[0m01:09:51.329026 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:09:51.329451 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.19255, "process_user_time": 2.413009, "process_kernel_time": 0.088926, "process_mem_max_rss": "217804", "process_out_blocks": "1848", "command_success": false, "process_in_blocks": "0"}
[0m01:09:51.329670 [debug] [MainThread]: Command `dbt snapshot` failed at 01:09:51.329618 after 4.19 seconds
[0m01:09:51.329836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e226fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5301a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7c4d10>]}
[0m01:09:51.329984 [debug] [MainThread]: Flushing usage events
[0m01:14:09.260609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b3a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c42180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87df2930>]}


============================== 01:14:09.263491 | 3652cfb7-5d96-4bb1-a7ac-5625999dd17f ==============================
[0m01:14:09.263491 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:14:09.263890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:09.597514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62a7e8d0>]}
[0m01:14:09.644569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62a15c40>]}
[0m01:14:09.644917 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:14:09.648758 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:14:09.679031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:14:09.679286 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://snapshots/electricity.sql
[0m01:14:09.755240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62529a30>]}
[0m01:14:09.761283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62690bc0>]}
[0m01:14:09.761569 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:14:09.761902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62690260>]}
[0m01:14:09.762710 [info ] [MainThread]: 
[0m01:14:09.763183 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:09.763762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m01:14:09.768791 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m01:14:09.768949 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m01:14:09.769104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:10.386095 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m01:14:10.388668 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m01:14:10.563567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m01:14:10.575752 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:14:10.576345 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:14:10.576748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:11.049162 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:14:11.052159 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:14:11.204174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m01:14:11.209814 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:14:11.210429 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:14:11.210855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:11.644978 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m01:14:11.647852 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:14:11.767035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m01:14:11.771820 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:14:11.772455 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:14:11.772975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:13.099621 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m01:14:13.103197 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:14:13.240112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6260f8f0>]}
[0m01:14:13.241381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:13.242506 [info ] [MainThread]: 
[0m01:14:13.251085 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:14:13.251571 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m01:14:13.252249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m01:14:13.252514 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:14:13.259365 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 01:14:13.252709 => 01:14:13.259209
[0m01:14:13.259616 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:14:13.291610 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:14:13.292988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:14:13.293191 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace transient table USER_DB_MONKEY.snapshot.eia_rto_hourly_snapshot
         as
        (

    select *,
        md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

    ) sbq



        );
[0m01:14:13.293446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:14.741311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:14:14.767769 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 01:14:13.259777 => 01:14:14.767568
[0m01:14:14.768241 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m01:14:14.897849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3652cfb7-5d96-4bb1-a7ac-5625999dd17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62439af0>]}
[0m01:14:14.899433 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 1[0m in 1.65s]
[0m01:14:14.901524 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:14:14.904423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:14.904897 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m01:14:14.905381 [info ] [MainThread]: 
[0m01:14:14.906245 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m01:14:14.907000 [debug] [MainThread]: Command end result
[0m01:14:14.917671 [info ] [MainThread]: 
[0m01:14:14.918222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:14.918472 [info ] [MainThread]: 
[0m01:14:14.918844 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:14:14.920107 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.6815267, "process_user_time": 2.531478, "process_kernel_time": 0.134237, "process_mem_max_rss": "220252", "process_out_blocks": "2733", "process_in_blocks": "0"}
[0m01:14:14.920599 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:14:14.920483 after 5.68 seconds
[0m01:14:14.920948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87df2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6260e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8811bfb0>]}
[0m01:14:14.921261 [debug] [MainThread]: Flushing usage events
[0m01:17:15.829339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d669970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7fa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d668c50>]}


============================== 01:17:15.832277 | ef5ae62b-66d1-4be7-b3c5-29cc152b8294 ==============================
[0m01:17:15.832277 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:17:15.832671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:17:16.197564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c7f4830>]}
[0m01:17:16.243771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cb7b1d0>]}
[0m01:17:16.244089 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m01:17:16.247163 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:17:16.275273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:16.275469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:16.277876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c70f380>]}
[0m01:17:16.283522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c36d7c0>]}
[0m01:17:16.283719 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m01:17:16.284006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd22e70>]}
[0m01:17:16.284727 [info ] [MainThread]: 
[0m01:17:16.285056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:16.285566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m01:17:16.290527 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m01:17:16.290692 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m01:17:16.290845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:16.839684 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m01:17:16.842532 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m01:17:17.407851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m01:17:17.417655 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m01:17:17.418208 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m01:17:17.418606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:17.822315 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m01:17:17.825436 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m01:17:17.982189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m01:17:17.986259 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m01:17:17.986907 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m01:17:17.987816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:18.445872 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:17:18.448737 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m01:17:18.574857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m01:17:18.579998 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m01:17:18.580600 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m01:17:18.581117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:19.022758 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m01:17:19.025585 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m01:17:19.149966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c4a1250>]}
[0m01:17:19.151555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:19.153106 [info ] [MainThread]: 
[0m01:17:19.163664 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:17:19.164455 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m01:17:19.165714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m01:17:19.166104 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:17:19.173134 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 01:17:19.166350 => 01:17:19.172946
[0m01:17:19.173496 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:17:19.206686 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:19.206948 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m01:17:19.207146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:19.740565 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m01:17:19.744863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:19.745172 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m01:17:19.838466 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:17:19.843084 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:19.843377 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m01:17:19.932872 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:17:19.956740 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:19.957222 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:17:21.309842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:17:21.311611 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:21.311842 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m01:17:21.408622 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m01:17:21.410482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:21.410699 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m01:17:21.925154 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.0 seconds
[0m01:17:21.929402 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:21.929810 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m01:17:22.038133 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m01:17:22.046834 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:22.047584 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m01:17:22.147811 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m01:17:22.158527 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:22.159242 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m01:17:22.235358 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m01:17:22.248513 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:22.252526 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:22.252985 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m01:17:22.403201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:17:22.404213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:22.404840 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:17:23.565055 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m01:17:23.565993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m01:17:23.566526 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m01:17:23.974715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:17:23.999403 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 01:17:19.173765 => 01:17:23.999084
[0m01:17:23.999955 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m01:17:24.153681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef5ae62b-66d1-4be7-b3c5-29cc152b8294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67538710>]}
[0m01:17:24.155423 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 4.99s]
[0m01:17:24.157513 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m01:17:24.160450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:24.161032 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m01:17:24.161569 [info ] [MainThread]: 
[0m01:17:24.162665 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m01:17:24.163672 [debug] [MainThread]: Command end result
[0m01:17:24.176139 [info ] [MainThread]: 
[0m01:17:24.176780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:24.177092 [info ] [MainThread]: 
[0m01:17:24.177441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:17:24.178550 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.370555, "process_user_time": 2.597053, "process_kernel_time": 0.162635, "process_mem_max_rss": "217684", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m01:17:24.179073 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:17:24.178982 after 8.37 seconds
[0m01:17:24.179421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7fa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8b14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d95eb40>]}
[0m01:17:24.179718 [debug] [MainThread]: Flushing usage events
[0m03:48:38.838036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6558fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb673c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6558b60>]}
[0m03:48:38.838036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc5b20>]}


============================== 03:48:38.841048 | 24162e00-bf30-482b-8d2b-5191dd3c8a72 ==============================
[0m03:48:38.841048 [info ] [MainThread]: Running with dbt=1.7.0


============================== 03:48:38.841082 | 611878be-f2a2-49ec-a4e2-d12732d15c12 ==============================
[0m03:48:38.841082 [info ] [MainThread]: Running with dbt=1.7.0
[0m03:48:38.841312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:48:38.841380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m03:48:39.239086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3bc56a0>]}
[0m03:48:39.245017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dba870>]}
[0m03:48:39.286541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c76cc0>]}
[0m03:48:39.286985 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m03:48:39.290216 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m03:48:39.293146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9567c2f0>]}
[0m03:48:39.293496 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m03:48:39.297031 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m03:48:39.321834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:39.322141 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/moving_avg.sql
[0m03:48:39.322910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:39.323194 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/moving_avg.sql
[0m03:48:39.467588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e12c3b0>]}
[0m03:48:39.467930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950288f0>]}
[0m03:48:39.473674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95280710>]}
[0m03:48:39.473736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e838c80>]}
[0m03:48:39.473881 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m03:48:39.473936 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m03:48:39.474051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f47080>]}
[0m03:48:39.474107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e672060>]}
[0m03:48:39.474938 [info ] [MainThread]: 
[0m03:48:39.474950 [info ] [MainThread]: 
[0m03:48:39.475326 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:39.475358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:39.475985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m03:48:39.475998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m03:48:39.481750 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m03:48:39.481873 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m03:48:39.482001 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m03:48:39.482343 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m03:48:39.482405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:39.482514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:40.031149 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m03:48:40.031145 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m03:48:40.033819 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m03:48:40.033910 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m03:48:40.246189 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m03:48:40.246545 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m03:48:40.246789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:40.247873 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m03:48:40.248302 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m03:48:40.248541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:40.627093 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m03:48:40.630134 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m03:48:40.634413 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m03:48:40.637249 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m03:48:40.764975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m03:48:40.771335 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m03:48:40.771661 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m03:48:40.771905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:40.780434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m03:48:40.785467 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m03:48:40.785733 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m03:48:40.785932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:42.061401 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m03:48:42.065481 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m03:48:42.065778 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m03:48:42.068696 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m03:48:42.193265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m03:48:42.198428 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m03:48:42.198995 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m03:48:42.199515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:42.216552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m03:48:42.220100 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m03:48:42.220637 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m03:48:42.221351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:42.690254 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m03:48:42.691134 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m03:48:42.724274 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m03:48:42.725125 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m03:48:42.831420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m03:48:42.832946 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m03:48:42.833143 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m03:48:42.833305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:42.838740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m03:48:42.840197 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m03:48:42.840391 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m03:48:42.840543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:43.200602 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m03:48:43.203128 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m03:48:43.256415 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m03:48:43.259223 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m03:48:43.334429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f0a6c0>]}
[0m03:48:43.335822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:43.336660 [info ] [MainThread]: 
[0m03:48:43.346522 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m03:48:43.347068 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m03:48:43.347757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now model.energy_consumption_analytics.stg_eia)
[0m03:48:43.348093 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m03:48:43.353706 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.356160 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 03:48:43.348315 => 03:48:43.356002
[0m03:48:43.356455 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m03:48:43.372620 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.373852 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.374080 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m03:48:43.374298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:43.378657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9475f0>]}
[0m03:48:43.379239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:43.379553 [info ] [MainThread]: 
[0m03:48:43.385018 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m03:48:43.385331 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m03:48:43.385752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m03:48:43.385950 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m03:48:43.389296 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.389975 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 03:48:43.386086 => 03:48:43.389876
[0m03:48:43.390158 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m03:48:43.401941 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.402665 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m03:48:43.402851 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m03:48:43.403018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:43.937890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:43.959793 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 03:48:43.356687 => 03:48:43.959627
[0m03:48:43.960177 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m03:48:43.977853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:43.992878 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 03:48:43.390283 => 03:48:43.992742
[0m03:48:43.993169 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m03:48:44.140099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950a4140>]}
[0m03:48:44.141334 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.79s]
[0m03:48:44.142251 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m03:48:44.143797 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m03:48:44.144632 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m03:48:44.145827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m03:48:44.146311 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m03:48:44.153025 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.155235 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 03:48:44.146663 => 03:48:44.154883
[0m03:48:44.155764 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m03:48:44.173122 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.174815 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.175159 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when row_number() over (
                     partition by REGION, SERIES
                     order by DATE
                 ) >= 7
            then avg(VALUE) over (
                     partition by REGION, SERIES
                     order by DATE
                     rows between 6 preceding and current row
                 )
            else null
        end as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m03:48:44.175446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:44.314764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d968dd0>]}
[0m03:48:44.315708 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m03:48:44.316410 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m03:48:44.317477 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m03:48:44.317929 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m03:48:44.318620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m03:48:44.318977 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m03:48:44.323481 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.324682 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 03:48:44.319240 => 03:48:44.324497
[0m03:48:44.324986 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m03:48:44.338771 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.339863 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m03:48:44.340117 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (-- models/output/rto_moving_average.sql


with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when row_number() over (
                     partition by REGION, SERIES
                     order by DATE
                 ) >= 7
            then avg(VALUE) over (
                     partition by REGION, SERIES
                     order by DATE
                     rows between 6 preceding and current row
                 )
            else null
        end as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m03:48:44.340407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:45.717896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m03:48:45.722880 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 03:48:44.156069 => 03:48:45.722616
[0m03:48:45.723481 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m03:48:45.760460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:45.764797 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 03:48:44.325197 => 03:48:45.764530
[0m03:48:45.765389 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m03:48:45.933282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e55dd60>]}
[0m03:48:45.934531 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.61s]
[0m03:48:45.935663 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m03:48:45.936798 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m03:48:45.937412 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m03:48:45.938375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m03:48:45.938896 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m03:48:45.943398 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m03:48:45.945272 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 03:48:45.939230 => 03:48:45.945048
[0m03:48:45.945702 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m03:48:45.949123 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m03:48:45.951628 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m03:48:45.952120 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m03:48:45.952618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:46.803071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95384080>]}
[0m03:48:46.804350 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.66s]
[0m03:48:46.805326 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m03:48:46.806544 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m03:48:46.807231 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m03:48:46.808275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m03:48:46.808726 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m03:48:46.813219 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m03:48:46.815087 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 03:48:46.809033 => 03:48:46.814719
[0m03:48:46.815658 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m03:48:46.818720 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m03:48:46.820454 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m03:48:46.820907 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m03:48:46.821241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:47.669776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m03:48:47.671211 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 03:48:45.945955 => 03:48:47.671114
[0m03:48:47.671430 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m03:48:47.795794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4df890>]}
[0m03:48:47.796439 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.86s]
[0m03:48:47.796965 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m03:48:47.797327 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m03:48:47.797772 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m03:48:47.798373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m03:48:47.798689 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m03:48:47.801432 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:47.803317 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 03:48:47.798921 => 03:48:47.803171
[0m03:48:47.803596 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m03:48:47.805626 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:47.807278 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:47.807715 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m03:48:47.808093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:48.227887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:48.231883 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 03:48:46.815981 => 03:48:48.231643
[0m03:48:48.232595 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m03:48:48.369722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963efa40>]}
[0m03:48:48.370977 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.56s]
[0m03:48:48.371890 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m03:48:48.372475 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m03:48:48.373025 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m03:48:48.373983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m03:48:48.374463 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m03:48:48.378995 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:48.380749 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 03:48:48.374828 => 03:48:48.380511
[0m03:48:48.381142 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m03:48:48.384384 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:48.386771 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m03:48:48.387213 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m03:48:48.387685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:48.825969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:48.830483 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 03:48:47.803912 => 03:48:48.830231
[0m03:48:48.831106 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m03:48:48.975435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '611878be-f2a2-49ec-a4e2-d12732d15c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e539370>]}
[0m03:48:48.976706 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.18s]
[0m03:48:48.977707 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m03:48:48.980120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:48.980529 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m03:48:48.981009 [info ] [MainThread]: 
[0m03:48:48.981462 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m03:48:48.982617 [debug] [MainThread]: Command end result
[0m03:48:48.995029 [info ] [MainThread]: 
[0m03:48:48.995488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:48:48.995814 [info ] [MainThread]: 
[0m03:48:48.996111 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:48:48.997029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.182124, "process_user_time": 2.419191, "process_kernel_time": 0.141714, "process_mem_max_rss": "223692", "process_out_blocks": "2773", "process_in_blocks": "0"}
[0m03:48:48.997488 [debug] [MainThread]: Command `dbt run` succeeded at 03:48:48.997394 after 10.18 seconds
[0m03:48:48.997811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d10fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d72c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5389e0>]}
[0m03:48:48.998099 [debug] [MainThread]: Flushing usage events
[0m03:48:49.478673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:49.483060 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 03:48:48.381404 => 03:48:49.482823
[0m03:48:49.484537 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m03:48:49.638494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24162e00-bf30-482b-8d2b-5191dd3c8a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f0d910>]}
[0m03:48:49.639932 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.26s]
[0m03:48:49.640814 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m03:48:49.643313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:49.643907 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m03:48:49.644503 [info ] [MainThread]: 
[0m03:48:49.645241 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 10.17 seconds (10.17s).
[0m03:48:49.646359 [debug] [MainThread]: Command end result
[0m03:48:49.659979 [info ] [MainThread]: 
[0m03:48:49.660636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:48:49.660934 [info ] [MainThread]: 
[0m03:48:49.661340 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:48:49.662095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.847229, "process_user_time": 2.468284, "process_kernel_time": 0.135318, "process_mem_max_rss": "223592", "process_out_blocks": "2773", "process_in_blocks": "0"}
[0m03:48:49.662460 [debug] [MainThread]: Command `dbt run` succeeded at 03:48:49.662380 after 10.85 seconds
[0m03:48:49.662863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6558b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947f6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9423bb00>]}
[0m03:48:49.663248 [debug] [MainThread]: Flushing usage events
[0m03:48:52.015625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42f0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e0e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67801a0>]}


============================== 03:48:52.018428 | 69fe87bd-d35d-4b27-8b71-a8536679751e ==============================
[0m03:48:52.018428 [info ] [MainThread]: Running with dbt=1.7.0
[0m03:48:52.018816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m03:48:52.388495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f05f560>]}
[0m03:48:52.436191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f76fc50>]}
[0m03:48:52.436568 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m03:48:52.439736 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m03:48:52.469930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:48:52.470223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:48:52.472611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b37530>]}
[0m03:48:52.477905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efdd9a0>]}
[0m03:48:52.478131 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m03:48:52.478476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6c7920>]}
[0m03:48:52.479430 [info ] [MainThread]: 
[0m03:48:52.479812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:52.480423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics'
[0m03:48:52.486385 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m03:48:52.486706 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m03:48:52.486887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:52.927362 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m03:48:52.928283 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m03:48:53.049491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m03:48:53.051129 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m03:48:53.051310 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m03:48:53.051457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:53.056257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e56c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb54680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e638800>]}


============================== 03:48:53.059141 | 14fae870-3c66-4067-abcd-9472f5c7b195 ==============================
[0m03:48:53.059141 [info ] [MainThread]: Running with dbt=1.7.0
[0m03:48:53.059574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:48:53.397121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6c10d0>]}
[0m03:48:53.444281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d39ef00>]}
[0m03:48:53.444624 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m03:48:53.447639 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m03:48:53.470862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:48:53.471033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:48:53.473145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d205520>]}
[0m03:48:53.478437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d2695e0>]}
[0m03:48:53.478629 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m03:48:53.478921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d269130>]}
[0m03:48:53.479738 [info ] [MainThread]: 
[0m03:48:53.480110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:48:53.480700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m03:48:53.486066 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m03:48:53.486248 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m03:48:53.486460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:53.512607 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m03:48:53.513416 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m03:48:53.684688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m03:48:53.687083 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m03:48:53.687420 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m03:48:53.687991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:54.233650 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m03:48:54.234572 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m03:48:54.294525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m03:48:54.295468 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m03:48:54.336544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m03:48:54.337963 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m03:48:54.338132 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m03:48:54.338333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:54.493613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69fe87bd-d35d-4b27-8b71-a8536679751e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efdd670>]}
[0m03:48:54.494108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:54.494532 [info ] [MainThread]: 
[0m03:48:54.498631 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:54.498836 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m03:48:54.499222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m03:48:54.499451 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:54.506754 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:54.508401 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 03:48:54.499586 => 03:48:54.508300
[0m03:48:54.508573 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:54.516285 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:54.517331 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:54.517525 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m03:48:54.517703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:54.699804 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m03:48:54.700692 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m03:48:54.871110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m03:48:54.872260 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m03:48:54.872467 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m03:48:54.872753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:54.921060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:54.924128 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 03:48:54.508683 => 03:48:54.924014
[0m03:48:54.924354 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m03:48:55.042889 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.54s]
[0m03:48:55.043477 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:55.043697 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.043895 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m03:48:55.044262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m03:48:55.044425 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.046842 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.048158 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 03:48:55.044531 => 03:48:55.048073
[0m03:48:55.048357 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.049447 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.050102 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.050275 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m03:48:55.050458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:55.267426 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m03:48:55.268266 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m03:48:55.404432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14fae870-3c66-4067-abcd-9472f5c7b195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d269940>]}
[0m03:48:55.404840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:48:55.405054 [info ] [MainThread]: 
[0m03:48:55.410170 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:55.410410 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m03:48:55.410964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m03:48:55.411255 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:55.418571 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:55.419510 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 03:48:55.411443 => 03:48:55.419375
[0m03:48:55.419714 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:55.428937 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:55.429988 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m03:48:55.430377 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m03:48:55.430688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:55.500006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:55.501586 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 03:48:55.048490 => 03:48:55.501459
[0m03:48:55.501817 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m03:48:55.641547 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.60s]
[0m03:48:55.642271 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.642878 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:55.643241 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m03:48:55.643900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m03:48:55.644194 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:55.649011 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:55.649919 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 03:48:55.644448 => 03:48:55.649799
[0m03:48:55.650117 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:55.651550 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:55.652401 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:55.652616 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m03:48:55.652830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:55.821664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:55.830385 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 03:48:55.419831 => 03:48:55.829976
[0m03:48:55.830974 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m03:48:55.976619 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.57s]
[0m03:48:55.977551 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m03:48:55.978130 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.978769 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m03:48:55.979636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m03:48:55.980078 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.984981 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.986164 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 03:48:55.980325 => 03:48:55.986015
[0m03:48:55.986464 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:55.988319 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.989336 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m03:48:55.989594 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m03:48:55.989828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:56.090960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:56.094200 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 03:48:55.650240 => 03:48:56.093857
[0m03:48:56.094865 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m03:48:56.217360 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.57s]
[0m03:48:56.219017 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:56.220242 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:56.220965 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m03:48:56.222468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m03:48:56.222967 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:56.227807 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:56.229864 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 03:48:56.223285 => 03:48:56.229684
[0m03:48:56.230209 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:56.232504 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:56.233850 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:56.234214 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m03:48:56.234538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:56.347204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:56.350257 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 03:48:55.986651 => 03:48:56.349985
[0m03:48:56.350825 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m03:48:56.470445 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.49s]
[0m03:48:56.471343 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m03:48:56.471826 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:56.472257 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m03:48:56.472963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m03:48:56.473341 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:56.479695 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:56.480973 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 03:48:56.473579 => 03:48:56.480757
[0m03:48:56.481348 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:56.483415 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:56.484325 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m03:48:56.484580 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m03:48:56.484799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:56.766037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:56.769874 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 03:48:56.230469 => 03:48:56.769353
[0m03:48:56.770670 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m03:48:56.851061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:56.854837 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 03:48:56.481565 => 03:48:56.854441
[0m03:48:56.855548 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m03:48:56.900061 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.68s]
[0m03:48:56.901752 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:56.902596 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:56.903225 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m03:48:56.904681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m03:48:56.905239 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:56.911740 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:56.913802 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 03:48:56.905600 => 03:48:56.913524
[0m03:48:56.914411 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:56.919483 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:56.921272 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:56.921704 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m03:48:56.922161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:57.001205 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.53s]
[0m03:48:57.001890 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m03:48:57.002254 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:57.002690 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m03:48:57.003274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m03:48:57.003565 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:57.007137 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:57.008380 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 03:48:57.003739 => 03:48:57.008211
[0m03:48:57.008643 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:57.010438 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:57.011651 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m03:48:57.011928 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m03:48:57.012204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:57.409239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:57.412908 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 03:48:57.008800 => 03:48:57.412542
[0m03:48:57.413572 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m03:48:57.472737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:57.475084 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 03:48:56.914802 => 03:48:57.474843
[0m03:48:57.475543 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m03:48:57.577245 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.57s]
[0m03:48:57.578752 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m03:48:57.579502 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:57.580058 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m03:48:57.581125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m03:48:57.581732 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:57.590313 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:57.592425 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 03:48:57.582229 => 03:48:57.592074
[0m03:48:57.592920 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:57.595472 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:57.596821 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m03:48:57.597227 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m03:48:57.597654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:57.619028 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.71s]
[0m03:48:57.619771 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:57.620230 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:57.620601 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m03:48:57.621354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m03:48:57.621669 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:57.625554 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:57.626651 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 03:48:57.621879 => 03:48:57.626493
[0m03:48:57.626913 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:57.628796 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:57.629854 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:57.630109 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m03:48:57.630379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:58.021841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:58.025041 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 03:48:57.593201 => 03:48:58.024739
[0m03:48:58.025653 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m03:48:58.106503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:58.110242 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 03:48:57.627083 => 03:48:58.109881
[0m03:48:58.111043 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m03:48:58.158972 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.58s]
[0m03:48:58.160606 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m03:48:58.161435 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:58.162042 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m03:48:58.163111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m03:48:58.163711 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:58.170001 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:58.171977 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 03:48:58.164076 => 03:48:58.171696
[0m03:48:58.172580 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:58.175975 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:58.177539 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m03:48:58.178003 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m03:48:58.178397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:58.242521 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.62s]
[0m03:48:58.243573 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:58.244002 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:58.244437 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m03:48:58.245347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m03:48:58.245744 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:58.249762 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:58.250937 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 03:48:58.245982 => 03:48:58.250779
[0m03:48:58.251209 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:58.253154 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:58.254170 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:58.254456 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m03:48:58.254688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:58.705724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:58.709339 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 03:48:58.251463 => 03:48:58.708930
[0m03:48:58.710050 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m03:48:58.846737 [error] [Thread-1 (]: 7 of 11 FAIL 1650 not_null_moving_avg_value_ma_7 ............................... [[31mFAIL 1650[0m in 0.60s]
[0m03:48:58.848484 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:58.849201 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:48:58.849777 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m03:48:58.850947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m03:48:58.851530 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:48:58.858146 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:48:58.859993 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 03:48:58.851960 => 03:48:58.859735
[0m03:48:58.860621 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:48:58.863764 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:48:58.865359 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:48:58.865811 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m03:48:58.866194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:59.075447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:48:59.079167 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 03:48:58.173012 => 03:48:59.078808
[0m03:48:59.079861 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m03:48:59.219331 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 1.06s]
[0m03:48:59.221161 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m03:48:59.221831 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:59.222389 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m03:48:59.223509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m03:48:59.223974 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:59.230159 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:59.231933 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 03:48:59.224276 => 03:48:59.231698
[0m03:48:59.232566 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:48:59.235719 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:59.237240 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m03:48:59.237712 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m03:48:59.238090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:59.349958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:59.353476 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 03:48:58.860996 => 03:48:59.353099
[0m03:48:59.354098 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m03:48:59.482260 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.63s]
[0m03:48:59.483839 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:48:59.484545 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:48:59.485217 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m03:48:59.486804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m03:48:59.487479 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:48:59.493449 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:48:59.495519 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 03:48:59.487874 => 03:48:59.495057
[0m03:48:59.496061 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:48:59.499145 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:48:59.500902 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:48:59.501340 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m03:48:59.501696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:59.638396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:59.640580 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 03:48:59.232985 => 03:48:59.640358
[0m03:48:59.640995 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m03:48:59.856825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:48:59.860495 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 03:48:59.496358 => 03:48:59.860073
[0m03:48:59.861147 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m03:49:00.025432 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.54s]
[0m03:49:00.027182 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:49:00.028071 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:00.028754 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m03:49:00.030129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m03:49:00.030694 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:00.036975 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:00.038653 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 03:49:00.031033 => 03:49:00.038435
[0m03:49:00.039036 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:00.044581 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:00.046134 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:00.046549 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m03:49:00.046902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:00.623869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:49:00.626252 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 03:49:00.039551 => 03:49:00.626024
[0m03:49:00.626745 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m03:49:00.787854 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.76s]
[0m03:49:00.789382 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:00.790010 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:00.790543 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m03:49:00.791846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m03:49:00.792483 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:00.796266 [error] [Thread-1 (]: 7 of 11 FAIL 1650 not_null_moving_avg_value_ma_7 ............................... [[31mFAIL 1650[0m in 1.57s]
[0m03:49:00.797018 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m03:49:00.797467 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:49:00.797587 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:00.797881 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m03:49:00.798637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m03:49:00.799051 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 03:49:00.792864 => 03:49:00.798859
[0m03:49:00.799060 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:49:00.799407 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:00.801544 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:00.802749 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:00.803015 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:49:00.803118 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m03:49:00.803437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:00.803976 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 03:49:00.799396 => 03:49:00.803744
[0m03:49:00.804323 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:49:00.806207 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:49:00.807178 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m03:49:00.807541 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m03:49:00.807778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:01.194909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:49:01.198692 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 03:49:00.804527 => 03:49:01.198360
[0m03:49:01.199470 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m03:49:01.204702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:49:01.207759 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 03:49:00.799628 => 03:49:01.207478
[0m03:49:01.208269 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m03:49:01.333414 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.53s]
[0m03:49:01.334582 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m03:49:01.335315 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:49:01.335875 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m03:49:01.336920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m03:49:01.337637 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:49:01.344016 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:49:01.346649 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 03:49:01.338172 => 03:49:01.346127
[0m03:49:01.347227 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:49:01.350489 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:49:01.351836 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.56s]
[0m03:49:01.351936 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m03:49:01.352710 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m03:49:01.352792 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:01.353050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:01.354961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:01.355372 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m03:49:01.355913 [info ] [MainThread]: 
[0m03:49:01.356526 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m03:49:01.358011 [debug] [MainThread]: Command end result
[0m03:49:01.366663 [info ] [MainThread]: 
[0m03:49:01.367222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:01.367520 [info ] [MainThread]: 
[0m03:49:01.367901 [error] [MainThread]: [31mFailure in test not_null_moving_avg_value_ma_7 (models/schema.yml)[0m
[0m03:49:01.368099 [error] [MainThread]:   Got 1650 results, configured to fail if != 0
[0m03:49:01.368400 [info ] [MainThread]: 
[0m03:49:01.368579 [info ] [MainThread]:   compiled Code at target/compiled/energy_consumption_analytics/models/schema.yml/not_null_moving_avg_value_ma_7.sql
[0m03:49:01.368824 [info ] [MainThread]: 
[0m03:49:01.369032 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m03:49:01.369845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.37648, "process_user_time": 2.679672, "process_kernel_time": 0.11111, "process_mem_max_rss": "217384", "process_out_blocks": "1933", "command_success": false, "process_in_blocks": "0"}
[0m03:49:01.370172 [debug] [MainThread]: Command `dbt test` failed at 03:49:01.370095 after 9.38 seconds
[0m03:49:01.370499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e0e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e31c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6460f0>]}
[0m03:49:01.370808 [debug] [MainThread]: Flushing usage events
[0m03:49:01.768520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:49:01.770907 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 03:49:01.347569 => 03:49:01.770675
[0m03:49:01.771358 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m03:49:01.907483 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.57s]
[0m03:49:01.908094 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m03:49:01.908410 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:01.908685 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m03:49:01.909143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m03:49:01.909375 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:01.913360 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:01.914228 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 03:49:01.909525 => 03:49:01.914117
[0m03:49:01.914445 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:01.915854 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:01.916629 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m03:49:01.916834 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m03:49:01.917075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:02.309441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:49:02.310672 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 03:49:01.914578 => 03:49:02.310547
[0m03:49:02.310968 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m03:49:02.433394 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.52s]
[0m03:49:02.434737 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m03:49:02.435435 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:02.436036 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m03:49:02.437570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m03:49:02.438380 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:02.443696 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:02.445113 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 03:49:02.438733 => 03:49:02.444905
[0m03:49:02.445474 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:02.448247 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:02.449135 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m03:49:02.449504 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m03:49:02.449966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:02.835445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m03:49:02.837872 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 03:49:02.445721 => 03:49:02.837588
[0m03:49:02.838372 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m03:49:03.001582 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.56s]
[0m03:49:03.003043 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m03:49:03.005828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:03.006430 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m03:49:03.006938 [info ] [MainThread]: 
[0m03:49:03.007382 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m03:49:03.009954 [debug] [MainThread]: Command end result
[0m03:49:03.022001 [info ] [MainThread]: 
[0m03:49:03.022777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:03.023235 [info ] [MainThread]: 
[0m03:49:03.023730 [error] [MainThread]: [31mFailure in test not_null_moving_avg_value_ma_7 (models/schema.yml)[0m
[0m03:49:03.024162 [error] [MainThread]:   Got 1650 results, configured to fail if != 0
[0m03:49:03.024597 [info ] [MainThread]: 
[0m03:49:03.025054 [info ] [MainThread]:   compiled Code at target/compiled/energy_consumption_analytics/models/schema.yml/not_null_moving_avg_value_ma_7.sql
[0m03:49:03.025460 [info ] [MainThread]: 
[0m03:49:03.025876 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m03:49:03.027012 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.99081, "process_user_time": 2.764594, "process_kernel_time": 0.106445, "process_mem_max_rss": "217484", "process_out_blocks": "1933", "command_success": false, "process_in_blocks": "0"}
[0m03:49:03.027458 [debug] [MainThread]: Command `dbt test` failed at 03:49:03.027375 after 9.99 seconds
[0m03:49:03.027834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9380aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8ae330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf5b530>]}
[0m03:49:03.028215 [debug] [MainThread]: Flushing usage events
[0m04:01:36.895769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad492660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad67cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad490dd0>]}


============================== 04:01:36.900489 | 61125c0d-df88-4b04-832e-0523d225ffb5 ==============================
[0m04:01:36.900489 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:01:36.900913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:01:36.897860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac736840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8c3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd1bb30>]}


============================== 04:01:36.902294 | b7db1944-0423-48ac-98ac-983e289ec670 ==============================
[0m04:01:36.902294 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:01:36.902896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:01:37.288636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9105c0>]}
[0m04:01:37.308001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac881a00>]}
[0m04:01:37.337126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad490ec0>]}
[0m04:01:37.337541 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:01:37.340769 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:01:37.356901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2c5070>]}
[0m04:01:37.357500 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:01:37.360775 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:01:37.373252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:01:37.373597 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/moving_avg.sql
[0m04:01:37.387876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:01:37.388192 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/moving_avg.sql
[0m04:01:37.527149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87538bf0>]}
[0m04:01:37.533046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c173920>]}
[0m04:01:37.533280 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:01:37.533479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ec5c10>]}
[0m04:01:37.534324 [info ] [MainThread]: 
[0m04:01:37.534700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:01:37.535297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:01:37.538593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d80e30>]}
[0m04:01:37.540603 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:01:37.540767 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:01:37.540935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:37.544370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87439100>]}
[0m04:01:37.544622 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:01:37.544817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86db4710>]}
[0m04:01:37.545661 [info ] [MainThread]: 
[0m04:01:37.546032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:01:37.546638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:01:37.552173 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:01:37.552343 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:01:37.552484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:38.417495 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:01:38.420389 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:01:38.830960 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:01:38.831280 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:01:38.831465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:39.493594 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.0 seconds
[0m04:01:39.496453 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:01:39.777490 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:01:39.780369 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:01:39.885799 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:01:39.886146 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:01:39.886332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:40.038961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m04:01:40.045287 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:01:40.045605 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:01:40.045847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:40.393412 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:01:40.396419 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:01:40.470136 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:01:40.473301 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:01:40.606163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m04:01:40.617064 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:01:40.617715 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:01:40.618186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:41.119913 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:01:41.121492 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:01:41.821328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m04:01:41.826996 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:01:41.827549 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:01:41.827994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:42.373393 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:01:42.375942 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:01:42.608308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:01:42.612648 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:01:42.613214 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:01:42.613650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:42.659538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:01:42.663643 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:01:42.664153 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:01:42.665071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:43.161370 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:01:43.163813 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:01:43.404279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d722a0>]}
[0m04:01:43.405393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:01:43.405986 [info ] [MainThread]: 
[0m04:01:43.414761 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m04:01:43.415206 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m04:01:43.415816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m04:01:43.416117 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m04:01:43.421371 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m04:01:43.423428 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 04:01:43.416320 => 04:01:43.423228
[0m04:01:43.423732 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m04:01:43.425042 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:01:43.426393 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:01:43.439482 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m04:01:43.440436 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m04:01:43.440692 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m04:01:43.440906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:43.629990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:01:43.634190 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:01:43.634770 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:01:43.635162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:44.141989 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:01:44.145233 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:01:44.407098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865761e0>]}
[0m04:01:44.407994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:01:44.408406 [info ] [MainThread]: 
[0m04:01:44.415437 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m04:01:44.415901 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m04:01:44.416443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now model.energy_consumption_analytics.stg_eia)
[0m04:01:44.416703 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m04:01:44.421032 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m04:01:44.421786 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 04:01:44.416849 => 04:01:44.421666
[0m04:01:44.421997 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m04:01:44.436327 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m04:01:44.437096 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m04:01:44.437299 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m04:01:44.437486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:44.612733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:44.633766 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 04:01:43.423915 => 04:01:44.633584
[0m04:01:44.634169 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m04:01:44.834606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f953d0>]}
[0m04:01:44.836079 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 1.42s]
[0m04:01:44.837007 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m04:01:44.838430 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m04:01:44.839040 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m04:01:44.839978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m04:01:44.840591 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m04:01:44.847061 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m04:01:44.848944 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 04:01:44.841006 => 04:01:44.848652
[0m04:01:44.849431 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m04:01:44.866781 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m04:01:44.868168 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m04:01:44.868506 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m04:01:44.868912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:45.096881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:45.121201 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 04:01:44.422126 => 04:01:45.120988
[0m04:01:45.121647 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m04:01:45.341603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86575130>]}
[0m04:01:45.342899 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m04:01:45.343887 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m04:01:45.345328 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m04:01:45.345946 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m04:01:45.346885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m04:01:45.347344 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m04:01:45.353653 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m04:01:45.355482 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 04:01:45.347662 => 04:01:45.355193
[0m04:01:45.356082 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m04:01:45.373066 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m04:01:45.374402 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m04:01:45.374708 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m04:01:45.374978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:47.335804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:01:47.337104 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 04:01:45.356370 => 04:01:47.337015
[0m04:01:47.337304 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m04:01:47.510335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87121d30>]}
[0m04:01:47.510755 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.16s]
[0m04:01:47.511159 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m04:01:47.511410 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m04:01:47.511671 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m04:01:47.512024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m04:01:47.512195 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m04:01:47.513671 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m04:01:47.514386 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 04:01:47.512308 => 04:01:47.514304
[0m04:01:47.514549 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m04:01:47.515708 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m04:01:47.516609 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m04:01:47.516787 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m04:01:47.516999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:47.544344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m04:01:47.545639 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 04:01:44.849741 => 04:01:47.545531
[0m04:01:47.545823 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m04:01:47.771971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d332f0>]}
[0m04:01:47.772350 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.93s]
[0m04:01:47.772709 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m04:01:47.773600 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m04:01:47.773880 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m04:01:47.774213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m04:01:47.774387 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m04:01:47.775869 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m04:01:47.776511 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 04:01:47.774503 => 04:01:47.776432
[0m04:01:47.776685 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m04:01:47.777778 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m04:01:47.778528 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m04:01:47.778714 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m04:01:47.778882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:49.183826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:01:49.188148 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 04:01:47.514683 => 04:01:49.187882
[0m04:01:49.188750 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m04:01:49.409541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87121490>]}
[0m04:01:49.411021 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.90s]
[0m04:01:49.411991 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m04:01:49.412610 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m04:01:49.413227 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m04:01:49.414708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m04:01:49.415297 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m04:01:49.420251 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:49.422841 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 04:01:49.415646 => 04:01:49.422607
[0m04:01:49.423208 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m04:01:49.426720 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:49.429089 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:49.429546 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m04:01:49.429972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:49.701166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:01:49.705460 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 04:01:47.776791 => 04:01:49.705207
[0m04:01:49.706067 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m04:01:50.167814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d772c0>]}
[0m04:01:50.168294 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 2.39s]
[0m04:01:50.168660 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m04:01:50.168927 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m04:01:50.169179 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m04:01:50.169565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m04:01:50.169767 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m04:01:50.171617 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:50.172369 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 04:01:50.169904 => 04:01:50.172273
[0m04:01:50.172574 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m04:01:50.173909 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:50.174650 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m04:01:50.174820 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m04:01:50.174994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:50.920094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:50.923376 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 04:01:49.423474 => 04:01:50.923177
[0m04:01:50.923856 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m04:01:51.166334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7db1944-0423-48ac-98ac-983e289ec670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87138a40>]}
[0m04:01:51.167661 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.75s]
[0m04:01:51.168527 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m04:01:51.171083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:01:51.171601 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m04:01:51.172129 [info ] [MainThread]: 
[0m04:01:51.172596 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 13.63 seconds (13.63s).
[0m04:01:51.173873 [debug] [MainThread]: Command end result
[0m04:01:51.188098 [info ] [MainThread]: 
[0m04:01:51.188500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:01:51.188811 [info ] [MainThread]: 
[0m04:01:51.189230 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:01:51.190187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.3170595, "process_user_time": 2.432541, "process_kernel_time": 0.158665, "process_mem_max_rss": "223920", "process_out_blocks": "2767", "process_in_blocks": "0"}
[0m04:01:51.190583 [debug] [MainThread]: Command `dbt run` succeeded at 04:01:51.190483 after 14.32 seconds
[0m04:01:51.190854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac910b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19b6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8610a0f0>]}
[0m04:01:51.191118 [debug] [MainThread]: Flushing usage events
[0m04:01:52.005842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:01:52.007117 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 04:01:50.172711 => 04:01:52.007041
[0m04:01:52.007297 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m04:01:52.225889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61125c0d-df88-4b04-832e-0523d225ffb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d8f6b0>]}
[0m04:01:52.226806 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 2.06s]
[0m04:01:52.227564 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m04:01:52.229368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:01:52.229727 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m04:01:52.230103 [info ] [MainThread]: 
[0m04:01:52.230474 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 14.70 seconds (14.70s).
[0m04:01:52.231489 [debug] [MainThread]: Command end result
[0m04:01:52.241618 [info ] [MainThread]: 
[0m04:01:52.241916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:01:52.242166 [info ] [MainThread]: 
[0m04:01:52.242421 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:01:52.243119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.372064, "process_user_time": 2.466685, "process_kernel_time": 0.166531, "process_mem_max_rss": "223856", "process_out_blocks": "2767", "process_in_blocks": "0"}
[0m04:01:52.243451 [debug] [MainThread]: Command `dbt run` succeeded at 04:01:52.243377 after 15.37 seconds
[0m04:01:52.243717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad67cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d3a750>]}
[0m04:01:52.243949 [debug] [MainThread]: Flushing usage events
[0m04:01:54.346114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49c4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5966000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49c4830>]}


============================== 04:01:54.348888 | d13d3098-8954-4826-aa94-90b76c94765d ==============================
[0m04:01:54.348888 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:01:54.349160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:01:54.710419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa221b0>]}
[0m04:01:54.758473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f71ba40>]}
[0m04:01:54.758901 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:01:54.762055 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:01:54.785573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:01:54.785759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:01:54.787977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f757d10>]}
[0m04:01:54.792745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5e9730>]}
[0m04:01:54.792937 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:01:54.793080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb177f1a0>]}
[0m04:01:54.793973 [info ] [MainThread]: 
[0m04:01:54.794309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:01:54.794898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m04:01:54.800509 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:01:54.800707 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:01:54.800883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:55.361961 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:01:55.362870 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:01:55.399983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2fe000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbcdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbcdb80>]}


============================== 04:01:55.402568 | 0f18d2ef-8c93-4710-b894-a3de8f75390b ==============================
[0m04:01:55.402568 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:01:55.402961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:01:55.549345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m04:01:55.550833 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:01:55.551042 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:01:55.551246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:55.742639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3b5850>]}
[0m04:01:55.788294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907354c0>]}
[0m04:01:55.788604 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:01:55.791669 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:01:55.814838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:01:55.814991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:01:55.817110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e0c0a40>]}
[0m04:01:55.821866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dff95b0>]}
[0m04:01:55.822056 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:01:55.822362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e12f110>]}
[0m04:01:55.823215 [info ] [MainThread]: 
[0m04:01:55.823588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:01:55.824129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m04:01:55.829511 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:01:55.829677 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:01:55.829828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:01:56.038250 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:01:56.039427 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:01:56.286067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m04:01:56.291600 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:01:56.292239 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:01:56.292731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:56.553662 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:01:56.556750 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:01:56.737412 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:01:56.740236 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:01:56.743900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:01:56.747449 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:01:56.747847 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:01:56.748156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:56.958537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd13d3098-8954-4826-aa94-90b76c94765d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5e9af0>]}
[0m04:01:56.959928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:01:56.960345 [info ] [MainThread]: 
[0m04:01:56.970831 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:56.971341 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m04:01:56.972061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m04:01:56.972386 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:56.986895 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:56.988207 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 04:01:56.972590 => 04:01:56.988063
[0m04:01:56.988483 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:57.000415 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:57.001501 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:57.001726 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m04:01:57.001943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:57.261973 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:01:57.264863 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:01:57.469667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:01:57.473339 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:01:57.473945 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:01:57.475114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:01:57.955827 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:01:57.958618 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:01:58.147564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f18d2ef-8c93-4710-b894-a3de8f75390b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6de49610>]}
[0m04:01:58.148054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:01:58.148411 [info ] [MainThread]: 
[0m04:01:58.153268 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:58.153526 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m04:01:58.154168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m04:01:58.154374 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:58.162453 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:58.163187 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 04:01:58.154513 => 04:01:58.163087
[0m04:01:58.163365 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:58.171849 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:58.172477 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:01:58.172643 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m04:01:58.172786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:58.306275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:58.311145 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 04:01:56.988718 => 04:01:58.310953
[0m04:01:58.311462 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m04:01:58.567039 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.59s]
[0m04:01:58.568201 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:58.568903 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.569486 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m04:01:58.570467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m04:01:58.571047 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.578360 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.580032 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 04:01:58.571323 => 04:01:58.579793
[0m04:01:58.580390 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.583453 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.585190 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.585586 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m04:01:58.585981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:58.696238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:58.705209 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 04:01:58.163487 => 04:01:58.704852
[0m04:01:58.705867 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m04:01:58.936993 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.78s]
[0m04:01:58.937834 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:01:58.938151 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.938502 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m04:01:58.939175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m04:01:58.939447 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.943642 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.944722 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 04:01:58.939608 => 04:01:58.944518
[0m04:01:58.945072 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:58.946802 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.947729 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:01:58.947965 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m04:01:58.948214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:59.445368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:59.449177 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 04:01:58.580681 => 04:01:59.448817
[0m04:01:59.449900 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m04:01:59.677247 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 1.11s]
[0m04:01:59.678341 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:59.678933 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.679435 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m04:01:59.680308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m04:01:59.680759 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.688306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:01:59.689712 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.691604 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 04:01:59.681059 => 04:01:59.691249
[0m04:01:59.692200 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.692414 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 04:01:58.945262 => 04:01:59.692114
[0m04:01:59.695248 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.695659 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m04:01:59.696531 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.696913 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m04:01:59.697198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:01:59.867951 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.93s]
[0m04:01:59.869545 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:01:59.870217 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.870791 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m04:01:59.871919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m04:01:59.872392 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.880959 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.882460 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 04:01:59.872711 => 04:01:59.882238
[0m04:01:59.882884 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:01:59.885579 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.886888 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:01:59.887225 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m04:01:59.887560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:00.321407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:00.324911 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 04:01:59.692565 => 04:02:00.324553
[0m04:02:00.325489 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m04:02:00.351528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:00.354524 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 04:01:59.883170 => 04:02:00.354248
[0m04:02:00.355035 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m04:02:00.534888 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.85s]
[0m04:02:00.536105 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:02:00.536896 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.537408 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m04:02:00.538297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m04:02:00.538774 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.544805 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.546492 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 04:02:00.539044 => 04:02:00.546237
[0m04:02:00.546901 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.549873 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.551445 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.551899 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m04:02:00.552328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:00.561065 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.69s]
[0m04:02:00.561702 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:02:00.562107 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.562478 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m04:02:00.563222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m04:02:00.563519 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.567071 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.568083 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 04:02:00.563731 => 04:02:00.567894
[0m04:02:00.568385 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:00.570272 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.571174 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:02:00.571435 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m04:02:00.571705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:01.068126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:01.071149 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 04:02:00.568581 => 04:02:01.070888
[0m04:02:01.071685 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m04:02:01.141972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:01.143757 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 04:02:00.547117 => 04:02:01.143521
[0m04:02:01.144157 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m04:02:01.312748 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.75s]
[0m04:02:01.314519 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:01.315221 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.315816 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m04:02:01.317238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m04:02:01.317796 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.325196 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.327032 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 04:02:01.318108 => 04:02:01.326717
[0m04:02:01.327532 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.330223 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.331774 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.332184 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m04:02:01.332503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:01.341008 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.80s]
[0m04:02:01.342424 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:02:01.342870 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.343202 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m04:02:01.343756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m04:02:01.344099 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.347738 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.348469 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 04:02:01.344330 => 04:02:01.348337
[0m04:02:01.348709 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:01.351467 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.352229 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:02:01.352441 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m04:02:01.352638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:01.951404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:01.954728 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 04:02:01.327856 => 04:02:01.954411
[0m04:02:01.955341 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m04:02:01.988301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:01.991849 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 04:02:01.348851 => 04:02:01.991489
[0m04:02:01.992399 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m04:02:02.165067 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.85s]
[0m04:02:02.166598 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:02.167302 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.167798 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m04:02:02.168925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m04:02:02.169407 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.175285 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.177739 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 04:02:02.169714 => 04:02:02.177524
[0m04:02:02.178093 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.181226 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.182824 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.183259 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m04:02:02.183751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:02.194242 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.85s]
[0m04:02:02.194997 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:02:02.195411 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.195817 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m04:02:02.196442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m04:02:02.196736 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.200316 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.201264 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 04:02:02.196910 => 04:02:02.201113
[0m04:02:02.201529 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.203262 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.203985 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:02:02.204196 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m04:02:02.204388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:02.644989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:02.648926 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 04:02:02.201730 => 04:02:02.648564
[0m04:02:02.649721 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m04:02:02.721003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:02.724480 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 04:02:02.178418 => 04:02:02.724158
[0m04:02:02.725030 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m04:02:02.886331 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.69s]
[0m04:02:02.887482 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.888114 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.888570 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m04:02:02.889545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m04:02:02.890043 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.896201 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.897896 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 04:02:02.890352 => 04:02:02.897610
[0m04:02:02.898277 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.901510 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.903336 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.903812 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m04:02:02.904121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:02.982744 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.81s]
[0m04:02:02.983780 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:02:02.984241 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.984614 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m04:02:02.985462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m04:02:02.985812 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.989943 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.991032 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 04:02:02.986058 => 04:02:02.990872
[0m04:02:02.991334 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:02.993309 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.994387 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:02:02.994678 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m04:02:02.994992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:03.416879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:03.420793 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 04:02:02.898525 => 04:02:03.420463
[0m04:02:03.421358 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m04:02:03.456255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:03.459757 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 04:02:02.991534 => 04:02:03.459389
[0m04:02:03.460364 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m04:02:03.615002 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.63s]
[0m04:02:03.616594 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:03.617279 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.617795 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m04:02:03.618944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m04:02:03.619453 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.625369 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.627106 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 04:02:03.619808 => 04:02:03.626910
[0m04:02:03.627463 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.630747 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.632475 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.632940 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m04:02:03.633313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:03.676410 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.79s]
[0m04:02:03.677217 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:02:03.677743 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.678175 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m04:02:03.678878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m04:02:03.679193 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.683409 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.684466 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 04:02:03.679414 => 04:02:03.684307
[0m04:02:03.684751 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:03.686732 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.687694 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:02:03.688041 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m04:02:03.688302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:04.127529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:04.131256 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 04:02:03.684915 => 04:02:04.130783
[0m04:02:04.132066 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m04:02:04.135405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:04.138127 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 04:02:03.627704 => 04:02:04.137842
[0m04:02:04.138703 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m04:02:04.358007 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.68s]
[0m04:02:04.359265 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:04.359928 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.360420 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m04:02:04.361360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m04:02:04.361853 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.361491 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.74s]
[0m04:02:04.363049 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:02:04.363672 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.364128 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m04:02:04.365039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m04:02:04.365615 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.368699 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.370480 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 04:02:04.362575 => 04:02:04.370218
[0m04:02:04.371278 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.371695 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.373357 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 04:02:04.366020 => 04:02:04.372932
[0m04:02:04.373843 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:04.375361 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.376666 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.378318 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.378777 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m04:02:04.379001 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:02:04.379169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:04.379459 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m04:02:04.379793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:05.088832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:05.092796 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 04:02:04.372267 => 04:02:05.092438
[0m04:02:05.093504 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m04:02:05.216393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:05.219879 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 04:02:04.374135 => 04:02:05.219544
[0m04:02:05.220417 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m04:02:05.300457 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.94s]
[0m04:02:05.301642 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:05.302305 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.302852 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m04:02:05.303738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m04:02:05.304241 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.310329 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.311965 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 04:02:05.304695 => 04:02:05.311706
[0m04:02:05.312366 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.316711 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.317972 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.318321 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m04:02:05.318608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:05.451392 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 1.09s]
[0m04:02:05.452817 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:02:05.453453 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.454175 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m04:02:05.455472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m04:02:05.455920 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.461988 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.463110 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 04:02:05.456194 => 04:02:05.462884
[0m04:02:05.463420 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:05.465528 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.466441 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:02:05.466729 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m04:02:05.466969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:05.868495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:05.872054 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 04:02:05.312662 => 04:02:05.871735
[0m04:02:05.872684 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m04:02:05.907346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:05.911207 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 04:02:05.463596 => 04:02:05.910883
[0m04:02:05.911788 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m04:02:06.064078 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.76s]
[0m04:02:06.064661 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:06.064994 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.065277 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m04:02:06.065794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m04:02:06.066064 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.069370 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.070449 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 04:02:06.066264 => 04:02:06.070256
[0m04:02:06.070742 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.072397 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.073264 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.073494 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m04:02:06.073692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:06.268163 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.81s]
[0m04:02:06.269924 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:02:06.270485 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.270945 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m04:02:06.272031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m04:02:06.272459 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.278297 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.279855 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 04:02:06.272771 => 04:02:06.279610
[0m04:02:06.280193 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:06.283300 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.284804 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:02:06.285222 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m04:02:06.285659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:07.299320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:07.304736 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 04:02:06.280398 => 04:02:07.304416
[0m04:02:07.305344 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m04:02:08.019536 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 1.75s]
[0m04:02:08.020792 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:08.022964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:08.023374 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m04:02:08.023797 [info ] [MainThread]: 
[0m04:02:08.024324 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m04:02:08.026066 [debug] [MainThread]: Command end result
[0m04:02:08.035706 [info ] [MainThread]: 
[0m04:02:08.036128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:08.036446 [info ] [MainThread]: 
[0m04:02:08.036807 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:02:08.037592 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.657487, "process_user_time": 2.879581, "process_kernel_time": 0.110251, "process_mem_max_rss": "217616", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m04:02:08.037979 [debug] [MainThread]: Command `dbt test` succeeded at 04:02:08.037871 after 12.66 seconds
[0m04:02:08.038265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9c51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f40f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d341fa0>]}
[0m04:02:08.038530 [debug] [MainThread]: Flushing usage events
[0m04:02:08.226114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:02:08.228098 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 04:02:06.070916 => 04:02:08.227888
[0m04:02:08.228522 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m04:02:08.701371 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 2.64s]
[0m04:02:08.701956 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:02:08.703509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:08.703792 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m04:02:08.704898 [info ] [MainThread]: 
[0m04:02:08.705158 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 13.91 seconds (13.91s).
[0m04:02:08.705913 [debug] [MainThread]: Command end result
[0m04:02:08.712422 [info ] [MainThread]: 
[0m04:02:08.712704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:08.712898 [info ] [MainThread]: 
[0m04:02:08.713082 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:02:08.713618 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.39029, "process_user_time": 2.728604, "process_kernel_time": 0.133273, "process_mem_max_rss": "217324", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m04:02:08.713858 [debug] [MainThread]: Command `dbt test` succeeded at 04:02:08.713811 after 14.39 seconds
[0m04:02:08.714034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c0aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f485a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc7dbb0>]}
[0m04:02:08.714219 [debug] [MainThread]: Flushing usage events
[0m04:02:13.894126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3d5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3d6120>]}


============================== 04:02:13.897230 | 10d48564-1298-4879-8566-689875bc32d6 ==============================
[0m04:02:13.897230 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:02:13.897474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:02:14.257786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5795fd70>]}
[0m04:02:14.305039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c688e60>]}
[0m04:02:14.305432 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:02:14.308535 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:02:14.330945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:02:14.331160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:02:14.333469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff572df8c0>]}
[0m04:02:14.338838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57089280>]}
[0m04:02:14.339041 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:02:14.339238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5742a930>]}
[0m04:02:14.340010 [info ] [MainThread]: 
[0m04:02:14.340343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:02:14.340864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:02:14.346107 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:02:14.346290 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:02:14.346432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:14.735309 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m04:02:14.736146 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:02:15.028457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9717bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9540fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95957980>]}


============================== 04:02:15.031055 | 3f46cb84-277b-4086-bf29-205f78e34b37 ==============================
[0m04:02:15.031055 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:02:15.031448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:02:15.221256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m04:02:15.224721 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:02:15.224905 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:02:15.225058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:15.381392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff758e3410>]}
[0m04:02:15.427621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7421b830>]}
[0m04:02:15.427927 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:02:15.430983 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:02:15.455188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:02:15.455380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:02:15.457654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab60560>]}
[0m04:02:15.462557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fef0b00>]}
[0m04:02:15.462761 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:02:15.463023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7413c710>]}
[0m04:02:15.463787 [info ] [MainThread]: 
[0m04:02:15.464140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:02:15.464652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:02:15.469604 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:02:15.469778 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:02:15.469898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:15.648085 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:02:15.649507 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:02:15.885797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:02:15.888192 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:02:15.888478 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:02:15.889018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:15.905277 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m04:02:15.906817 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:02:16.078478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m04:02:16.082968 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:02:16.083192 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:02:16.083368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:16.355368 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:02:16.357782 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:02:16.539767 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:02:16.541710 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:02:16.577937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:02:16.580964 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:02:16.581344 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:02:16.581737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:16.753124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:02:16.757392 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:02:16.758075 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:02:16.759205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:16.990925 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:16.994236 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:02:17.187772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff576e64b0>]}
[0m04:02:17.189132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:02:17.189688 [info ] [MainThread]: 
[0m04:02:17.200660 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:17.201388 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m04:02:17.204241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m04:02:17.204706 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:17.211451 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 04:02:17.204980 => 04:02:17.211229
[0m04:02:17.211798 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:17.244414 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:17.244682 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m04:02:17.244896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:17.463787 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:02:17.466435 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:02:17.669275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:02:17.673330 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:02:17.673915 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:02:17.674393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:02:17.774936 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:02:17.786903 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:17.787723 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:17.890420 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:17.896664 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:17.897092 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:17.990789 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:18.019150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:18.019598 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:02:18.146562 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:18.147590 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:02:18.408075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fcc5c70>]}
[0m04:02:18.409411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:02:18.410392 [info ] [MainThread]: 
[0m04:02:18.421245 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:18.422022 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m04:02:18.424868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m04:02:18.425334 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:18.431677 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 04:02:18.425657 => 04:02:18.431453
[0m04:02:18.432030 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:18.463288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:18.463518 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m04:02:18.463706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:02:18.995492 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:02:19.007272 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.008101 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:19.102142 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:19.111660 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.112414 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:19.489693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:19.491086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.491278 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:19.602115 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:19.603749 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.603939 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:19.648285 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:02:19.659067 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.659335 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:02:19.685257 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:19.686911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.687103 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:19.791547 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:19.793851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.794049 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:19.886434 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:19.889351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.889538 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:19.985012 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:19.988299 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.989975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:19.990157 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m04:02:20.109550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:20.111860 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:20.113846 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:02:20.925502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:02:20.927251 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:20.927528 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:20.949607 [debug] [Thread-1 (]: SQL status: SUCCESS 268 in 1.0 seconds
[0m04:02:20.949993 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:20.950287 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m04:02:21.015191 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:21.018170 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.018510 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:21.097188 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:21.102792 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.103411 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:21.208280 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:21.216004 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.216666 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:02:21.292324 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:02:21.302772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.303453 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:02:21.370910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:21.391444 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 04:02:17.211994 => 04:02:21.391269
[0m04:02:21.391735 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m04:02:21.405855 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:02:21.411688 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.412890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.413187 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m04:02:21.528807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:21.529630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:21.530137 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:02:21.760522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10d48564-1298-4879-8566-689875bc32d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56d31760>]}
[0m04:02:21.761977 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 268[0m in 4.56s]
[0m04:02:21.762804 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:21.765310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:21.765899 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m04:02:21.766404 [info ] [MainThread]: 
[0m04:02:21.766845 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m04:02:21.767592 [debug] [MainThread]: Command end result
[0m04:02:21.778869 [info ] [MainThread]: 
[0m04:02:21.779325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:21.779624 [info ] [MainThread]: 
[0m04:02:21.780174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:02:21.781317 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.913637, "process_user_time": 2.469621, "process_kernel_time": 0.084712, "process_mem_max_rss": "217464", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m04:02:21.781868 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:02:21.781747 after 7.91 seconds
[0m04:02:21.782234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6c7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6c6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff732ceed0>]}
[0m04:02:21.782599 [debug] [MainThread]: Flushing usage events
[0m04:02:22.429471 [debug] [Thread-1 (]: SQL status: SUCCESS 167 in 1.0 seconds
[0m04:02:22.430498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:02:22.431162 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m04:02:22.750990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:02:22.774285 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 04:02:18.432228 => 04:02:22.774048
[0m04:02:22.774845 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m04:02:22.987829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f46cb84-277b-4086-bf29-205f78e34b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb69610>]}
[0m04:02:22.988419 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 167[0m in 4.57s]
[0m04:02:22.988776 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:02:22.989799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:22.990018 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m04:02:22.990217 [info ] [MainThread]: 
[0m04:02:22.990436 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m04:02:22.990772 [debug] [MainThread]: Command end result
[0m04:02:22.995778 [info ] [MainThread]: 
[0m04:02:22.996215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:22.996449 [info ] [MainThread]: 
[0m04:02:22.996677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:02:22.997183 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.989013, "process_user_time": 2.55335, "process_kernel_time": 0.109271, "process_mem_max_rss": "217768", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m04:02:22.997381 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:02:22.997336 after 7.99 seconds
[0m04:02:22.997544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d43980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952f17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95590500>]}
[0m04:02:22.997689 [debug] [MainThread]: Flushing usage events
[0m04:34:02.995761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa734620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa254f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae24ce0>]}


============================== 04:34:02.998723 | 0dc4f36f-fb44-44cf-9d41-cd26f9f45500 ==============================
[0m04:34:02.998723 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:34:02.999132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:34:03.335439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8accfc20>]}
[0m04:34:03.381445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa12720>]}
[0m04:34:03.381780 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:34:03.385072 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:34:03.413334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:03.413516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:03.415642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895482c0>]}
[0m04:34:03.421164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89449580>]}
[0m04:34:03.421382 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:34:03.421654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1f8500>]}
[0m04:34:03.422451 [info ] [MainThread]: 
[0m04:34:03.422811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:03.423414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:34:03.428373 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:34:03.428522 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:34:03.428641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:04.142157 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:34:04.144997 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:34:04.302284 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:34:04.303112 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:34:04.303800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:05.645492 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:34:05.648388 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:34:06.615561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m04:34:06.622625 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:34:06.622939 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:34:06.623147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:07.450378 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:34:07.453244 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:34:07.781837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m04:34:07.789384 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:34:07.789973 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:34:07.790378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:08.464003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:34:08.467057 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:34:08.794066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m04:34:08.797910 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:34:08.798386 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:34:08.798792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:09.548335 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:34:09.551282 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:34:09.747553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8927e360>]}
[0m04:34:09.749418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:09.750929 [info ] [MainThread]: 
[0m04:34:09.763263 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m04:34:09.764007 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m04:34:09.765134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m04:34:09.765562 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m04:34:09.772659 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m04:34:09.774207 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 04:34:09.765831 => 04:34:09.774035
[0m04:34:09.774524 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m04:34:09.791938 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m04:34:09.792984 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m04:34:09.793199 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m04:34:09.793405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:10.617727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:10.642239 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 04:34:09.774805 => 04:34:10.642023
[0m04:34:10.642703 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m04:34:10.797066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8912b560>]}
[0m04:34:10.798311 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m04:34:10.799885 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m04:34:10.801436 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m04:34:10.802025 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m04:34:10.803208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m04:34:10.803779 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m04:34:10.807522 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m04:34:10.809298 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 04:34:10.804159 => 04:34:10.809101
[0m04:34:10.809672 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m04:34:10.827675 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m04:34:10.829134 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m04:34:10.829445 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m04:34:10.829746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:12.256255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:12.259335 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 04:34:10.809918 => 04:34:12.259131
[0m04:34:12.259715 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m04:34:12.396822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8913ec00>]}
[0m04:34:12.398152 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.59s]
[0m04:34:12.400112 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m04:34:12.400796 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m04:34:12.401450 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m04:34:12.402604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m04:34:12.403121 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m04:34:12.408179 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m04:34:12.410069 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 04:34:12.403468 => 04:34:12.409857
[0m04:34:12.410836 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m04:34:12.414213 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m04:34:12.416386 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m04:34:12.416901 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m04:34:12.417282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:13.859061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:13.863337 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 04:34:12.411158 => 04:34:13.863106
[0m04:34:13.863936 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m04:34:14.016896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8870d640>]}
[0m04:34:14.018119 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.61s]
[0m04:34:14.019595 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m04:34:14.020279 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m04:34:14.020997 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m04:34:14.022056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m04:34:14.022636 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m04:34:14.029350 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:34:14.031733 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 04:34:14.023154 => 04:34:14.031383
[0m04:34:14.032258 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m04:34:14.035407 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:34:14.037124 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m04:34:14.037568 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m04:34:14.037953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:16.546591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m04:34:16.550707 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 04:34:14.032597 => 04:34:16.550465
[0m04:34:16.551286 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m04:34:16.688747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc4f36f-fb44-44cf-9d41-cd26f9f45500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8916aea0>]}
[0m04:34:16.689395 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 2.67s]
[0m04:34:16.690426 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m04:34:16.692385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:16.692773 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m04:34:16.693176 [info ] [MainThread]: 
[0m04:34:16.693717 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 13.27 seconds (13.27s).
[0m04:34:16.694607 [debug] [MainThread]: Command end result
[0m04:34:16.702927 [info ] [MainThread]: 
[0m04:34:16.703393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:16.703718 [info ] [MainThread]: 
[0m04:34:16.704108 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:34:16.705003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.730605, "process_user_time": 2.678313, "process_kernel_time": 0.135965, "process_mem_max_rss": "217764", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m04:34:16.705395 [debug] [MainThread]: Command `dbt run` succeeded at 04:34:16.705296 after 13.73 seconds
[0m04:34:16.705678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa254f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad495a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad412f30>]}
[0m04:34:16.705995 [debug] [MainThread]: Flushing usage events
[0m04:34:19.764055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d02d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1bcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d02c3b0>]}


============================== 04:34:19.766744 | ce1c5fa6-9236-4267-9e4f-bac4b329e600 ==============================
[0m04:34:19.766744 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:34:19.767214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:34:20.114461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67edfe90>]}
[0m04:34:20.159008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd76ae0>]}
[0m04:34:20.159316 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:34:20.162303 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:34:20.186286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:20.186466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:20.188613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67db8f50>]}
[0m04:34:20.193725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67cf17c0>]}
[0m04:34:20.193915 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:34:20.194164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67cf12e0>]}
[0m04:34:20.195032 [info ] [MainThread]: 
[0m04:34:20.195440 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:20.196026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m04:34:20.201729 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:34:20.201885 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:34:20.202022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:20.665262 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:34:20.666186 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:34:20.805036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m04:34:20.807658 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:34:20.808040 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:34:20.808376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:21.260941 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:34:21.263553 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:34:21.454267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m04:34:21.457021 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:34:21.457436 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:34:21.458080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:21.883098 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:21.886217 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:34:22.030544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1c5fa6-9236-4267-9e4f-bac4b329e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67cf18e0>]}
[0m04:34:22.032107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:22.033337 [info ] [MainThread]: 
[0m04:34:22.043796 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:34:22.044500 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m04:34:22.046181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m04:34:22.046633 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:34:22.061307 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:34:22.063750 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 04:34:22.046902 => 04:34:22.063530
[0m04:34:22.064064 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:34:22.076246 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:34:22.077659 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:34:22.077917 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m04:34:22.078174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:22.670231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:22.679098 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 04:34:22.064253 => 04:34:22.678734
[0m04:34:22.679770 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m04:34:22.810967 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.77s]
[0m04:34:22.812756 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:34:22.813470 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:34:22.814105 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m04:34:22.815284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m04:34:22.815795 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:34:22.823847 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:34:22.825865 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 04:34:22.816117 => 04:34:22.825568
[0m04:34:22.826327 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:34:22.829119 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:34:22.830664 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:34:22.831059 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m04:34:22.831453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:23.374577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:23.377146 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 04:34:22.826613 => 04:34:23.376900
[0m04:34:23.377634 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m04:34:23.511706 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.70s]
[0m04:34:23.512265 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:34:23.512487 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:34:23.512701 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m04:34:23.513062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m04:34:23.513222 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:34:23.516198 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:34:23.516938 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 04:34:23.513331 => 04:34:23.516854
[0m04:34:23.517091 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:34:23.518121 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:34:23.518724 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:34:23.518918 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m04:34:23.519077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:24.439269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:24.441244 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 04:34:23.517195 => 04:34:24.441104
[0m04:34:24.441605 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m04:34:24.557138 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 1.04s]
[0m04:34:24.557761 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:34:24.558030 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:34:24.558247 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m04:34:24.558642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m04:34:24.558839 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:34:24.561066 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:34:24.561967 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 04:34:24.558990 => 04:34:24.561871
[0m04:34:24.562165 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:34:24.563373 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:34:24.564032 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:34:24.564219 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m04:34:24.564427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:25.670226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:25.674102 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 04:34:24.562269 => 04:34:25.673740
[0m04:34:25.674725 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m04:34:26.470871 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 1.91s]
[0m04:34:26.472710 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:34:26.473522 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:34:26.474229 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m04:34:26.475413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m04:34:26.476167 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:34:26.484830 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:34:26.486864 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 04:34:26.476706 => 04:34:26.486485
[0m04:34:26.487273 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:34:26.489756 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:34:26.491276 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:34:26.491662 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m04:34:26.492022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:26.911524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:26.915486 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 04:34:26.487493 => 04:34:26.915179
[0m04:34:26.916117 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m04:34:27.066654 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.59s]
[0m04:34:27.068354 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:34:27.069004 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:34:27.069417 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m04:34:27.070430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m04:34:27.070871 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:34:27.077084 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:34:27.078959 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 04:34:27.071139 => 04:34:27.078669
[0m04:34:27.079387 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:34:27.082038 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:34:27.083323 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:34:27.083669 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m04:34:27.083985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:27.524827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:27.528951 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 04:34:27.079649 => 04:34:27.528616
[0m04:34:27.529556 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m04:34:27.655855 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.59s]
[0m04:34:27.657653 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:34:27.658339 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:34:27.658878 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m04:34:27.659968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m04:34:27.660450 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:34:27.666774 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:34:27.668959 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 04:34:27.660795 => 04:34:27.668518
[0m04:34:27.669540 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:34:27.672734 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:34:27.674348 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:34:27.674780 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m04:34:27.675110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:28.118945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:28.122839 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 04:34:27.669969 => 04:34:28.122440
[0m04:34:28.123636 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m04:34:28.253665 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.59s]
[0m04:34:28.255163 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:34:28.255771 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:34:28.256225 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m04:34:28.257210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m04:34:28.257667 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:34:28.263220 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:34:28.265286 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 04:34:28.257960 => 04:34:28.265011
[0m04:34:28.265759 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:34:28.268622 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:34:28.269993 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:34:28.270350 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m04:34:28.270699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:28.749916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:28.755638 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 04:34:28.266048 => 04:34:28.755266
[0m04:34:28.756179 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m04:34:28.882147 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.63s]
[0m04:34:28.882853 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:34:28.883132 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:34:28.883368 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m04:34:28.883861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m04:34:28.884121 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:34:28.886776 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:34:28.887664 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 04:34:28.884278 => 04:34:28.887532
[0m04:34:28.887870 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:34:28.889219 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:34:28.890113 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:34:28.890303 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m04:34:28.890479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:29.409036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:29.413338 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 04:34:28.888007 => 04:34:29.412988
[0m04:34:29.414002 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m04:34:29.578140 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.69s]
[0m04:34:29.579938 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:34:29.580538 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:34:29.581124 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m04:34:29.582378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m04:34:29.582909 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:34:29.590692 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:34:29.592841 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 04:34:29.583213 => 04:34:29.592445
[0m04:34:29.593352 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:34:29.596292 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:34:29.597725 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:34:29.598134 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m04:34:29.598545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:30.380494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:30.384437 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 04:34:29.593663 => 04:34:30.384087
[0m04:34:30.385084 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m04:34:30.522134 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.94s]
[0m04:34:30.523238 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:34:30.523641 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:34:30.524037 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m04:34:30.524829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m04:34:30.525147 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:34:30.528856 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:34:30.530026 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 04:34:30.525345 => 04:34:30.529884
[0m04:34:30.530298 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:34:30.532075 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:34:30.532967 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:34:30.533203 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m04:34:30.533415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:31.025572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:31.029259 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 04:34:30.530478 => 04:34:31.028949
[0m04:34:31.029870 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m04:34:31.155875 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.63s]
[0m04:34:31.157370 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:34:31.159979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:31.160520 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m04:34:31.160965 [info ] [MainThread]: 
[0m04:34:31.161674 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m04:34:31.163828 [debug] [MainThread]: Command end result
[0m04:34:31.176478 [info ] [MainThread]: 
[0m04:34:31.177165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:31.177456 [info ] [MainThread]: 
[0m04:34:31.177897 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:34:31.178919 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.436143, "process_user_time": 2.80875, "process_kernel_time": 0.133035, "process_mem_max_rss": "217236", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m04:34:31.179351 [debug] [MainThread]: Command `dbt test` succeeded at 04:34:31.179261 after 11.44 seconds
[0m04:34:31.179694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1bcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8f5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6705bf50>]}
[0m04:34:31.180018 [debug] [MainThread]: Flushing usage events
[0m04:34:37.993181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fc5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fc58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fc4650>]}


============================== 04:34:37.995800 | 057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7 ==============================
[0m04:34:37.995800 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:34:37.996185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:34:38.326631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bdd6d20>]}
[0m04:34:38.373575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70187680>]}
[0m04:34:38.373972 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:34:38.377064 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:34:38.400771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:34:38.400930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:34:38.403078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bcef4a0>]}
[0m04:34:38.408183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc4caa0>]}
[0m04:34:38.408370 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:34:38.408694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ba853a0>]}
[0m04:34:38.409424 [info ] [MainThread]: 
[0m04:34:38.409805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:38.410306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:34:38.415178 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:34:38.415335 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:34:38.415488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:39.020195 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:34:39.021787 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:34:39.144663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m04:34:39.151030 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:34:39.151369 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:34:39.151748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:39.640650 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:34:39.642691 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:34:39.770494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:34:39.774885 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:34:39.775454 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:34:39.776404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:40.109781 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:34:40.112878 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:34:40.244971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:34:40.249159 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:34:40.249654 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:34:40.250018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:40.711781 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:40.715033 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:34:41.327701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd1d60>]}
[0m04:34:41.329313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:41.330649 [info ] [MainThread]: 
[0m04:34:41.341500 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:34:41.342306 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m04:34:41.345402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m04:34:41.345844 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:34:41.352443 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 04:34:41.346109 => 04:34:41.352237
[0m04:34:41.352791 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:34:41.385036 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:41.385323 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m04:34:41.385565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:41.944052 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:34:41.956013 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:41.956971 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:34:42.066545 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:42.076495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:42.077102 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:34:42.186979 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:42.217110 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:42.217767 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:34:43.704792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:43.709492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:43.710104 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:34:43.835160 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:34:43.841135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:43.842190 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:34:43.965379 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:43.971144 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:43.971997 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:34:44.059973 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:34:44.066210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:44.066741 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:34:44.174941 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:34:44.184850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:44.185536 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:34:44.295186 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:34:44.305704 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:44.309150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:44.309899 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m04:34:44.478419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:34:44.479561 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:44.480052 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:34:45.316249 [debug] [Thread-1 (]: SQL status: SUCCESS 188 in 1.0 seconds
[0m04:34:45.317767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:34:45.318445 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m04:34:45.950755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:34:45.973170 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 04:34:41.353001 => 04:34:45.972938
[0m04:34:45.973683 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m04:34:46.122515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '057ef59a-d8a8-4ba7-aaaf-3c14bd0ecfd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939a0da0>]}
[0m04:34:46.124076 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 188[0m in 4.78s]
[0m04:34:46.126125 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:34:46.128937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:46.129344 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m04:34:46.129707 [info ] [MainThread]: 
[0m04:34:46.130448 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m04:34:46.131332 [debug] [MainThread]: Command end result
[0m04:34:46.146185 [info ] [MainThread]: 
[0m04:34:46.147134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:46.147421 [info ] [MainThread]: 
[0m04:34:46.147822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:34:46.148856 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.175008, "process_user_time": 2.591797, "process_kernel_time": 0.083314, "process_mem_max_rss": "217612", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m04:34:46.149307 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:34:46.149178 after 8.18 seconds
[0m04:34:46.149709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9127f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bd1f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912ba1e0>]}
[0m04:34:46.150033 [debug] [MainThread]: Flushing usage events
[0m04:44:04.523263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b98770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d7c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ca2e40>]}


============================== 04:44:04.526309 | 61ed4431-31dd-4e0c-925a-dbafc66cf037 ==============================
[0m04:44:04.526309 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:44:04.526741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:44:04.870468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f6b3a70>]}
[0m04:44:04.916798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e4f1a0>]}
[0m04:44:04.917094 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:44:04.920262 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:44:04.950011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:44:04.950181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:44:04.952387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e924710>]}
[0m04:44:04.958081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e863da0>]}
[0m04:44:04.958264 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:44:04.958552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ebff920>]}
[0m04:44:04.959342 [info ] [MainThread]: 
[0m04:44:04.959733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:04.960335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:44:04.965305 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:44:04.965459 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:44:04.965596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:05.571534 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:44:05.574161 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:44:05.718003 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:44:05.718789 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:44:05.719305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:06.385545 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:44:06.388246 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:44:06.538892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m04:44:06.549300 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:44:06.549876 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:44:06.550264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.008611 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:44:07.010489 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:44:07.147955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m04:44:07.151889 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:44:07.152401 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:44:07.155513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:07.603980 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:07.607017 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:44:07.785542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m04:44:07.791310 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:44:07.791951 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:44:07.792400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:08.236980 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:44:08.239897 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:44:08.366550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e519b50>]}
[0m04:44:08.367242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:08.367599 [info ] [MainThread]: 
[0m04:44:08.374544 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m04:44:08.374966 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m04:44:08.375626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m04:44:08.375936 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m04:44:08.380495 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m04:44:08.381779 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 04:44:08.376124 => 04:44:08.381654
[0m04:44:08.382009 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m04:44:08.396264 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m04:44:08.397131 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m04:44:08.397362 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m04:44:08.397560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:08.994788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:09.018586 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 04:44:08.382163 => 04:44:09.018176
[0m04:44:09.019537 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m04:44:09.226264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e516210>]}
[0m04:44:09.227514 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.85s]
[0m04:44:09.228995 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m04:44:09.230774 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m04:44:09.231446 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m04:44:09.232648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m04:44:09.233113 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m04:44:09.237143 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m04:44:09.239276 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 04:44:09.233407 => 04:44:09.238923
[0m04:44:09.239777 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m04:44:09.257219 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m04:44:09.258665 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m04:44:09.258947 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m04:44:09.259232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:11.506107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:44:11.510884 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 04:44:09.240070 => 04:44:11.510622
[0m04:44:11.511471 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m04:44:11.738449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5ace30>]}
[0m04:44:11.739728 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.51s]
[0m04:44:11.741152 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m04:44:11.741816 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m04:44:11.742427 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m04:44:11.743616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m04:44:11.744182 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m04:44:11.748920 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m04:44:11.750709 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 04:44:11.744556 => 04:44:11.750492
[0m04:44:11.751050 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m04:44:11.754339 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m04:44:11.756924 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m04:44:11.757404 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m04:44:11.757835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:13.039363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:13.042609 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 04:44:11.751261 => 04:44:13.042378
[0m04:44:13.043050 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m04:44:13.187880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6db43a40>]}
[0m04:44:13.188436 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.44s]
[0m04:44:13.189166 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m04:44:13.189557 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m04:44:13.189856 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m04:44:13.190389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m04:44:13.190719 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m04:44:13.193215 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:44:13.194828 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 04:44:13.191056 => 04:44:13.194701
[0m04:44:13.195053 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m04:44:13.196554 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:44:13.197488 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m04:44:13.197746 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m04:44:13.198029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:14.577436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:14.581560 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 04:44:13.195223 => 04:44:14.581309
[0m04:44:14.582171 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m04:44:14.720140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ed4431-31dd-4e0c-925a-dbafc66cf037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6db4b4d0>]}
[0m04:44:14.720894 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.53s]
[0m04:44:14.721976 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m04:44:14.724057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:14.724428 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m04:44:14.724785 [info ] [MainThread]: 
[0m04:44:14.725391 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.77 seconds (9.77s).
[0m04:44:14.726459 [debug] [MainThread]: Command end result
[0m04:44:14.735675 [info ] [MainThread]: 
[0m04:44:14.736081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:44:14.736332 [info ] [MainThread]: 
[0m04:44:14.736603 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:44:14.737424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.236174, "process_user_time": 2.741291, "process_kernel_time": 0.15852, "process_mem_max_rss": "216984", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m04:44:14.737778 [debug] [MainThread]: Command `dbt run` succeeded at 04:44:14.737704 after 10.24 seconds
[0m04:44:14.738029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9412f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96897620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6db0bd70>]}
[0m04:44:14.738293 [debug] [MainThread]: Flushing usage events
[0m04:44:17.525295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08a4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f66930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b99ac0>]}


============================== 04:44:17.528235 | 171462e6-08ae-426b-b539-1f1a8598a8df ==============================
[0m04:44:17.528235 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:44:17.528706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:44:17.877404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8062a2a0>]}
[0m04:44:17.923742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8062a2a0>]}
[0m04:44:17.924050 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:44:17.927081 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:44:17.951162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:44:17.951327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:44:17.953436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4d5d90>]}
[0m04:44:17.958653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5c8770>]}
[0m04:44:17.958818 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:44:17.959072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5eb860>]}
[0m04:44:17.959921 [info ] [MainThread]: 
[0m04:44:17.960297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:17.960878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m04:44:17.966302 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:44:17.966495 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:44:17.966668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:18.455684 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:44:18.458580 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:44:18.598784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m04:44:18.603290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:44:18.603837 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:44:18.604309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:19.199783 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:44:19.202517 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:44:19.363727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m04:44:19.367731 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:44:19.368278 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:44:19.369149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:19.857033 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:19.860780 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:44:20.010839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171462e6-08ae-426b-b539-1f1a8598a8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9cba10>]}
[0m04:44:20.012260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:20.013367 [info ] [MainThread]: 
[0m04:44:20.024295 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:44:20.024969 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m04:44:20.026496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m04:44:20.026910 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:44:20.041316 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:44:20.043458 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 04:44:20.027180 => 04:44:20.043307
[0m04:44:20.043728 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:44:20.055634 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:44:20.056898 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:44:20.057172 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m04:44:20.057406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:20.505390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:20.514131 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 04:44:20.043908 => 04:44:20.513806
[0m04:44:20.514792 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m04:44:20.697545 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.67s]
[0m04:44:20.699294 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:44:20.699959 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:44:20.700505 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m04:44:20.701644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m04:44:20.702130 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:44:20.709188 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:44:20.711065 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 04:44:20.702471 => 04:44:20.710648
[0m04:44:20.711882 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:44:20.715069 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:44:20.716786 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:44:20.717187 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m04:44:20.717583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:21.438057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:21.441988 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 04:44:20.712241 => 04:44:21.441676
[0m04:44:21.442625 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m04:44:21.624804 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.92s]
[0m04:44:21.625498 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:44:21.625818 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:44:21.626090 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m04:44:21.626617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m04:44:21.626899 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:44:21.631143 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:44:21.632016 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 04:44:21.627052 => 04:44:21.631899
[0m04:44:21.632298 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:44:21.633853 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:44:21.634543 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:44:21.634744 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m04:44:21.634910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:22.300983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:22.304720 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 04:44:21.632480 => 04:44:22.304350
[0m04:44:22.305434 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m04:44:23.072388 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 1.45s]
[0m04:44:23.073437 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:44:23.074083 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:44:23.074605 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m04:44:23.075685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m04:44:23.076182 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:44:23.082076 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:44:23.083874 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 04:44:23.076498 => 04:44:23.083644
[0m04:44:23.084252 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:44:23.087247 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:44:23.089089 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:44:23.089613 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m04:44:23.090064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:23.513616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:23.516817 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 04:44:23.084491 => 04:44:23.516509
[0m04:44:23.517469 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m04:44:23.676189 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.60s]
[0m04:44:23.677676 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:44:23.678330 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:44:23.678876 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m04:44:23.680277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m04:44:23.680855 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:44:23.688702 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:44:23.690399 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 04:44:23.681223 => 04:44:23.690192
[0m04:44:23.691078 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:44:23.694572 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:44:23.696345 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:44:23.696741 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m04:44:23.697090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:24.214085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:24.217452 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 04:44:23.691615 => 04:44:24.217143
[0m04:44:24.218091 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m04:44:24.360610 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.68s]
[0m04:44:24.362182 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:44:24.362907 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:44:24.363540 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m04:44:24.364765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m04:44:24.365266 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:44:24.371246 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:44:24.373073 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 04:44:24.365728 => 04:44:24.372826
[0m04:44:24.373442 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:44:24.376783 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:44:24.378435 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:44:24.378866 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m04:44:24.379291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:24.851907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:24.855427 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 04:44:24.373697 => 04:44:24.855117
[0m04:44:24.855991 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m04:44:25.009663 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.64s]
[0m04:44:25.011221 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:44:25.011871 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:44:25.012445 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m04:44:25.013731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m04:44:25.014286 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:44:25.020347 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:44:25.022262 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 04:44:25.014636 => 04:44:25.022024
[0m04:44:25.022667 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:44:25.025851 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:44:25.027637 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:44:25.028052 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m04:44:25.028418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:25.504409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:25.508187 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 04:44:25.022957 => 04:44:25.507880
[0m04:44:25.508736 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m04:44:25.675178 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.66s]
[0m04:44:25.676690 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:44:25.677310 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:44:25.677809 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m04:44:25.678930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m04:44:25.679610 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:44:25.685506 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:44:25.687314 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 04:44:25.680028 => 04:44:25.687081
[0m04:44:25.687741 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:44:25.691111 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:44:25.692910 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:44:25.693353 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m04:44:25.693733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:26.784108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:26.787805 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 04:44:25.688041 => 04:44:26.787471
[0m04:44:26.788557 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m04:44:26.934156 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 1.26s]
[0m04:44:26.935685 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:44:26.936348 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:44:26.936905 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m04:44:26.938176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m04:44:26.938785 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:44:26.944733 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:44:26.946650 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 04:44:26.939164 => 04:44:26.946403
[0m04:44:26.947079 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:44:26.950347 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:44:26.952428 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:44:26.952883 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m04:44:26.953346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:27.333614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:27.337175 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 04:44:26.947331 => 04:44:27.336848
[0m04:44:27.337801 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m04:44:27.789055 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.85s]
[0m04:44:27.790598 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:44:27.791221 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:44:27.791716 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m04:44:27.792806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m04:44:27.793305 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:44:27.801760 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:44:27.803798 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 04:44:27.793623 => 04:44:27.803457
[0m04:44:27.804392 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:44:27.807488 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:44:27.808858 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:44:27.809227 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m04:44:27.809574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:28.196855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:28.200771 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 04:44:27.804756 => 04:44:28.200472
[0m04:44:28.201499 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m04:44:28.340733 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.55s]
[0m04:44:28.342247 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:44:28.342892 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:44:28.343439 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m04:44:28.344638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m04:44:28.345188 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:44:28.351444 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:44:28.353198 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 04:44:28.345538 => 04:44:28.352985
[0m04:44:28.353607 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:44:28.356856 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:44:28.358808 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:44:28.359211 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m04:44:28.359567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:28.753405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:28.757324 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 04:44:28.353913 => 04:44:28.756986
[0m04:44:28.757891 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m04:44:28.916934 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.57s]
[0m04:44:28.918188 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:44:28.920053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:28.920347 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m04:44:28.920627 [info ] [MainThread]: 
[0m04:44:28.921103 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 10.96 seconds (10.96s).
[0m04:44:28.922623 [debug] [MainThread]: Command end result
[0m04:44:28.931342 [info ] [MainThread]: 
[0m04:44:28.931723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:44:28.931963 [info ] [MainThread]: 
[0m04:44:28.932231 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:44:28.932892 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.427917, "process_user_time": 2.959053, "process_kernel_time": 0.121289, "process_mem_max_rss": "217732", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m04:44:28.933288 [debug] [MainThread]: Command `dbt test` succeeded at 04:44:28.933216 after 11.43 seconds
[0m04:44:28.933548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f66930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a35c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5695e0>]}
[0m04:44:28.933797 [debug] [MainThread]: Flushing usage events
[0m04:44:33.506420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe5a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df30770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e82ca70>]}


============================== 04:44:33.509067 | d7cd4741-f5c9-42c4-a436-e6863c58eae8 ==============================
[0m04:44:33.509067 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:44:33.509333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:44:33.845283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd92a50>]}
[0m04:44:33.890657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8836fa70>]}
[0m04:44:33.890988 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:44:33.893841 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:44:33.916988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:44:33.917147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:44:33.919254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb2a810>]}
[0m04:44:33.925417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca6d220>]}
[0m04:44:33.925591 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:44:33.925751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbe6db0>]}
[0m04:44:33.926500 [info ] [MainThread]: 
[0m04:44:33.926848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:33.927350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:44:33.932164 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:44:33.932363 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:44:33.932508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:34.433899 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:44:34.436709 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:44:34.596299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m04:44:34.606595 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:44:34.607209 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:44:34.607659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:35.039727 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:44:35.040703 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:44:35.172594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m04:44:35.173786 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:44:35.173956 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:44:35.174240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:35.649771 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:35.650755 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:44:36.070244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m04:44:36.071914 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:44:36.072119 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:44:36.072280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:36.521552 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:44:36.523209 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:44:36.665778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954ffce0>]}
[0m04:44:36.667147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:36.668307 [info ] [MainThread]: 
[0m04:44:36.679478 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:44:36.680191 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m04:44:36.681367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m04:44:36.681797 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:44:36.689067 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 04:44:36.682135 => 04:44:36.688822
[0m04:44:36.689501 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:44:36.722688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:36.722930 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m04:44:36.723143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:37.159368 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m04:44:37.170361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:37.170977 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:44:37.271497 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:37.280067 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:37.280559 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:44:37.416325 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:37.442173 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:37.442609 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:44:38.597677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:38.602644 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:38.603311 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:44:38.692624 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:44:38.696980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:38.697402 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:44:38.802438 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:38.807248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:38.807718 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:44:38.898262 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:44:38.906923 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:38.907764 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:44:39.010655 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:44:39.020256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:39.020900 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:44:39.115086 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:44:39.120661 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:39.122778 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:39.123065 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m04:44:39.767574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:39.768756 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:39.769370 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:44:40.484933 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:44:40.486169 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:44:40.486717 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m04:44:40.782781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:44:40.806799 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 04:44:36.689728 => 04:44:40.806603
[0m04:44:40.807251 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m04:44:40.986196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7cd4741-f5c9-42c4-a436-e6863c58eae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5e8260>]}
[0m04:44:40.987889 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 4.30s]
[0m04:44:40.989498 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:44:40.992230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:40.992777 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m04:44:40.993250 [info ] [MainThread]: 
[0m04:44:40.993993 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m04:44:40.994898 [debug] [MainThread]: Command end result
[0m04:44:41.006782 [info ] [MainThread]: 
[0m04:44:41.007714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:44:41.008147 [info ] [MainThread]: 
[0m04:44:41.008530 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:44:41.009392 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.522645, "process_user_time": 2.541121, "process_kernel_time": 0.094078, "process_mem_max_rss": "217904", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m04:44:41.009800 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:44:41.009711 after 7.52 seconds
[0m04:44:41.010125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df7d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd31b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb2a420>]}
[0m04:44:41.010436 [debug] [MainThread]: Flushing usage events
[0m04:45:38.146645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff9caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff9d130>]}


============================== 04:45:38.149745 | 07952b9c-dda1-4b4b-ab1c-b4e343d47ebf ==============================
[0m04:45:38.149745 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:45:38.150197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:45:38.510898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b05f560>]}
[0m04:45:38.563746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aff1e80>]}
[0m04:45:38.564187 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:45:38.567773 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:45:38.599424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:45:38.599781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:45:38.602627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff9d4f0>]}
[0m04:45:38.610372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6acec980>]}
[0m04:45:38.611027 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:45:38.611996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6adc3050>]}
[0m04:45:38.613665 [info ] [MainThread]: 
[0m04:45:38.614629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:45:38.616291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:45:38.627147 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:45:38.627531 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:45:38.627783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:39.311979 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:45:39.312951 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:45:39.516597 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:45:39.516908 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:45:39.517100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:40.113181 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:45:40.114109 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:45:40.290819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m04:45:40.294294 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:45:40.294493 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:45:40.294631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:40.841519 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:45:40.844913 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:45:41.065410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m04:45:41.072116 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:45:41.072614 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:45:41.073062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:41.536514 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:45:41.539210 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:45:41.744977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m04:45:41.749259 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:45:41.749910 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:45:41.750416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:42.233914 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:45:42.236020 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:45:42.746719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ac289e0>]}
[0m04:45:42.748105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:45:42.749428 [info ] [MainThread]: 
[0m04:45:42.760636 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m04:45:42.761370 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m04:45:42.762583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m04:45:42.763054 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m04:45:42.770311 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m04:45:42.772349 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 04:45:42.763347 => 04:45:42.772178
[0m04:45:42.772664 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m04:45:42.790805 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m04:45:42.791687 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m04:45:42.791940 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m04:45:42.792155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:43.394474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:43.418895 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 04:45:42.772893 => 04:45:43.418689
[0m04:45:43.419299 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m04:45:44.264055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a97f980>]}
[0m04:45:44.265268 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 1.50s]
[0m04:45:44.266761 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m04:45:44.268044 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m04:45:44.268539 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m04:45:44.269966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m04:45:44.270694 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m04:45:44.273873 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m04:45:44.275138 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 04:45:44.271045 => 04:45:44.274951
[0m04:45:44.275485 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m04:45:44.291407 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m04:45:44.292535 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m04:45:44.292810 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m04:45:44.293054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:46.021240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:45:46.025637 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 04:45:44.275724 => 04:45:46.025346
[0m04:45:46.026297 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m04:45:46.841988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69f1d640>]}
[0m04:45:46.843324 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 2.57s]
[0m04:45:46.844170 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m04:45:46.844779 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m04:45:46.845358 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m04:45:46.846440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m04:45:46.846929 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m04:45:46.851537 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m04:45:46.853380 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 04:45:46.847245 => 04:45:46.853155
[0m04:45:46.853781 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m04:45:46.856995 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m04:45:46.859512 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m04:45:46.860119 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m04:45:46.860632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:48.274954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:48.279262 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 04:45:46.854041 => 04:45:48.279023
[0m04:45:48.279866 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m04:45:48.478904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a968710>]}
[0m04:45:48.480118 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.63s]
[0m04:45:48.481510 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m04:45:48.482143 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m04:45:48.482799 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m04:45:48.484170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m04:45:48.484677 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m04:45:48.490728 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:45:48.493414 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 04:45:48.485032 => 04:45:48.493036
[0m04:45:48.494236 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m04:45:48.497559 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m04:45:48.499383 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m04:45:48.499789 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m04:45:48.500146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:49.811875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:49.816151 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 04:45:48.494667 => 04:45:49.815894
[0m04:45:49.816972 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m04:45:50.035185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07952b9c-dda1-4b4b-ab1c-b4e343d47ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9b9520>]}
[0m04:45:50.036444 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.55s]
[0m04:45:50.037892 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m04:45:50.040238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:45:50.040708 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m04:45:50.041290 [info ] [MainThread]: 
[0m04:45:50.042074 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 11.43 seconds (11.43s).
[0m04:45:50.043336 [debug] [MainThread]: Command end result
[0m04:45:50.055683 [info ] [MainThread]: 
[0m04:45:50.056406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:45:50.056727 [info ] [MainThread]: 
[0m04:45:50.057129 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:45:50.058052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.934202, "process_user_time": 2.61009, "process_kernel_time": 0.160047, "process_mem_max_rss": "216996", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m04:45:50.058485 [debug] [MainThread]: Command `dbt run` succeeded at 04:45:50.058395 after 11.93 seconds
[0m04:45:50.058860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69f2aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a949130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a949b50>]}
[0m04:45:50.059227 [debug] [MainThread]: Flushing usage events
[0m04:45:53.589648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae99dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af9dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b524bf0>]}


============================== 04:45:53.592316 | fba92e81-92c7-43e4-ac34-323b3658b347 ==============================
[0m04:45:53.592316 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:45:53.592727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m04:45:53.947181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a43f560>]}
[0m04:45:53.992270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0116a80>]}
[0m04:45:53.992612 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:45:53.995627 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:45:54.019418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:45:54.019601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:45:54.021782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c347d0>]}
[0m04:45:54.026943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b6d610>]}
[0m04:45:54.027139 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:45:54.027428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff029c0>]}
[0m04:45:54.028293 [info ] [MainThread]: 
[0m04:45:54.028677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:45:54.029255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics'
[0m04:45:54.034681 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:45:54.034873 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:45:54.035064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:54.578125 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m04:45:54.581170 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:45:54.706895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m04:45:54.712631 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:45:54.713192 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:45:54.713633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:55.121072 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:45:55.123714 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:45:55.516514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:45:55.520740 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:45:55.521268 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:45:55.522224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:56.106538 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m04:45:56.109529 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:45:56.229804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba92e81-92c7-43e4-ac34-323b3658b347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b6da90>]}
[0m04:45:56.231159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:45:56.232288 [info ] [MainThread]: 
[0m04:45:56.243196 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:45:56.243885 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m04:45:56.245082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m04:45:56.245538 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:45:56.260878 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:45:56.262814 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 04:45:56.245874 => 04:45:56.262651
[0m04:45:56.263099 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:45:56.275207 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:45:56.276360 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m04:45:56.276639 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m04:45:56.276856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:56.872733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:56.877793 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 04:45:56.263281 => 04:45:56.877590
[0m04:45:56.878185 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m04:45:57.061214 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.82s]
[0m04:45:57.062797 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m04:45:57.063493 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:45:57.064075 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m04:45:57.065187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m04:45:57.065738 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:45:57.073028 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:45:57.075267 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 04:45:57.066143 => 04:45:57.074878
[0m04:45:57.075920 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:45:57.079210 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:45:57.080964 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m04:45:57.081365 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m04:45:57.081767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:57.589778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:57.593536 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 04:45:57.076328 => 04:45:57.593190
[0m04:45:57.594169 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m04:45:57.739696 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.67s]
[0m04:45:57.740712 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m04:45:57.741315 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:45:57.741782 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m04:45:57.742737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m04:45:57.743211 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:45:57.749538 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:45:57.750913 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 04:45:57.743483 => 04:45:57.750675
[0m04:45:57.751274 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:45:57.753287 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:45:57.754315 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m04:45:57.754625 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m04:45:57.754942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:58.824503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:45:58.828110 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 04:45:57.751475 => 04:45:58.827774
[0m04:45:58.828730 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m04:45:58.979749 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 1.24s]
[0m04:45:58.981347 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m04:45:58.982109 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:45:58.982735 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m04:45:58.984044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m04:45:58.984630 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:45:58.990322 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:45:58.992122 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 04:45:58.984955 => 04:45:58.991881
[0m04:45:58.992511 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:45:58.995731 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:45:58.997580 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m04:45:58.998035 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m04:45:58.998432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:00.358195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:00.362412 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 04:45:58.992779 => 04:46:00.362082
[0m04:46:00.363093 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m04:46:00.533491 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 1.55s]
[0m04:46:00.535311 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m04:46:00.536013 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:46:00.536590 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m04:46:00.537845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m04:46:00.538328 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:46:00.544461 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:46:00.546293 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 04:46:00.538682 => 04:46:00.546072
[0m04:46:00.546683 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:46:00.551953 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:46:00.553802 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m04:46:00.554198 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m04:46:00.554526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:01.612438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:01.616525 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 04:46:00.546905 => 04:46:01.616070
[0m04:46:01.617399 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m04:46:01.871069 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 1.33s]
[0m04:46:01.872657 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m04:46:01.873232 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:46:01.873740 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m04:46:01.875115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m04:46:01.875720 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:46:01.881419 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:46:01.882904 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 04:46:01.876033 => 04:46:01.882640
[0m04:46:01.883313 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:46:01.885828 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:46:01.887026 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m04:46:01.887359 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m04:46:01.887739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:02.416473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:02.420403 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 04:46:01.883569 => 04:46:02.420092
[0m04:46:02.421054 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m04:46:02.611968 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.74s]
[0m04:46:02.612498 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m04:46:02.612727 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:46:02.612913 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m04:46:02.613291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m04:46:02.613459 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:46:02.615492 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:46:02.616186 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 04:46:02.613562 => 04:46:02.616091
[0m04:46:02.616387 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:46:02.617749 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:46:02.618438 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m04:46:02.618629 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m04:46:02.618813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:03.065204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:03.068133 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 04:46:02.616542 => 04:46:03.067824
[0m04:46:03.068736 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m04:46:03.193193 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.58s]
[0m04:46:03.194368 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m04:46:03.195045 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:46:03.195533 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m04:46:03.196780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m04:46:03.197419 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:46:03.203565 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:46:03.205136 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 04:46:03.197789 => 04:46:03.204903
[0m04:46:03.205506 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:46:03.208625 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:46:03.210423 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m04:46:03.210971 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m04:46:03.211405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:03.722611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:46:03.723834 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 04:46:03.205734 => 04:46:03.723727
[0m04:46:03.724009 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m04:46:03.900830 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.70s]
[0m04:46:03.901453 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m04:46:03.901767 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:46:03.902000 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m04:46:03.902526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m04:46:03.902804 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:46:03.905201 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:46:03.905971 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 04:46:03.902957 => 04:46:03.905867
[0m04:46:03.906175 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:46:03.907425 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:46:03.908373 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m04:46:03.908607 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m04:46:03.908832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:04.373057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:04.376914 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 04:46:03.906304 => 04:46:04.376603
[0m04:46:04.377607 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m04:46:04.506996 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.60s]
[0m04:46:04.508204 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m04:46:04.508898 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:46:04.509427 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m04:46:04.510652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m04:46:04.511168 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:46:04.517172 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:46:04.518980 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 04:46:04.511483 => 04:46:04.518680
[0m04:46:04.519576 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:46:04.524668 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:46:04.526099 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m04:46:04.526463 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m04:46:04.526832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:04.981369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:04.984587 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 04:46:04.519877 => 04:46:04.984261
[0m04:46:04.985173 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m04:46:05.479361 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.97s]
[0m04:46:05.480933 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m04:46:05.481580 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:46:05.482123 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m04:46:05.483421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m04:46:05.484102 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:46:05.490405 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:46:05.492286 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 04:46:05.484657 => 04:46:05.492040
[0m04:46:05.492686 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:46:05.495815 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:46:05.497396 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m04:46:05.497809 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m04:46:05.498183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:05.888778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:05.890311 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 04:46:05.493025 => 04:46:05.890151
[0m04:46:05.890588 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m04:46:06.007052 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.52s]
[0m04:46:06.008160 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m04:46:06.010429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:06.010817 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m04:46:06.011178 [info ] [MainThread]: 
[0m04:46:06.011856 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 11.98 seconds (11.98s).
[0m04:46:06.013474 [debug] [MainThread]: Command end result
[0m04:46:06.022478 [info ] [MainThread]: 
[0m04:46:06.022909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:06.023124 [info ] [MainThread]: 
[0m04:46:06.023395 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m04:46:06.024045 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.454785, "process_user_time": 2.892564, "process_kernel_time": 0.116143, "process_mem_max_rss": "217364", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m04:46:06.024409 [debug] [MainThread]: Command `dbt test` succeeded at 04:46:06.024328 after 12.46 seconds
[0m04:46:06.024693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9aeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3b9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1ca9c0>]}
[0m04:46:06.024960 [debug] [MainThread]: Flushing usage events
[0m04:46:12.724217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813cf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a5b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813ce2d0>]}


============================== 04:46:12.726908 | 97a5dd72-5ea6-40ac-a17f-a68f7417dbd1 ==============================
[0m04:46:12.726908 [info ] [MainThread]: Running with dbt=1.7.0
[0m04:46:12.727374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:46:13.058950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603d24b0>]}
[0m04:46:13.105126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813cee40>]}
[0m04:46:13.105421 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m04:46:13.108452 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m04:46:13.132322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:13.132497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:13.134725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff601384d0>]}
[0m04:46:13.139623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bf91220>]}
[0m04:46:13.139823 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m04:46:13.140132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60259790>]}
[0m04:46:13.140834 [info ] [MainThread]: 
[0m04:46:13.141255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:46:13.141752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m04:46:13.146645 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m04:46:13.146817 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m04:46:13.146950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:13.663720 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m04:46:13.666700 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m04:46:13.822260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m04:46:13.832733 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m04:46:13.833388 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m04:46:13.834913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:14.242289 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:46:14.245640 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m04:46:14.543711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m04:46:14.549355 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m04:46:14.550024 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m04:46:14.550621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:15.080824 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:46:15.083671 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m04:46:15.230453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m04:46:15.234999 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m04:46:15.235629 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m04:46:15.236089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:15.706333 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:46:15.709394 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m04:46:15.852089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603d1af0>]}
[0m04:46:15.853390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:46:15.854503 [info ] [MainThread]: 
[0m04:46:15.865655 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:46:15.866309 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m04:46:15.867406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m04:46:15.867816 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:46:15.874191 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 04:46:15.868060 => 04:46:15.873997
[0m04:46:15.874528 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:46:15.905701 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:15.905985 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m04:46:15.906246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:17.048485 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:46:17.060363 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:17.061165 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:46:17.211735 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:46:17.221049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:17.221674 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:46:17.333138 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:46:17.362713 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:17.363267 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:46:19.010175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m04:46:19.015330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.016176 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:46:19.127093 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:46:19.129255 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.129487 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:46:19.241959 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:46:19.244859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.245170 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:46:19.334020 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:46:19.341692 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.342321 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m04:46:19.458195 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m04:46:19.468393 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.469027 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m04:46:19.584062 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m04:46:19.594777 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.598301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.598826 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m04:46:19.727824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:19.728836 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:19.729459 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:46:20.530168 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m04:46:20.531412 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m04:46:20.532130 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m04:46:20.939714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:46:20.960586 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 04:46:15.874764 => 04:46:20.960380
[0m04:46:20.960998 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m04:46:21.221393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97a5dd72-5ea6-40ac-a17f-a68f7417dbd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bde3080>]}
[0m04:46:21.222902 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 5.35s]
[0m04:46:21.224376 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m04:46:21.227128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:21.227657 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m04:46:21.228127 [info ] [MainThread]: 
[0m04:46:21.228763 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m04:46:21.229468 [debug] [MainThread]: Command end result
[0m04:46:21.242426 [info ] [MainThread]: 
[0m04:46:21.243181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:21.243571 [info ] [MainThread]: 
[0m04:46:21.243989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:46:21.244881 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.540926, "process_user_time": 2.649329, "process_kernel_time": 0.114316, "process_mem_max_rss": "217528", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m04:46:21.245309 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:46:21.245211 after 8.54 seconds
[0m04:46:21.245666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a5b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61bcb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840cb050>]}
[0m04:46:21.246005 [debug] [MainThread]: Flushing usage events
[0m05:10:15.096721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53dc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53df6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53dd910>]}
[0m05:10:15.096726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6256450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6163fb0>]}


============================== 05:10:15.099983 | 409a3cce-2e74-4500-b57e-f67458617a99 ==============================
[0m05:10:15.099983 [info ] [MainThread]: Running with dbt=1.7.0


============================== 05:10:15.100011 | 8c232de0-ca02-4040-b94c-9e4ad0fe528a ==============================
[0m05:10:15.100011 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:10:15.100288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:10:15.100358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:10:15.469745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f6d3a0>]}
[0m05:10:15.469745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945785f0>]}
[0m05:10:15.518593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852ae360>]}
[0m05:10:15.518986 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:10:15.519213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56b8380>]}
[0m05:10:15.519590 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:10:15.522191 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:10:15.522818 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:10:15.553615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:10:15.553625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:10:15.553828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:10:15.553875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:10:15.556162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2dffe30>]}
[0m05:10:15.556215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941cd670>]}
[0m05:10:15.562160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffc9d90>]}
[0m05:10:15.562461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d95e50>]}
[0m05:10:15.562474 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:10:15.562685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffc9940>]}
[0m05:10:15.562679 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:10:15.562910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855b4170>]}
[0m05:10:15.563533 [info ] [MainThread]: 
[0m05:10:15.563782 [info ] [MainThread]: 
[0m05:10:15.563903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:10:15.564149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:10:15.564487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:10:15.564732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:10:15.570135 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:10:15.570330 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:10:15.570501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:15.570705 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:10:15.570929 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:10:15.571124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:16.362266 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:10:16.364971 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:10:16.365006 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:10:16.367623 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:10:16.613563 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:10:16.614426 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:10:16.614952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:16.658874 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:10:16.659702 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:10:16.660262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:17.085566 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:10:17.089255 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:10:17.089799 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:10:17.092920 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:10:17.360864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m05:10:17.362429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:10:17.374093 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:10:17.374684 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:10:17.375117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:17.375219 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:10:17.375887 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:10:17.376426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:17.888216 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:10:17.891413 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:10:17.940834 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m05:10:17.944359 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:10:18.084488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m05:10:18.088208 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:10:18.088910 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:10:18.090217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:18.218970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:10:18.224121 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:10:18.224697 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:10:18.225030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:18.487672 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:10:18.489952 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:10:18.656839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:10:18.660639 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:10:18.661007 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:10:18.661330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:18.685348 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:10:18.686876 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:10:18.932069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:10:18.935237 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:10:18.935743 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:10:18.936033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:19.086360 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:10:19.088282 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:10:19.266055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cf2780>]}
[0m05:10:19.267488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:10:19.268097 [info ] [MainThread]: 
[0m05:10:19.279564 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:10:19.280596 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:10:19.281789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now model.energy_consumption_analytics.stg_eia)
[0m05:10:19.282281 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:10:19.289756 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.292486 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:10:19.282644 => 05:10:19.292273
[0m05:10:19.292835 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:10:19.311060 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.312370 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.312634 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:10:19.312899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:19.356494 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:10:19.357735 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:10:19.584839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe191c0>]}
[0m05:10:19.585664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:10:19.586062 [info ] [MainThread]: 
[0m05:10:19.593514 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:10:19.593939 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:10:19.594518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m05:10:19.594801 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:10:19.599737 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.600737 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:10:19.595010 => 05:10:19.600601
[0m05:10:19.600986 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:10:19.615405 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.616290 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:10:19.616556 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:10:19.616761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:19.810721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d716-0307-327f-000f-c0df00ade5aa
[0m05:10:19.811638 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
[0m05:10:19.812598 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:10:19.293059 => 05:10:19.812243
[0m05:10:19.813249 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:10:20.015351 [debug] [Thread-1 (]: Database Error in model stg_eia (models/input/stg_eia.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
  compiled Code at target/run/energy_consumption_analytics/models/input/stg_eia.sql
[0m05:10:20.016250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c232de0-ca02-4040-b94c-9e4ad0fe528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841d19a0>]}
[0m05:10:20.017048 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_staging.stg_eia ................. [[31mERROR[0m in 0.73s]
[0m05:10:20.017842 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:10:20.019849 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:10:20.020512 [info ] [Thread-1 (]: 2 of 4 SKIP relation analytics.moving_avg ...................................... [[33mSKIP[0m]
[0m05:10:20.021076 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:10:20.021574 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:10:20.022027 [info ] [Thread-1 (]: 3 of 4 SKIP relation analytics.region_comp ..................................... [[33mSKIP[0m]
[0m05:10:20.022516 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:10:20.022956 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:10:20.023406 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.weekday_weekend ................................. [[33mSKIP[0m]
[0m05:10:20.023916 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:10:20.025720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:20.026044 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.stg_eia' was properly closed.
[0m05:10:20.026428 [info ] [MainThread]: 
[0m05:10:20.026763 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m05:10:20.027442 [debug] [MainThread]: Command end result
[0m05:10:20.036464 [info ] [MainThread]: 
[0m05:10:20.036815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:10:20.037079 [info ] [MainThread]: 
[0m05:10:20.037337 [error] [MainThread]:   Database Error in model stg_eia (models/input/stg_eia.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
  compiled Code at target/run/energy_consumption_analytics/models/input/stg_eia.sql
[0m05:10:20.037584 [info ] [MainThread]: 
[0m05:10:20.037864 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m05:10:20.038640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9640884, "process_user_time": 2.229616, "process_kernel_time": 0.13418, "process_mem_max_rss": "218348", "process_out_blocks": "4520", "command_success": false, "process_in_blocks": "0"}
[0m05:10:20.038959 [debug] [MainThread]: Command `dbt run` failed at 05:10:20.038894 after 4.96 seconds
[0m05:10:20.039211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ec8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60cba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60a87d0>]}
[0m05:10:20.039446 [debug] [MainThread]: Flushing usage events
[0m05:10:20.082636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d716-0307-3356-000f-c0df00adbc4a
[0m05:10:20.083033 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
[0m05:10:20.083458 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:10:19.601140 => 05:10:20.083291
[0m05:10:20.083752 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:10:20.263861 [debug] [Thread-1 (]: Database Error in model stg_eia (models/input/stg_eia.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
  compiled Code at target/run/energy_consumption_analytics/models/input/stg_eia.sql
[0m05:10:20.265050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409a3cce-2e74-4500-b57e-f67458617a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f393230>]}
[0m05:10:20.266343 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_staging.stg_eia ................. [[31mERROR[0m in 0.67s]
[0m05:10:20.267233 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:10:20.269500 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:10:20.270029 [info ] [Thread-1 (]: 2 of 4 SKIP relation analytics.moving_avg ...................................... [[33mSKIP[0m]
[0m05:10:20.270555 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:10:20.271012 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:10:20.271476 [info ] [Thread-1 (]: 3 of 4 SKIP relation analytics.region_comp ..................................... [[33mSKIP[0m]
[0m05:10:20.271944 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:10:20.272416 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:10:20.272841 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.weekday_weekend ................................. [[33mSKIP[0m]
[0m05:10:20.273342 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:10:20.275096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:20.275418 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.stg_eia' was properly closed.
[0m05:10:20.275767 [info ] [MainThread]: 
[0m05:10:20.276100 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m05:10:20.276750 [debug] [MainThread]: Command end result
[0m05:10:20.285248 [info ] [MainThread]: 
[0m05:10:20.285627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:10:20.285904 [info ] [MainThread]: 
[0m05:10:20.286191 [error] [MainThread]:   Database Error in model stg_eia (models/input/stg_eia.sql)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_MONKEY.STAGING.RTO_REGION_HOURLY_STAGING' does not exist or not authorized.
  compiled Code at target/run/energy_consumption_analytics/models/input/stg_eia.sql
[0m05:10:20.286505 [info ] [MainThread]: 
[0m05:10:20.286811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m05:10:20.287599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.213027, "process_user_time": 2.213021, "process_kernel_time": 0.112868, "process_mem_max_rss": "217624", "process_out_blocks": "4504", "command_success": false, "process_in_blocks": "0"}
[0m05:10:20.287986 [debug] [MainThread]: Command `dbt run` failed at 05:10:20.287900 after 5.21 seconds
[0m05:10:20.288263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bbcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56be120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff5a810>]}
[0m05:10:20.288512 [debug] [MainThread]: Flushing usage events
[0m05:23:09.888436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839fd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839fd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839fe5a0>]}


============================== 05:23:09.891967 | df81d281-9ffa-465b-bedb-8f2a314432aa ==============================
[0m05:23:09.891967 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:09.889236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4fa0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5e29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6803e0>]}
[0m05:23:09.892502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 05:23:09.892579 | c2b46382-f6ad-47d1-9ddd-124a96396722 ==============================
[0m05:23:09.892579 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:09.892888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:23:10.342076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cc6a80>]}
[0m05:23:10.342076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a503b60>]}
[0m05:23:10.405059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a04c6b0>]}
[0m05:23:10.405547 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:10.406209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f050a40>]}
[0m05:23:10.406620 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:10.409116 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:10.410319 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:10.443952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:10.443994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:10.444209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:10.444261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:10.447127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791922a0>]}
[0m05:23:10.447161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a09ac0>]}
[0m05:23:10.453333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e671670>]}
[0m05:23:10.453718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79030bc0>]}
[0m05:23:10.453811 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:10.453999 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:10.454321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e670ce0>]}
[0m05:23:10.454404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d9a930>]}
[0m05:23:10.455369 [info ] [MainThread]: 
[0m05:23:10.455524 [info ] [MainThread]: 
[0m05:23:10.455943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:10.456047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:10.456674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:23:10.456803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:23:10.463892 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:10.464076 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:10.464265 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:10.464335 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:10.464435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:10.464500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:10.839470 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:10.840501 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:10.876925 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:10.878101 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:10.991680 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:10.992484 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:10.992947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:11.007315 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:11.007723 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:11.008074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:11.364629 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:11.367104 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:11.428833 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:11.430543 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:11.498611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m05:23:11.507629 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:11.508053 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:23:11.508324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:11.550932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:23:11.558283 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:11.558626 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:11.558906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:11.901678 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:11.902487 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:11.960634 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:11.961634 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:12.028354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m05:23:12.030206 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:12.030450 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:12.031624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:12.130948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:23:12.135545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:12.135922 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:12.136267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:12.463532 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:12.466523 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:12.497762 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:12.500609 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:12.638120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:23:12.643000 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:12.643957 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:23:12.644503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:12.971633 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:12.973352 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:13.114175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ebeab40>]}
[0m05:23:13.116074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:13.117821 [info ] [MainThread]: 
[0m05:23:13.131451 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:23:13.132265 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:23:13.133576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m05:23:13.133927 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:23:13.140392 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:23:13.142282 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:23:13.134147 => 05:23:13.142120
[0m05:23:13.142567 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:23:13.159456 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:23:13.160601 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:23:13.160825 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:23:13.161003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:13.430683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m05:23:13.435584 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:13.436197 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:13.436619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:13.768160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:13.783227 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:23:13.142757 => 05:23:13.783101
[0m05:23:13.783514 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:23:13.921577 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:13.924722 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:13.935299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e636480>]}
[0m05:23:13.936456 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.80s]
[0m05:23:13.937856 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:23:13.939285 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:23:13.939954 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m05:23:13.941054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m05:23:13.941469 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m05:23:13.944251 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m05:23:13.946798 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 05:23:13.941755 => 05:23:13.946602
[0m05:23:13.947128 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m05:23:13.962107 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m05:23:13.963495 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m05:23:13.963755 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m05:23:13.963998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:14.124439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7913bec0>]}
[0m05:23:14.125566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:14.126086 [info ] [MainThread]: 
[0m05:23:14.135542 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:23:14.136041 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:23:14.136682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now model.energy_consumption_analytics.stg_eia)
[0m05:23:14.137006 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:23:14.143395 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:23:14.145421 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:23:14.137224 => 05:23:14.145264
[0m05:23:14.145683 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:23:14.161397 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:23:14.162448 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:23:14.162715 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:23:14.162966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:14.711565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:14.736063 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:23:14.145869 => 05:23:14.735870
[0m05:23:14.736506 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:23:14.867845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e56cc0>]}
[0m05:23:14.869183 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m05:23:14.870252 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:23:14.872031 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:23:14.872744 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m05:23:14.873810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m05:23:14.874181 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m05:23:14.877962 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m05:23:14.880239 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 05:23:14.874415 => 05:23:14.879825
[0m05:23:14.880878 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m05:23:14.893918 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m05:23:14.895360 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m05:23:14.895651 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m05:23:14.895908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:15.090563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:15.094224 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 05:23:13.947348 => 05:23:15.093979
[0m05:23:15.094863 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m05:23:15.332583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e347170>]}
[0m05:23:15.333730 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.39s]
[0m05:23:15.335034 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:23:15.335600 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:23:15.336218 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m05:23:15.337175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m05:23:15.337596 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m05:23:15.341972 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m05:23:15.343773 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 05:23:15.337915 => 05:23:15.343442
[0m05:23:15.344374 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m05:23:15.347639 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m05:23:15.349522 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m05:23:15.349891 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m05:23:15.350334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:16.583307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:23:16.590040 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 05:23:14.881237 => 05:23:16.589530
[0m05:23:16.591173 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m05:23:16.678232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:16.682532 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 05:23:15.344790 => 05:23:16.682287
[0m05:23:16.683187 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m05:23:16.727313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f2a150>]}
[0m05:23:16.728852 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.85s]
[0m05:23:16.730361 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:23:16.731203 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:23:16.731906 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m05:23:16.733037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m05:23:16.733591 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m05:23:16.737948 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m05:23:16.739670 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 05:23:16.733990 => 05:23:16.739474
[0m05:23:16.740314 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m05:23:16.744053 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m05:23:16.746013 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m05:23:16.746410 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m05:23:16.746804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:16.818235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e3838f0>]}
[0m05:23:16.818924 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.48s]
[0m05:23:16.819879 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:23:16.820225 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:23:16.820583 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m05:23:16.821253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m05:23:16.821549 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m05:23:16.825030 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:16.826253 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 05:23:16.821804 => 05:23:16.826061
[0m05:23:16.826571 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m05:23:16.828264 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:16.829482 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:16.829730 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m05:23:16.829993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:18.737487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:23:18.738161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:23:18.742055 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 05:23:16.826740 => 05:23:18.741745
[0m05:23:18.742456 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m05:23:18.742482 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 05:23:16.740986 => 05:23:18.742240
[0m05:23:18.742981 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m05:23:18.858773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78528e00>]}
[0m05:23:18.859292 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 2.13s]
[0m05:23:18.859821 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:23:18.860154 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:23:18.860421 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m05:23:18.860932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m05:23:18.861188 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m05:23:18.863342 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:18.864163 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 05:23:18.861345 => 05:23:18.864064
[0m05:23:18.864364 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m05:23:18.865738 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:18.866606 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m05:23:18.866829 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m05:23:18.867016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:18.879468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df81d281-9ffa-465b-bedb-8f2a314432aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d907e90>]}
[0m05:23:18.879976 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 2.06s]
[0m05:23:18.880860 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:23:18.881926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:18.882099 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m05:23:18.882269 [info ] [MainThread]: 
[0m05:23:18.882583 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m05:23:18.883062 [debug] [MainThread]: Command end result
[0m05:23:18.888884 [info ] [MainThread]: 
[0m05:23:18.889157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:18.889319 [info ] [MainThread]: 
[0m05:23:18.889577 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:23:18.890163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.036473, "process_user_time": 2.394486, "process_kernel_time": 0.139377, "process_mem_max_rss": "217128", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m05:23:18.890418 [debug] [MainThread]: Command `dbt run` succeeded at 05:23:18.890368 after 9.04 seconds
[0m05:23:18.890620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5eb72ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839f7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d9070e0>]}
[0m05:23:18.890802 [debug] [MainThread]: Flushing usage events
[0m05:23:19.987855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:19.989370 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 05:23:18.864490 => 05:23:19.989264
[0m05:23:19.989627 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m05:23:20.106786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2b46382-f6ad-47d1-9ddd-124a96396722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785294c0>]}
[0m05:23:20.107169 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.25s]
[0m05:23:20.107485 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:23:20.108378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:20.108571 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m05:23:20.108771 [info ] [MainThread]: 
[0m05:23:20.108924 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.65 seconds (9.65s).
[0m05:23:20.109460 [debug] [MainThread]: Command end result
[0m05:23:20.114017 [info ] [MainThread]: 
[0m05:23:20.114304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:20.114503 [info ] [MainThread]: 
[0m05:23:20.114750 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:23:20.115360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.258085, "process_user_time": 2.436069, "process_kernel_time": 0.142765, "process_mem_max_rss": "216952", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m05:23:20.115568 [debug] [MainThread]: Command `dbt run` succeeded at 05:23:20.115528 after 10.26 seconds
[0m05:23:20.115736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f80aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5d5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1f7620>]}
[0m05:23:20.115893 [debug] [MainThread]: Flushing usage events
[0m05:23:21.957292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a374800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a551070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a501580>]}


============================== 05:23:21.960215 | bc99df27-d6f3-4645-a8eb-e7d49550b9a0 ==============================
[0m05:23:21.960215 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:21.960475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:23:22.338208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7921f1d0>]}
[0m05:23:22.389091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8497f590>]}
[0m05:23:22.389508 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:22.392669 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:22.415101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:22.415300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:22.417669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7902a2a0>]}
[0m05:23:22.422820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff790ccb90>]}
[0m05:23:22.423008 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:22.423156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a36fbc0>]}
[0m05:23:22.424029 [info ] [MainThread]: 
[0m05:23:22.424395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:22.425011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m05:23:22.430863 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:22.431033 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:22.431185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:22.820654 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:22.821561 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:22.946635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:23:22.948255 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:22.948271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920c9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920c9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920cbef0>]}
[0m05:23:22.950944 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000


============================== 05:23:22.951014 | 2f49cc9b-388a-4c7d-8ac3-21a537142508 ==============================
[0m05:23:22.951014 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:22.951128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:22.951345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:23:23.311378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77912750>]}
[0m05:23:23.359767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff721da9f0>]}
[0m05:23:23.360076 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:23.363101 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:23.388321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:23.388488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:23.390676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712b1790>]}
[0m05:23:23.396308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70dcc8f0>]}
[0m05:23:23.396487 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:23.396675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f55be0>]}
[0m05:23:23.397562 [info ] [MainThread]: 
[0m05:23:23.397909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:23.398501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m05:23:23.403978 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:23.404145 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:23:23.404294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:23.506606 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:23:23.507721 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:23.677032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m05:23:23.681470 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:23.682064 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:23.682988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:23.836015 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:23.837442 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:23.974884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m05:23:23.977887 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:23.978207 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:23.978495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:24.054028 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:24.055216 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:24.176335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc99df27-d6f3-4645-a8eb-e7d49550b9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a385790>]}
[0m05:23:24.176826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:24.177158 [info ] [MainThread]: 
[0m05:23:24.181390 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:24.181606 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m05:23:24.182103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m05:23:24.182306 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:24.189540 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:24.190978 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 05:23:24.182441 => 05:23:24.190897
[0m05:23:24.191835 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:24.200868 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:24.202998 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:24.203828 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m05:23:24.204605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:24.360210 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:24.361387 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:24.484490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m05:23:24.488361 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:24.488912 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:24.489788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:24.676267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:24.685918 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 05:23:24.192699 => 05:23:24.685600
[0m05:23:24.686606 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m05:23:24.821014 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.64s]
[0m05:23:24.821658 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:24.821996 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:24.822322 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m05:23:24.822879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m05:23:24.823208 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:24.827795 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:24.828851 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 05:23:24.823466 => 05:23:24.828691
[0m05:23:24.829135 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:24.830994 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:24.831934 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:24.832216 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m05:23:24.832448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:24.931949 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:24.933697 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:25.081231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f49cc9b-388a-4c7d-8ac3-21a537142508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d81490>]}
[0m05:23:25.082096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:25.082575 [info ] [MainThread]: 
[0m05:23:25.089933 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:25.090249 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m05:23:25.091233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m05:23:25.091617 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:25.102822 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:25.103736 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 05:23:25.091836 => 05:23:25.103591
[0m05:23:25.103983 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:25.115258 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:25.116270 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m05:23:25.116485 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m05:23:25.116710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:25.295624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:25.298823 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 05:23:24.829306 => 05:23:25.298457
[0m05:23:25.299424 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m05:23:25.446441 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.62s]
[0m05:23:25.447676 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:25.448329 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:25.448877 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m05:23:25.450066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m05:23:25.450591 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:25.459738 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:25.461192 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 05:23:25.450878 => 05:23:25.460895
[0m05:23:25.461653 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:25.464509 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:25.465647 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:25.465952 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m05:23:25.466228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:25.509735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:25.516808 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 05:23:25.104163 => 05:23:25.516520
[0m05:23:25.517238 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m05:23:25.657331 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.57s]
[0m05:23:25.658513 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m05:23:25.659179 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:25.659756 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m05:23:25.660742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m05:23:25.661242 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:25.668608 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:25.670363 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 05:23:25.661711 => 05:23:25.670101
[0m05:23:25.670809 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:25.673967 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:25.675702 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m05:23:25.676079 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m05:23:25.676394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:25.857851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:25.859941 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 05:23:25.461918 => 05:23:25.859718
[0m05:23:25.860336 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m05:23:25.985822 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.54s]
[0m05:23:25.987600 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:25.988412 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:25.988967 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m05:23:25.990230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m05:23:25.990692 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:25.996615 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:25.998223 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 05:23:25.990967 => 05:23:25.998001
[0m05:23:25.998591 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:26.001624 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:26.003222 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:26.003627 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m05:23:26.004089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:26.082734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:26.085295 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 05:23:25.671043 => 05:23:26.085063
[0m05:23:26.085758 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m05:23:26.208753 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.55s]
[0m05:23:26.209476 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m05:23:26.209945 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:26.210318 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m05:23:26.210989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m05:23:26.211338 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:26.217298 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:26.218471 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 05:23:26.211580 => 05:23:26.218307
[0m05:23:26.218793 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:26.220668 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:26.221700 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m05:23:26.222005 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m05:23:26.222316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:26.455310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:26.458968 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 05:23:25.998796 => 05:23:26.458655
[0m05:23:26.459519 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m05:23:26.613178 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.62s]
[0m05:23:26.614552 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:26.615508 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:26.616171 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m05:23:26.617375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m05:23:26.617904 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:26.625795 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:26.628204 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 05:23:26.618260 => 05:23:26.627891
[0m05:23:26.628692 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:26.631538 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:26.632934 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:26.633281 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m05:23:26.633654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:26.719946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:26.722803 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 05:23:26.218982 => 05:23:26.722476
[0m05:23:26.723307 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m05:23:26.857683 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.65s]
[0m05:23:26.858386 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m05:23:26.858835 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:26.859201 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m05:23:26.859869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m05:23:26.860217 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:26.864088 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:26.865268 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 05:23:26.860481 => 05:23:26.865115
[0m05:23:26.865583 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:26.867548 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:26.868540 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m05:23:26.868817 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m05:23:26.869354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:27.109332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:27.112739 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 05:23:26.628988 => 05:23:27.112339
[0m05:23:27.113351 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m05:23:27.219078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:27.222602 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 05:23:26.865783 => 05:23:27.222267
[0m05:23:27.223236 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m05:23:27.339104 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.48s]
[0m05:23:27.340257 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m05:23:27.340910 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:27.341417 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m05:23:27.342309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m05:23:27.342771 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:27.350650 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:27.352393 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 05:23:27.343070 => 05:23:27.352180
[0m05:23:27.352817 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:27.356140 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:27.357865 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m05:23:27.358264 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m05:23:27.358635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:27.497993 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.88s]
[0m05:23:27.499314 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:27.499991 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.500522 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m05:23:27.501853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m05:23:27.502398 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.509020 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.510826 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 05:23:27.502729 => 05:23:27.510550
[0m05:23:27.511207 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.513901 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.514989 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.515349 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m05:23:27.515931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:27.692223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:27.695867 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 05:23:27.353095 => 05:23:27.695473
[0m05:23:27.696490 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m05:23:27.811481 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.47s]
[0m05:23:27.812105 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m05:23:27.812478 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.812820 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m05:23:27.813373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m05:23:27.813659 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.817254 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.818310 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 05:23:27.813849 => 05:23:27.818173
[0m05:23:27.818583 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:27.820384 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.821215 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m05:23:27.821442 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m05:23:27.821713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:27.907252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:27.909330 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 05:23:27.511446 => 05:23:27.909116
[0m05:23:27.909739 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m05:23:28.037065 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.54s]
[0m05:23:28.038193 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:28.038789 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.039225 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m05:23:28.040369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m05:23:28.040844 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.047076 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.049622 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 05:23:28.041120 => 05:23:28.049406
[0m05:23:28.049975 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.053085 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.054680 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.055144 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m05:23:28.055473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:28.207735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:28.210805 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 05:23:27.818758 => 05:23:28.210410
[0m05:23:28.211354 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m05:23:28.364649 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.55s]
[0m05:23:28.365108 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m05:23:28.365370 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.365596 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m05:23:28.366067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m05:23:28.366349 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.368906 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.369619 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 05:23:28.366535 => 05:23:28.369501
[0m05:23:28.369802 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.371096 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.371786 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m05:23:28.371962 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m05:23:28.372120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:28.527328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:28.530465 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 05:23:28.050182 => 05:23:28.530139
[0m05:23:28.531028 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m05:23:28.682151 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.64s]
[0m05:23:28.683826 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.684404 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.684899 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m05:23:28.686035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m05:23:28.686580 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.692688 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.694343 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 05:23:28.686925 => 05:23:28.694111
[0m05:23:28.694741 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.698013 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.699690 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.700156 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m05:23:28.700560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:28.731028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:28.733198 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 05:23:28.369937 => 05:23:28.732992
[0m05:23:28.733609 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m05:23:28.884112 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.52s]
[0m05:23:28.884652 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m05:23:28.884956 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.885250 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m05:23:28.885753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m05:23:28.885957 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.888727 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.889364 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 05:23:28.886095 => 05:23:28.889253
[0m05:23:28.889562 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:28.890945 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.891663 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m05:23:28.891839 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m05:23:28.891992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:29.072205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:29.075484 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 05:23:28.695009 => 05:23:29.075190
[0m05:23:29.076014 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m05:23:29.280912 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.59s]
[0m05:23:29.282669 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:29.283329 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.283877 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m05:23:29.285125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m05:23:29.285792 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.292134 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.293979 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 05:23:29.286124 => 05:23:29.293705
[0m05:23:29.294424 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.297663 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.299592 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.299987 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m05:23:29.300343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:29.364181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:29.366350 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 05:23:28.889676 => 05:23:29.366138
[0m05:23:29.366787 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m05:23:29.520396 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.63s]
[0m05:23:29.521633 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m05:23:29.522327 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.522894 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m05:23:29.523825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m05:23:29.524294 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.529908 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.531774 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 05:23:29.524567 => 05:23:29.531402
[0m05:23:29.532264 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.535264 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.536665 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m05:23:29.537107 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m05:23:29.537575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:29.807905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:29.811608 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 05:23:29.294748 => 05:23:29.811252
[0m05:23:29.812281 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m05:23:29.899871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:29.903147 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 05:23:29.532561 => 05:23:29.902826
[0m05:23:29.903835 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m05:23:29.958448 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.67s]
[0m05:23:29.960125 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:29.960756 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:29.961254 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m05:23:29.962582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m05:23:29.963075 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:29.971098 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:29.972892 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 05:23:29.963350 => 05:23:29.972550
[0m05:23:29.973431 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:29.976510 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:29.978018 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:29.978381 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m05:23:29.978735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:30.043688 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.52s]
[0m05:23:30.044390 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m05:23:30.044846 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:30.045207 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m05:23:30.045905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m05:23:30.046229 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:30.051725 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:30.052780 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 05:23:30.046508 => 05:23:30.052641
[0m05:23:30.053033 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:30.054864 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:30.055854 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m05:23:30.056162 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m05:23:30.056439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:30.456064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:30.458106 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 05:23:30.053212 => 05:23:30.457920
[0m05:23:30.458457 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m05:23:30.537756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:30.541052 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 05:23:29.973824 => 05:23:30.540740
[0m05:23:30.541619 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m05:23:30.685371 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.64s]
[0m05:23:30.686685 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:30.687585 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.690807 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m05:23:30.690831 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.73s]
[0m05:23:30.691835 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m05:23:30.691959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m05:23:30.692408 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.692458 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.692899 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m05:23:30.694109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m05:23:30.694639 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.698892 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.700323 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.702824 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 05:23:30.694933 => 05:23:30.702564
[0m05:23:30.703276 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.703376 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 05:23:30.693156 => 05:23:30.703091
[0m05:23:30.706097 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.706506 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:30.707376 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.707721 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m05:23:30.708020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:30.708938 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.710490 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m05:23:30.710890 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m05:23:30.711229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:31.172176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:31.173657 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 05:23:30.706775 => 05:23:31.173523
[0m05:23:31.173908 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m05:23:31.182085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:31.183334 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 05:23:30.703640 => 05:23:31.183195
[0m05:23:31.183589 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m05:23:31.352389 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.66s]
[0m05:23:31.353974 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:31.356390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:31.356827 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m05:23:31.357193 [info ] [MainThread]: 
[0m05:23:31.357552 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m05:23:31.359316 [debug] [MainThread]: Command end result
[0m05:23:31.364776 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.67s]
[0m05:23:31.366358 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m05:23:31.368330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:31.368694 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m05:23:31.369013 [info ] [MainThread]: 
[0m05:23:31.369293 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 8.94 seconds (8.94s).
[0m05:23:31.370857 [debug] [MainThread]: Command end result
[0m05:23:31.370773 [info ] [MainThread]: 
[0m05:23:31.374699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:31.375062 [info ] [MainThread]: 
[0m05:23:31.375341 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m05:23:31.376048 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.449083, "process_user_time": 2.879576, "process_kernel_time": 0.125374, "process_mem_max_rss": "217184", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m05:23:31.376434 [debug] [MainThread]: Command `dbt test` succeeded at 05:23:31.376356 after 8.45 seconds
[0m05:23:31.376717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923ba420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922abb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71458200>]}
[0m05:23:31.377259 [debug] [MainThread]: Flushing usage events
[0m05:23:31.381309 [info ] [MainThread]: 
[0m05:23:31.381680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:31.382133 [info ] [MainThread]: 
[0m05:23:31.382470 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m05:23:31.383129 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.446278, "process_user_time": 2.757133, "process_kernel_time": 0.151601, "process_mem_max_rss": "217644", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m05:23:31.383443 [debug] [MainThread]: Command `dbt test` succeeded at 05:23:31.383381 after 9.45 seconds
[0m05:23:31.383853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a501580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a550a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79199190>]}
[0m05:23:31.384085 [debug] [MainThread]: Flushing usage events
[0m05:23:34.064031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80353d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800984d0>]}


============================== 05:23:34.067110 | 36f023f9-c4cb-4936-a337-b316ba51154f ==============================
[0m05:23:34.067110 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:34.067570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:23:34.157389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c49e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcb9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e52180>]}


============================== 05:23:34.165661 | c620d95e-3578-46c3-977a-45dc6bdf6a39 ==============================
[0m05:23:34.165661 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:23:34.166443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:23:34.490988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5af04260>]}
[0m05:23:34.545644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bba630>]}
[0m05:23:34.546134 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:34.549896 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:34.566439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6390f7a0>]}
[0m05:23:34.577557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:34.577810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:34.580431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ae80b30>]}
[0m05:23:34.586430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5abb0bc0>]}
[0m05:23:34.586717 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:34.587080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5abb02c0>]}
[0m05:23:34.587943 [info ] [MainThread]: 
[0m05:23:34.588434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:34.589068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:23:34.595066 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:34.595313 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:34.595603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:34.621860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e8bfb0>]}
[0m05:23:34.622290 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:23:34.625725 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:23:34.655354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:34.655606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:34.658076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff639955b0>]}
[0m05:23:34.663553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6388d1c0>]}
[0m05:23:34.663761 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:23:34.663936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6390ccb0>]}
[0m05:23:34.664808 [info ] [MainThread]: 
[0m05:23:34.665181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:34.665744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:23:34.671447 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:23:34.671644 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:23:34.671813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:35.028002 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:35.029108 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:35.078286 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:23:35.079605 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:23:35.166655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m05:23:35.175454 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:35.175906 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:35.176275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:35.203014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m05:23:35.209837 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:23:35.210147 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:23:35.210392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:35.552017 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:35.555128 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:35.653385 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:23:35.656563 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:23:35.682351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m05:23:35.686298 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:35.686889 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:35.687924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:36.117383 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:36.120343 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:36.332399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m05:23:36.337509 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:36.338096 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:23:36.338548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:36.361421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m05:23:36.365161 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:23:36.365707 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:23:36.366505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:36.708030 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:36.710850 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:36.744071 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:36.747001 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:23:36.875102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a4a600>]}
[0m05:23:36.875799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m05:23:36.876331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:36.877431 [info ] [MainThread]: 
[0m05:23:36.881244 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:23:36.881862 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:23:36.882305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:36.888755 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:36.889565 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m05:23:36.891063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m05:23:36.891692 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:36.898784 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 05:23:36.892011 => 05:23:36.898588
[0m05:23:36.899106 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:36.932082 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:36.932330 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:23:36.932540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:37.250406 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:23:37.252654 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:23:37.298984 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m05:23:37.309926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:37.310583 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:37.419626 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:37.429300 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:37.429954 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:37.556815 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:37.586729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:37.587317 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:23:37.722809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82309a30>]}
[0m05:23:37.724148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:37.724794 [info ] [MainThread]: 
[0m05:23:37.736231 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:37.737056 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m05:23:37.737945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m05:23:37.738373 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:37.745545 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 05:23:37.738675 => 05:23:37.745331
[0m05:23:37.746012 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:37.779450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:37.779704 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:23:37.779915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:38.181103 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m05:23:38.197426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:38.198391 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:38.294229 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:38.303666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:38.304438 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:38.393102 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:38.416877 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:38.417260 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:23:39.013126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:39.017670 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.018321 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:39.129126 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:39.134853 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.135502 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:39.245959 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:39.251460 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.252197 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:39.394942 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:39.402664 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.403432 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:39.507081 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:39.514886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.515399 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:39.674830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:23:39.679668 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.680381 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:39.981807 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:39.986681 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:39.993133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.993426 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.993807 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:39.997195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:39.997722 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m05:23:40.315728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:40.316441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.316877 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:23:40.320692 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:40.324979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.325401 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:40.426858 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:40.435519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.436240 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:23:40.513962 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:23:40.520440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.520821 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:23:40.608950 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:23:40.618206 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.620217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.620621 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m05:23:40.753334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:23:40.754610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:23:40.755302 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:23:40.865716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d723-0307-3287-000f-c0df00adfb26
[0m05:23:40.866421 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m05:23:40.867195 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 05:23:36.899324 => 05:23:40.866950
[0m05:23:40.867694 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m05:23:41.001489 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:23:41.001929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f023f9-c4cb-4936-a337-b316ba51154f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a1e8aa0>]}
[0m05:23:41.002436 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 4.11s]
[0m05:23:41.003007 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:41.004474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:41.004682 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m05:23:41.004917 [info ] [MainThread]: 
[0m05:23:41.005225 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m05:23:41.005581 [debug] [MainThread]: Command end result
[0m05:23:41.011387 [info ] [MainThread]: 
[0m05:23:41.011780 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:23:41.011967 [info ] [MainThread]: 
[0m05:23:41.012197 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:23:41.012420 [info ] [MainThread]: 
[0m05:23:41.012656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:23:41.013149 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.9733753, "process_user_time": 2.584217, "process_kernel_time": 0.119349, "process_mem_max_rss": "218440", "process_out_blocks": "1864", "command_success": false, "process_in_blocks": "0"}
[0m05:23:41.013420 [debug] [MainThread]: Command `dbt snapshot` failed at 05:23:41.013356 after 6.97 seconds
[0m05:23:41.013649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80353d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8027a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ae579e0>]}
[0m05:23:41.013876 [debug] [MainThread]: Flushing usage events
[0m05:23:41.209031 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d723-0307-3287-000f-c0df00adfb32
[0m05:23:41.209386 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m05:23:41.209794 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 05:23:37.746282 => 05:23:41.209640
[0m05:23:41.210048 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m05:23:41.368453 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:23:41.369223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620d95e-3578-46c3-977a-45dc6bdf6a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff635b46e0>]}
[0m05:23:41.370151 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 3.63s]
[0m05:23:41.370853 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:23:41.373484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:41.373907 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m05:23:41.374301 [info ] [MainThread]: 
[0m05:23:41.374653 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m05:23:41.375260 [debug] [MainThread]: Command end result
[0m05:23:41.383880 [info ] [MainThread]: 
[0m05:23:41.384210 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:23:41.384447 [info ] [MainThread]: 
[0m05:23:41.384669 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:23:41.384868 [info ] [MainThread]: 
[0m05:23:41.385069 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:23:41.385702 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.298984, "process_user_time": 2.597861, "process_kernel_time": 0.141921, "process_mem_max_rss": "218572", "process_out_blocks": "1864", "command_success": false, "process_in_blocks": "0"}
[0m05:23:41.386026 [debug] [MainThread]: Command `dbt snapshot` failed at 05:23:41.385953 after 7.30 seconds
[0m05:23:41.386277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de0a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63856960>]}
[0m05:23:41.386515 [debug] [MainThread]: Flushing usage events
[0m05:25:39.464391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab838140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadcc1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab838f20>]}


============================== 05:25:39.467397 | 13f9fa05-7f22-4f9f-8304-68deac56b52b ==============================
[0m05:25:39.467397 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:25:39.467664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:25:39.820031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866f92e0>]}
[0m05:25:39.868070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8655ff80>]}
[0m05:25:39.868430 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:25:39.871547 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:25:39.894054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:25:39.894215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:25:39.896445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b71700>]}
[0m05:25:39.901838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86340980>]}
[0m05:25:39.901998 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:25:39.902283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86845bb0>]}
[0m05:25:39.902953 [info ] [MainThread]: 
[0m05:25:39.903328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:39.903829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:25:39.908892 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:25:39.909055 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:25:39.909179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:40.382740 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:25:40.384559 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:25:40.503692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:25:40.514281 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:25:40.514935 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:25:40.515332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:40.900184 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:25:40.902967 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:25:41.034722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:25:41.040315 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:25:41.040940 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:25:41.041369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:41.544122 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m05:25:41.546693 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:25:41.687794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:25:41.692173 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:25:41.692740 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:25:41.693288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:43.094016 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:25:43.094928 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:25:43.224744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859afcb0>]}
[0m05:25:43.225189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:25:43.225368 [info ] [MainThread]: 
[0m05:25:43.239870 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:25:43.240189 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m05:25:43.240747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m05:25:43.242487 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:25:43.245987 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 05:25:43.242626 => 05:25:43.245888
[0m05:25:43.249473 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:25:43.273662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:43.273959 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:25:43.274131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:43.705879 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m05:25:43.713554 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:43.713994 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:25:43.795356 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:25:43.798546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:43.798779 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:25:43.899842 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:25:43.911737 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:43.912011 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:25:44.879694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:25:44.884960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:44.885787 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:25:45.003399 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:25:45.009264 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.009961 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:25:45.121932 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:25:45.127530 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.128152 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:25:45.242593 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:25:45.250655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.251383 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:25:45.388643 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:25:45.398587 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.399222 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:25:45.500884 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:25:45.512156 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.516087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.516733 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m05:25:45.735462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:25:45.736362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:25:45.736995 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:25:46.300467 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d725-0307-327f-000f-c0df00adebea
[0m05:25:46.301595 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m05:25:46.302605 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 05:25:43.249678 => 05:25:46.302204
[0m05:25:46.303169 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m05:25:46.459673 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:25:46.460824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13f9fa05-7f22-4f9f-8304-68deac56b52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85821ca0>]}
[0m05:25:46.462090 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 3.22s]
[0m05:25:46.463111 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:25:46.466840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:46.467502 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m05:25:46.467905 [info ] [MainThread]: 
[0m05:25:46.468257 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m05:25:46.468924 [debug] [MainThread]: Command end result
[0m05:25:46.480758 [info ] [MainThread]: 
[0m05:25:46.481457 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:25:46.481906 [info ] [MainThread]: 
[0m05:25:46.482369 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m05:25:46.482901 [info ] [MainThread]: 
[0m05:25:46.483477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:25:46.484759 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.0407186, "process_user_time": 2.562192, "process_kernel_time": 0.134062, "process_mem_max_rss": "218420", "process_out_blocks": "1864", "command_success": false, "process_in_blocks": "0"}
[0m05:25:46.485151 [debug] [MainThread]: Command `dbt snapshot` failed at 05:25:46.485074 after 7.04 seconds
[0m05:25:46.485514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8e9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86612ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862f2a20>]}
[0m05:25:46.485868 [debug] [MainThread]: Flushing usage events
[0m05:31:34.138502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a9b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d8b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5be48c0>]}


============================== 05:31:34.141549 | 4c6b8292-fdb5-4725-b0dd-b95d014f1411 ==============================
[0m05:31:34.141549 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:31:34.141920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:31:34.504781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c3a390>]}
[0m05:31:34.551528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9575f0b0>]}
[0m05:31:34.551831 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:31:34.555030 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:31:34.583326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:31:34.583504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:31:34.585686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9472e0c0>]}
[0m05:31:34.590694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945d4b90>]}
[0m05:31:34.590869 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:31:34.591180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9498b800>]}
[0m05:31:34.591857 [info ] [MainThread]: 
[0m05:31:34.592254 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:31:34.592784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:31:34.597702 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:31:34.597845 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:31:34.597980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:31:35.153499 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:31:35.155548 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:31:35.291011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:31:35.301056 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:31:35.301662 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:31:35.302007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:31:35.742638 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:31:35.745185 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:31:35.882507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:31:35.888352 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:31:35.888937 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:31:35.889430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:31:36.303268 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:31:36.305414 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:31:36.454244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:31:36.459365 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:31:36.460410 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:31:36.461144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:31:36.869319 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:31:36.872323 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:31:37.009563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944f6ae0>]}
[0m05:31:37.010113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:31:37.010553 [info ] [MainThread]: 
[0m05:31:37.015969 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:31:37.019244 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m05:31:37.019652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m05:31:37.019851 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:31:37.023777 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 05:31:37.019991 => 05:31:37.023659
[0m05:31:37.024010 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:31:37.048594 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:37.048837 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:31:37.049039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:31:37.941393 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m05:31:37.953270 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:37.954181 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:31:38.040506 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:31:38.049653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:38.050379 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:31:38.168329 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:31:38.198377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:38.199024 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:31:39.372340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:31:39.374058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.374318 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:31:39.459732 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:31:39.462505 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.462916 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:31:39.541230 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:31:39.542938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.543142 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:31:39.637771 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:31:39.640080 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.640275 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:31:39.733338 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:31:39.736440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.736641 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:31:39.810625 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:31:39.820444 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.829662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.833236 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m05:31:39.968262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:31:39.968590 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:39.968787 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:31:40.705704 [debug] [Thread-1 (]: SQL status: SUCCESS 6520 in 1.0 seconds
[0m05:31:40.706210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:31:40.706401 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m05:31:40.994328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:31:41.016869 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 05:31:37.024169 => 05:31:41.016617
[0m05:31:41.017312 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m05:31:41.136150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6b8292-fdb5-4725-b0dd-b95d014f1411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942b0c20>]}
[0m05:31:41.137211 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 6520[0m in 4.12s]
[0m05:31:41.138853 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:31:41.140917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:31:41.141386 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m05:31:41.141757 [info ] [MainThread]: 
[0m05:31:41.142245 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m05:31:41.142775 [debug] [MainThread]: Command end result
[0m05:31:41.151389 [info ] [MainThread]: 
[0m05:31:41.151782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:31:41.151994 [info ] [MainThread]: 
[0m05:31:41.152337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:31:41.153324 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.0376124, "process_user_time": 2.573734, "process_kernel_time": 0.13387, "process_mem_max_rss": "217508", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m05:31:41.153697 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:31:41.153629 after 7.04 seconds
[0m05:31:41.153969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d8b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a9dfd0>]}
[0m05:31:41.154250 [debug] [MainThread]: Flushing usage events
[0m05:32:18.377664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f398380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9783e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f399070>]}


============================== 05:32:18.380448 | a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8 ==============================
[0m05:32:18.380448 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:32:18.380849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:32:18.730110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f56d6d0>]}
[0m05:32:18.777094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3a80e0>]}
[0m05:32:18.777412 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:32:18.780478 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:32:18.805761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:32:18.805938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:32:18.808173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e1d2e70>]}
[0m05:32:18.813824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e0fc920>]}
[0m05:32:18.814026 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:32:18.814367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f989eb0>]}
[0m05:32:18.815105 [info ] [MainThread]: 
[0m05:32:18.815475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:32:18.815972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:32:18.820902 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:32:18.821052 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:32:18.821184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:19.282182 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:32:19.283872 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:32:19.523721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:32:19.534388 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:32:19.534955 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:32:19.535584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:19.932901 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:32:19.936036 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:32:20.064061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:32:20.067357 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:32:20.067620 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:32:20.067873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:20.454555 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:32:20.457385 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:32:20.631964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:32:20.636411 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:32:20.636984 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:32:20.637401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:21.090235 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:32:21.092988 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:32:21.269459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e46c740>]}
[0m05:32:21.270326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:32:21.271064 [info ] [MainThread]: 
[0m05:32:21.278787 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:32:21.279169 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m05:32:21.279917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m05:32:21.280187 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:32:21.285468 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 05:32:21.280384 => 05:32:21.285320
[0m05:32:21.285734 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:32:21.314659 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:21.314896 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:32:21.315079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:21.826780 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m05:32:21.838665 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:21.839430 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:32:21.942631 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:32:21.952511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:21.953190 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:32:22.026362 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:32:22.048252 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:22.048626 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:32:23.101169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:32:23.106990 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.107793 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:32:23.215011 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:32:23.219872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.220421 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:32:23.324208 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:32:23.328960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.329546 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:32:23.408828 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:32:23.418222 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.418973 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m05:32:23.495300 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:32:23.506262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.507140 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m05:32:23.624541 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m05:32:23.634453 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.638029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.638577 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m05:32:23.739971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:32:23.740797 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:23.741347 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:32:24.430137 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m05:32:24.431339 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m05:32:24.432089 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m05:32:24.678175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:32:24.702441 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 05:32:21.285907 => 05:32:24.702224
[0m05:32:24.702988 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m05:32:24.812325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9b21ff1-f28e-4eca-9d9a-bb9a9f1b72a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d408770>]}
[0m05:32:24.813013 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 3.53s]
[0m05:32:24.814026 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m05:32:24.815727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:32:24.815964 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m05:32:24.816186 [info ] [MainThread]: 
[0m05:32:24.816540 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m05:32:24.816996 [debug] [MainThread]: Command end result
[0m05:32:24.823325 [info ] [MainThread]: 
[0m05:32:24.823643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:32:24.823837 [info ] [MainThread]: 
[0m05:32:24.824094 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:32:24.824740 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.4685903, "process_user_time": 2.619825, "process_kernel_time": 0.10941, "process_mem_max_rss": "218156", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m05:32:24.825015 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:32:24.824959 after 6.47 seconds
[0m05:32:24.825222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f64e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f677e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6a2690>]}
[0m05:32:24.825415 [debug] [MainThread]: Flushing usage events
[0m05:48:36.449425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbc4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade7fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc751f0>]}


============================== 05:48:36.452570 | 6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c ==============================
[0m05:48:36.452570 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:48:36.452973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:48:36.797653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d224e0>]}
[0m05:48:36.844141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e0aa50>]}
[0m05:48:36.844468 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:48:36.847683 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:48:36.876103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:48:36.876267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:48:36.878461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c931e80>]}
[0m05:48:36.883927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8693a0>]}
[0m05:48:36.884102 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:48:36.884377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c869220>]}
[0m05:48:36.885134 [info ] [MainThread]: 
[0m05:48:36.885515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:48:36.886062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:48:36.891027 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:48:36.891194 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:48:36.891320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:37.610670 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:48:37.613337 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:48:37.753423 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:48:37.754224 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:48:37.754749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:38.250292 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:48:38.253870 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:48:38.391374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m05:48:38.402172 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:48:38.402756 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:48:38.403137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:39.922535 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m05:48:39.925557 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:48:40.156241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:48:40.160290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:48:40.160993 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:48:40.163191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:40.776774 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:48:40.779520 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:48:41.268280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m05:48:41.272387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:48:41.273038 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:48:41.273609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:41.806501 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m05:48:41.809637 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:48:41.949342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c517ec0>]}
[0m05:48:41.950921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:48:41.952119 [info ] [MainThread]: 
[0m05:48:41.963811 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:48:41.964612 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:48:41.965725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now model.energy_consumption_analytics.stg_eia)
[0m05:48:41.966089 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:48:41.972799 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:48:41.974959 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:48:41.966328 => 05:48:41.974806
[0m05:48:41.975222 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:48:41.992351 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:48:41.993490 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:48:41.993716 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:48:41.993924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:42.514822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:48:42.539182 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:48:41.975400 => 05:48:42.538982
[0m05:48:42.539682 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:48:42.695471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c54eb70>]}
[0m05:48:42.696726 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m05:48:42.698702 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:48:42.700327 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:48:42.700932 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m05:48:42.702162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m05:48:42.702629 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m05:48:42.706194 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m05:48:42.708225 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 05:48:42.702922 => 05:48:42.707999
[0m05:48:42.708574 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m05:48:42.724737 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m05:48:42.726239 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m05:48:42.726506 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m05:48:42.726800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:44.053980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:48:44.056688 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 05:48:42.708788 => 05:48:44.056523
[0m05:48:44.057054 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m05:48:44.191048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c55b050>]}
[0m05:48:44.192926 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.49s]
[0m05:48:44.194683 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:48:44.195618 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:48:44.196481 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m05:48:44.198150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m05:48:44.198947 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m05:48:44.204176 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m05:48:44.205886 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 05:48:44.199385 => 05:48:44.205630
[0m05:48:44.206338 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m05:48:44.209198 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m05:48:44.210997 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m05:48:44.211384 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m05:48:44.211760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:45.986590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:48:45.990887 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 05:48:44.206661 => 05:48:45.990621
[0m05:48:45.991509 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m05:48:46.129918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3b1550>]}
[0m05:48:46.130996 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.93s]
[0m05:48:46.132327 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:48:46.132856 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:48:46.133342 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m05:48:46.134719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m05:48:46.135275 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m05:48:46.140005 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:48:46.141785 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 05:48:46.135597 => 05:48:46.141616
[0m05:48:46.142068 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m05:48:46.144226 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:48:46.145769 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m05:48:46.146082 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m05:48:46.146464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:47.519610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:48:47.521294 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 05:48:46.142241 => 05:48:47.521176
[0m05:48:47.521537 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m05:48:47.692724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6445a5a8-fcc5-4f18-9cfd-9ed59b98b31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3cb440>]}
[0m05:48:47.693940 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.56s]
[0m05:48:47.695363 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:48:47.697858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:48:47.698392 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m05:48:47.698982 [info ] [MainThread]: 
[0m05:48:47.699823 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m05:48:47.701073 [debug] [MainThread]: Command end result
[0m05:48:47.713702 [info ] [MainThread]: 
[0m05:48:47.714310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:48:47.714606 [info ] [MainThread]: 
[0m05:48:47.715014 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:48:47.716029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.287688, "process_user_time": 2.72133, "process_kernel_time": 0.124702, "process_mem_max_rss": "217876", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m05:48:47.716480 [debug] [MainThread]: Command `dbt run` succeeded at 05:48:47.716363 after 11.29 seconds
[0m05:48:47.716824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade7fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb076d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c637380>]}
[0m05:48:47.717111 [debug] [MainThread]: Flushing usage events
[0m05:59:49.868307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67dbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77bfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70567b0>]}
[0m05:59:49.868308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54cee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa567c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b905f0>]}


============================== 05:59:49.871538 | 4558bc5f-88cd-4d5e-bc32-655d7c993ec2 ==============================
[0m05:59:49.871538 [info ] [MainThread]: Running with dbt=1.7.0


============================== 05:59:49.871582 | 71335f47-29a8-4de1-83e8-0ed254f9a3f4 ==============================
[0m05:59:49.871582 [info ] [MainThread]: Running with dbt=1.7.0
[0m05:59:49.871804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:59:49.871884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m05:59:50.276576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843a9fd0>]}
[0m05:59:50.278350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67df920>]}
[0m05:59:50.328190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849bfa40>]}
[0m05:59:50.328615 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:59:50.331085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c1ed20>]}
[0m05:59:50.331904 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:59:50.331898 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m05:59:50.336769 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m05:59:50.360658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:59:50.360945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:59:50.363752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54cec00>]}
[0m05:59:50.365999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:59:50.366404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:59:50.368930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85538830>]}
[0m05:59:50.369641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841967b0>]}
[0m05:59:50.369861 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:59:50.370042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84219010>]}
[0m05:59:50.370856 [info ] [MainThread]: 
[0m05:59:50.371199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:59:50.371770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:59:50.374474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85499a00>]}
[0m05:59:50.374687 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m05:59:50.374882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854e5c70>]}
[0m05:59:50.375741 [info ] [MainThread]: 
[0m05:59:50.376107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:59:50.376651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m05:59:50.377231 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:59:50.377400 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:59:50.377549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:50.383182 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:59:50.383396 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:59:50.383571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:50.898486 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:59:50.901255 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:59:51.027545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:59:51.028345 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:59:51.028921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:51.225304 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:59:51.226987 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:59:51.473757 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m05:59:51.476457 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:59:51.672976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m05:59:51.673365 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m05:59:51.674069 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m05:59:51.674618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:51.682371 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:59:51.682822 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:59:51.683018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:52.430895 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m05:59:52.431083 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m05:59:52.433778 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m05:59:52.433900 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:59:52.561142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:59:52.565120 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:59:52.565767 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:59:52.566685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:52.572088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m05:59:52.581923 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:59:52.582477 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:59:52.582812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:52.937479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:59:52.940632 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:59:52.973357 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:59:52.975916 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:59:53.065547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m05:59:53.069352 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m05:59:53.069885 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m05:59:53.070282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:53.101494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m05:59:53.105470 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m05:59:53.105883 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m05:59:53.106257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:53.510402 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m05:59:53.513459 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m05:59:53.540626 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m05:59:53.543603 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m05:59:53.648491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d53a10>]}
[0m05:59:53.650184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:59:53.650760 [info ] [MainThread]: 
[0m05:59:53.664972 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:59:53.666257 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:59:53.667231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now model.energy_consumption_analytics.stg_eia)
[0m05:59:53.667824 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:59:53.675456 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:59:53.678313 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:59:53.669779 => 05:59:53.678065
[0m05:59:53.678672 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:59:53.683504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m05:59:53.685418 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m05:59:53.685635 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m05:59:53.685799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:53.694486 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:59:53.695589 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:59:53.695799 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:59:53.695991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:54.221362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:54.240249 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:59:53.678906 => 05:59:54.240077
[0m05:59:54.240613 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:59:54.353451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd9ff80>]}
[0m05:59:54.354705 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m05:59:54.355582 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:59:54.357342 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:59:54.358106 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m05:59:54.359401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m05:59:54.360169 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m05:59:54.364644 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m05:59:54.366697 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 05:59:54.360630 => 05:59:54.366421
[0m05:59:54.367279 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m05:59:54.385539 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m05:59:54.387161 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m05:59:54.387443 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m05:59:54.387697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:54.426306 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:59:54.427249 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m05:59:54.569052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8559a3f0>]}
[0m05:59:54.570062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:59:54.570617 [info ] [MainThread]: 
[0m05:59:54.579013 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m05:59:54.579475 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m05:59:54.580085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m05:59:54.580487 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m05:59:54.585849 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m05:59:54.586864 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 05:59:54.580764 => 05:59:54.586708
[0m05:59:54.587155 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m05:59:54.603014 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m05:59:54.604037 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m05:59:54.604248 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m05:59:54.604421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:55.058351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:59:55.082063 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 05:59:54.587346 => 05:59:55.081884
[0m05:59:55.082480 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m05:59:55.216966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8524cb30>]}
[0m05:59:55.217646 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m05:59:55.218597 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m05:59:55.219476 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m05:59:55.219889 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m05:59:55.220498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m05:59:55.220791 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m05:59:55.223085 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m05:59:55.224024 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 05:59:55.220961 => 05:59:55.223902
[0m05:59:55.224267 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m05:59:55.236405 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m05:59:55.237399 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m05:59:55.237621 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m05:59:55.237832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:55.537346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:55.539859 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 05:59:54.367730 => 05:59:55.539701
[0m05:59:55.540229 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m05:59:55.684670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdcc6b0>]}
[0m05:59:55.685822 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.33s]
[0m05:59:55.686804 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:59:55.687619 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:59:55.688282 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m05:59:55.689246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m05:59:55.689711 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m05:59:55.693995 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m05:59:55.695880 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 05:59:55.690021 => 05:59:55.695658
[0m05:59:55.696281 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m05:59:55.699605 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m05:59:55.702050 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m05:59:55.702543 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m05:59:55.702951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:56.286766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:56.288294 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 05:59:55.224427 => 05:59:56.288191
[0m05:59:56.288508 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m05:59:56.416947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c6e70>]}
[0m05:59:56.417979 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.20s]
[0m05:59:56.418783 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m05:59:56.419361 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m05:59:56.420030 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m05:59:56.421161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m05:59:56.421646 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m05:59:56.425284 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m05:59:56.426736 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 05:59:56.421941 => 05:59:56.426459
[0m05:59:56.427162 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m05:59:56.429575 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m05:59:56.431110 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m05:59:56.431465 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m05:59:56.431832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:57.028077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:57.032274 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 05:59:55.696539 => 05:59:57.032023
[0m05:59:57.032855 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m05:59:57.192965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f351460>]}
[0m05:59:57.194118 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.50s]
[0m05:59:57.195219 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:59:57.195890 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.196461 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m05:59:57.197411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m05:59:57.197891 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.202037 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.204614 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 05:59:57.198225 => 05:59:57.204397
[0m05:59:57.205002 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.210087 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.211963 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.212408 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m05:59:57.212764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:57.627317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:57.631374 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 05:59:56.427424 => 05:59:57.631115
[0m05:59:57.631984 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m05:59:57.753627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c6c30>]}
[0m05:59:57.754548 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.33s]
[0m05:59:57.755281 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m05:59:57.755720 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.756163 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m05:59:57.756818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m05:59:57.757190 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.760126 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.761435 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 05:59:57.757432 => 05:59:57.761209
[0m05:59:57.761808 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m05:59:57.765416 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.766711 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m05:59:57.767015 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m05:59:57.767311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:58.274999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:58.279603 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 05:59:57.205276 => 05:59:58.279267
[0m05:59:58.280493 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m05:59:58.411278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71335f47-29a8-4de1-83e8-0ed254f9a3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f33c500>]}
[0m05:59:58.411714 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.21s]
[0m05:59:58.412091 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:59:58.413055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:58.413234 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m05:59:58.413420 [info ] [MainThread]: 
[0m05:59:58.413586 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m05:59:58.414014 [debug] [MainThread]: Command end result
[0m05:59:58.418724 [info ] [MainThread]: 
[0m05:59:58.418912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:59:58.419083 [info ] [MainThread]: 
[0m05:59:58.419376 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:59:58.419862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.576288, "process_user_time": 2.413364, "process_kernel_time": 0.114587, "process_mem_max_rss": "217252", "process_out_blocks": "4537", "process_in_blocks": "0"}
[0m05:59:58.420074 [debug] [MainThread]: Command `dbt run` succeeded at 05:59:58.420032 after 8.58 seconds
[0m05:59:58.420255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5626810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54d4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ef4ad0>]}
[0m05:59:58.420466 [debug] [MainThread]: Flushing usage events
[0m05:59:58.690467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:58.694614 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 05:59:57.762047 => 05:59:58.694370
[0m05:59:58.695289 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m05:59:59.423484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4558bc5f-88cd-4d5e-bc32-655d7c993ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84785160>]}
[0m05:59:59.424001 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.67s]
[0m05:59:59.424429 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m05:59:59.425574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:59.425766 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m05:59:59.425971 [info ] [MainThread]: 
[0m05:59:59.426178 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m05:59:59.426670 [debug] [MainThread]: Command end result
[0m05:59:59.432361 [info ] [MainThread]: 
[0m05:59:59.432595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:59:59.432761 [info ] [MainThread]: 
[0m05:59:59.432961 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:59:59.433496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.58991, "process_user_time": 2.397555, "process_kernel_time": 0.106335, "process_mem_max_rss": "217848", "process_out_blocks": "4537", "process_in_blocks": "0"}
[0m05:59:59.433764 [debug] [MainThread]: Command `dbt run` succeeded at 05:59:59.433706 after 9.59 seconds
[0m05:59:59.433963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70567b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6c09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9200a10>]}
[0m05:59:59.434169 [debug] [MainThread]: Flushing usage events
[0m06:00:05.538885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b758ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de3ffb0>]}


============================== 06:00:05.541733 | 1c9eeb9e-2381-4c06-8a40-3e74bf4a7932 ==============================
[0m06:00:05.541733 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:00:05.542171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m06:00:05.923317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff572cd2e0>]}
[0m06:00:05.972088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5687f1d0>]}
[0m06:00:05.972502 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:00:05.975787 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:00:05.999023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:05.999247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:06.001630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba4a330>]}
[0m06:00:06.007638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56480920>]}
[0m06:00:06.007846 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:00:06.008217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c1338f0>]}
[0m06:00:06.009151 [info ] [MainThread]: 
[0m06:00:06.009589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:06.010205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m06:00:06.016179 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:00:06.016384 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:00:06.016553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:06.757707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c639190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8ee270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8efef0>]}


============================== 06:00:06.760292 | b1988127-32c0-41e7-8af0-d35b71a56780 ==============================
[0m06:00:06.760292 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:00:06.760555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:06.956505 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:00:06.957388 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:00:07.112176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff676b2510>]}
[0m06:00:07.159555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c78a990>]}
[0m06:00:07.159855 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:00:07.162870 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:00:07.187397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:07.187576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:07.189662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff717cae70>]}
[0m06:00:07.195005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6730d0d0>]}
[0m06:00:07.195205 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:00:07.195396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67528500>]}
[0m06:00:07.196279 [info ] [MainThread]: 
[0m06:00:07.196623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:07.197230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m06:00:07.202651 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:00:07.202843 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:00:07.203001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:07.347525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m06:00:07.349578 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:00:07.349866 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:00:07.350150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:07.700067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:00:07.701363 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:00:07.863228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:00:07.868232 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:00:07.868828 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:00:07.869299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:08.185475 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:00:08.189013 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:00:08.316296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:00:08.320325 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:00:08.320911 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:00:08.321876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:08.327667 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:08.330286 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:00:08.807102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:00:08.812166 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:00:08.812693 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:00:08.813067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:09.415307 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:00:09.418373 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:00:09.653617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9eeb9e-2381-4c06-8a40-3e74bf4a7932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5654e660>]}
[0m06:00:09.654843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:09.655902 [info ] [MainThread]: 
[0m06:00:09.666934 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.667508 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m06:00:09.668764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m06:00:09.669124 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.682324 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.684877 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 06:00:09.669373 => 06:00:09.684716
[0m06:00:09.685183 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.691266 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:00:09.692346 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:00:09.696954 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.698273 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.698501 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m06:00:09.698710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:09.925641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1988127-32c0-41e7-8af0-d35b71a56780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814f0710>]}
[0m06:00:09.926919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:09.927519 [info ] [MainThread]: 
[0m06:00:09.937954 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.938498 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m06:00:09.939228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m06:00:09.939586 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.954081 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.955240 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 06:00:09.939831 => 06:00:09.955041
[0m06:00:09.955523 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:09.967888 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.968810 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:00:09.969072 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m06:00:09.969302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:11.055360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:11.063660 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 06:00:09.685366 => 06:00:11.063347
[0m06:00:11.064273 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m06:00:11.464693 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.80s]
[0m06:00:11.466049 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:11.466979 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.467615 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m06:00:11.468846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m06:00:11.469306 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.475002 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.477432 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 06:00:11.469600 => 06:00:11.477199
[0m06:00:11.477799 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.480029 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.481645 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.481967 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m06:00:11.482295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:11.626718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:00:11.635153 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 06:00:09.955707 => 06:00:11.634845
[0m06:00:11.635625 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m06:00:11.795677 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.86s]
[0m06:00:11.796845 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:00:11.797542 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.798199 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m06:00:11.799084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m06:00:11.799583 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.806895 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.809588 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 06:00:11.799899 => 06:00:11.809326
[0m06:00:11.810042 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:11.813060 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.814821 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:00:11.815212 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m06:00:11.815568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:12.513759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:12.514854 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 06:00:11.478023 => 06:00:12.514744
[0m06:00:12.515066 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m06:00:12.704296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:12.705646 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 06:00:11.810364 => 06:00:12.705513
[0m06:00:12.705908 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m06:00:12.786124 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 1.32s]
[0m06:00:12.786653 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:12.786872 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.787066 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m06:00:12.787447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m06:00:12.787653 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.790692 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.791487 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 06:00:12.787766 => 06:00:12.791399
[0m06:00:12.791662 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.792789 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.793500 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.793645 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m06:00:12.793798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:12.840007 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 1.04s]
[0m06:00:12.840431 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:00:12.840692 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.840912 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m06:00:12.841293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m06:00:12.841484 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.844633 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.845250 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 06:00:12.841601 => 06:00:12.845164
[0m06:00:12.845428 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:12.846529 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.847103 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:00:12.847288 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m06:00:12.847442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:13.400832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:13.406012 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 06:00:12.845568 => 06:00:13.405761
[0m06:00:13.410321 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m06:00:13.559039 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.72s]
[0m06:00:13.559462 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:13.559695 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.559872 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m06:00:13.560204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m06:00:13.560362 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.562293 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.563245 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 06:00:13.560484 => 06:00:13.563167
[0m06:00:13.563406 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.564420 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.565165 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.565324 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m06:00:13.565470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:13.762275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:13.763343 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 06:00:12.791793 => 06:00:13.763254
[0m06:00:13.763537 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m06:00:13.932923 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 1.15s]
[0m06:00:13.933370 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:00:13.933611 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.933809 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m06:00:13.934224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m06:00:13.934402 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.936332 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.937726 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 06:00:13.934519 => 06:00:13.937643
[0m06:00:13.937904 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:13.939018 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.939673 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:00:13.939837 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m06:00:13.939999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:15.444492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:00:15.446963 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 06:00:13.563507 => 06:00:15.446731
[0m06:00:15.447399 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m06:00:16.685396 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 3.13s]
[0m06:00:16.685987 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:16.686313 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.686628 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m06:00:16.687223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m06:00:16.687484 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.690794 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.692306 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 06:00:16.687671 => 06:00:16.692091
[0m06:00:16.692645 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.695728 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.696917 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.697180 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m06:00:16.697384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:16.796463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m06:00:16.797949 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 06:00:13.938024 => 06:00:16.797781
[0m06:00:16.798297 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m06:00:16.981166 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 3.05s]
[0m06:00:16.982904 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:00:16.983576 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.984118 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m06:00:16.985313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m06:00:16.985738 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.991769 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.993008 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 06:00:16.986015 => 06:00:16.992853
[0m06:00:16.993340 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:16.995362 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.996526 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:00:16.996883 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m06:00:16.997216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:17.710753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:17.714594 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 06:00:16.993558 => 06:00:17.714257
[0m06:00:17.715260 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m06:00:17.836115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:17.839540 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 06:00:16.692920 => 06:00:17.839244
[0m06:00:17.840101 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m06:00:17.901613 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.92s]
[0m06:00:17.903273 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:17.904009 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:17.904551 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m06:00:17.905712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m06:00:17.906328 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:17.911712 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:17.914391 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 06:00:17.906636 => 06:00:17.914073
[0m06:00:17.914840 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:17.917535 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:17.918828 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:17.919196 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m06:00:17.919523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:18.898413 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 2.21s]
[0m06:00:18.899588 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:00:18.900247 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:18.900744 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m06:00:18.901652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m06:00:18.902220 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:18.908222 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:18.910744 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 06:00:18.902606 => 06:00:18.910507
[0m06:00:18.911195 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:18.914535 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:18.916435 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:00:18.916909 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m06:00:18.917307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:19.120273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:19.124066 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 06:00:17.915096 => 06:00:19.123765
[0m06:00:19.124827 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m06:00:19.293425 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 1.39s]
[0m06:00:19.295012 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:19.295720 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.296233 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m06:00:19.297267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m06:00:19.297703 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.303477 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:19.304946 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 06:00:19.297991 => 06:00:19.304744
[0m06:00:19.305315 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.307802 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:19.308937 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:19.309289 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m06:00:19.309600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:19.759795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:19.762416 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 06:00:18.911506 => 06:00:19.762183
[0m06:00:19.762830 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m06:00:19.869170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:19.872773 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 06:00:19.305554 => 06:00:19.872446
[0m06:00:19.873394 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m06:00:19.983993 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 1.08s]
[0m06:00:19.984890 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:00:19.985562 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.986224 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m06:00:19.987033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m06:00:19.987627 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.993444 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:19.994864 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 06:00:19.988345 => 06:00:19.994640
[0m06:00:19.995361 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:19.998894 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:20.000836 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:00:20.001772 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m06:00:20.002213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:20.054871 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.76s]
[0m06:00:20.055648 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:20.055982 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.056292 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m06:00:20.056910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m06:00:20.057199 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.060389 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.061285 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 06:00:20.057379 => 06:00:20.061167
[0m06:00:20.061514 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.063105 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.064216 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.064497 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m06:00:20.064735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:20.495802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:20.498910 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 06:00:19.995708 => 06:00:20.498643
[0m06:00:20.499443 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m06:00:20.638979 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.65s]
[0m06:00:20.640090 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:00:20.640716 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.641219 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m06:00:20.642109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m06:00:20.642627 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.648607 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.650324 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 06:00:20.642939 => 06:00:20.650097
[0m06:00:20.650697 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:20.653806 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.655650 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:00:20.656166 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m06:00:20.656609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:21.304902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:21.308831 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 06:00:20.061683 => 06:00:21.308524
[0m06:00:21.309439 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m06:00:21.476725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:21.478744 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 06:00:20.650938 => 06:00:21.478537
[0m06:00:21.479165 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m06:00:22.215916 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 1.57s]
[0m06:00:22.215931 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 2.16s]
[0m06:00:22.216924 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:22.217076 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:00:22.217381 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.217590 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.217768 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m06:00:22.217984 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m06:00:22.218455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m06:00:22.218814 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.218901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m06:00:22.219264 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.223006 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.223377 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.224224 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 06:00:22.219060 => 06:00:22.223988
[0m06:00:22.224391 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 06:00:22.219494 => 06:00:22.224170
[0m06:00:22.224564 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.224746 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.226731 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.226895 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.229395 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.229439 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:00:22.229735 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m06:00:22.229837 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m06:00:22.230054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:22.230103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:22.705300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:22.709013 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 06:00:22.224965 => 06:00:22.708671
[0m06:00:22.709712 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m06:00:22.859206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:22.862522 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 06:00:22.224779 => 06:00:22.862147
[0m06:00:22.863289 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m06:00:22.938178 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.72s]
[0m06:00:22.939795 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:22.940432 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:22.940991 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m06:00:22.942098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m06:00:22.942615 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:22.950443 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:22.952597 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 06:00:22.942932 => 06:00:22.952177
[0m06:00:22.953126 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:22.956103 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:22.957504 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:22.957975 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m06:00:22.958427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:23.082061 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.86s]
[0m06:00:23.083081 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:00:23.083686 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:23.084129 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m06:00:23.084928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m06:00:23.085326 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:23.090549 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:23.092008 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 06:00:23.085605 => 06:00:23.091794
[0m06:00:23.092375 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:23.096363 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:23.097505 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:00:23.097903 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m06:00:23.098212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:23.587280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:23.590812 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 06:00:22.953427 => 06:00:23.590477
[0m06:00:23.591436 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m06:00:23.701016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:23.704963 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 06:00:23.092626 => 06:00:23.704635
[0m06:00:23.705626 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m06:00:23.797204 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.86s]
[0m06:00:23.798735 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:23.799389 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.799974 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m06:00:23.801055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m06:00:23.801541 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.807850 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.810635 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 06:00:23.801883 => 06:00:23.810245
[0m06:00:23.811166 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.814217 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.815653 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.816072 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m06:00:23.816444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:23.852379 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.77s]
[0m06:00:23.853127 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:00:23.853582 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.854092 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m06:00:23.854917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m06:00:23.855335 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.859444 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.860617 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 06:00:23.855597 => 06:00:23.860439
[0m06:00:23.860918 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:23.862938 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.863982 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:00:23.864295 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m06:00:23.864584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:24.542671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:24.546415 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 06:00:23.861120 => 06:00:24.545903
[0m06:00:24.547164 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m06:00:24.547938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:24.551292 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 06:00:23.811461 => 06:00:24.550940
[0m06:00:24.551877 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m06:00:24.723632 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.87s]
[0m06:00:24.724746 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:24.727201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:24.727679 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m06:00:24.728182 [info ] [MainThread]: 
[0m06:00:24.728694 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 17.53 seconds (17.53s).
[0m06:00:24.730728 [debug] [MainThread]: Command end result
[0m06:00:24.742814 [info ] [MainThread]: 
[0m06:00:24.743326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:24.743732 [info ] [MainThread]: 
[0m06:00:24.744067 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m06:00:24.744891 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.00688, "process_user_time": 2.780457, "process_kernel_time": 0.137269, "process_mem_max_rss": "217072", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m06:00:24.745265 [debug] [MainThread]: Command `dbt test` succeeded at 06:00:24.745181 after 18.01 seconds
[0m06:00:24.745543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbd7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc1fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66625d90>]}
[0m06:00:24.745882 [debug] [MainThread]: Flushing usage events
[0m06:00:24.795128 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.99s]
[0m06:00:24.796225 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:00:24.798138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:24.798464 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m06:00:24.798800 [info ] [MainThread]: 
[0m06:00:24.799270 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 18.79 seconds (18.79s).
[0m06:00:24.800668 [debug] [MainThread]: Command end result
[0m06:00:24.808681 [info ] [MainThread]: 
[0m06:00:24.809015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:24.809204 [info ] [MainThread]: 
[0m06:00:24.809430 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m06:00:24.810028 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.306595, "process_user_time": 2.758628, "process_kernel_time": 0.137031, "process_mem_max_rss": "216788", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m06:00:24.810346 [debug] [MainThread]: Command `dbt test` succeeded at 06:00:24.810278 after 19.31 seconds
[0m06:00:24.810616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56781370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff55704aa0>]}
[0m06:00:24.810845 [debug] [MainThread]: Flushing usage events
[0m06:00:26.938886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48f8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6fe41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ad51f0>]}


============================== 06:00:26.942000 | a39b3f08-e3fe-4d28-84f9-03611d10a435 ==============================
[0m06:00:26.942000 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:00:26.942419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:26.941241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa489ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a7c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa489d820>]}


============================== 06:00:26.944155 | c6c139b4-a2b1-428c-b5c2-1f35075b4c41 ==============================
[0m06:00:26.944155 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:00:26.944470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:27.315649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdb8860>]}
[0m06:00:27.316722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4adcd10>]}
[0m06:00:27.367147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0aa2840>]}
[0m06:00:27.367615 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:00:27.367900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1525d0>]}
[0m06:00:27.368337 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:00:27.371407 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:00:27.372007 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:00:27.402732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:27.402741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:27.402988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:27.403049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:27.405639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7d87a0>]}
[0m06:00:27.405681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7451f0>]}
[0m06:00:27.411598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5c0b60>]}
[0m06:00:27.411668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f424a10>]}
[0m06:00:27.411875 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:00:27.411940 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:00:27.412126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5df6e0>]}
[0m06:00:27.412345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f9fb30>]}
[0m06:00:27.413071 [info ] [MainThread]: 
[0m06:00:27.413222 [info ] [MainThread]: 
[0m06:00:27.413466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:27.413709 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:27.414048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:00:27.414296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:00:27.422082 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:00:27.422331 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:00:27.422333 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:00:27.422522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:27.422574 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:00:27.422812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:27.911778 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m06:00:27.913638 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:00:27.959474 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:00:27.961699 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:00:28.107126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m06:00:28.114349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m06:00:28.117979 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:00:28.118604 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:00:28.119059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:28.124148 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:00:28.124641 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:00:28.124971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:28.643845 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:00:28.646442 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:00:28.655495 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:00:28.657740 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:00:28.793046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:00:28.799387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:00:28.800100 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:00:28.800583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:28.845642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:00:28.849848 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:00:28.850077 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:00:28.850248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:29.243921 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:00:29.247221 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:00:29.304250 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:00:29.307138 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:00:29.435225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m06:00:29.439734 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:00:29.440337 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:00:29.440841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:29.492055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m06:00:29.494310 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:00:29.494525 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:00:29.494704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:29.861776 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:00:29.864878 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:00:29.956334 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:00:29.959033 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:00:30.053576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f692e70>]}
[0m06:00:30.055021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:30.055636 [info ] [MainThread]: 
[0m06:00:30.066959 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.067894 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:00:30.068973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:00:30.069440 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.076948 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:00:30.069767 => 06:00:30.076740
[0m06:00:30.077377 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.088361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f95e540>]}
[0m06:00:30.088975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:30.089431 [info ] [MainThread]: 
[0m06:00:30.095261 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.095623 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:00:30.096121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:00:30.096344 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.100681 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:00:30.096497 => 06:00:30.100545
[0m06:00:30.100906 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:30.111496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:30.111782 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:00:30.111980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:30.126846 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:30.127092 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:00:30.127270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:30.521073 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:00:30.528190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:30.528632 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:30.760110 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:30.769728 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:30.770423 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:31.228858 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m06:00:31.240730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:31.241462 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:31.350772 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:31.359243 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:31.359792 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:31.471340 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:31.500200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:31.500685 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:00:31.672709 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:00:31.698980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:31.699491 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:00:33.481354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:00:33.486102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:33.486828 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:33.992788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:00:33.997610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:33.998279 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:34.126345 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m06:00:34.131375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.131970 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:34.263742 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:34.265960 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:00:34.268940 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.269512 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:34.270761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.271295 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:34.363314 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:34.368927 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.369618 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:34.403859 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:00:34.411644 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.412320 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:34.471152 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:00:34.478325 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.479009 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:00:34.494179 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:34.502171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.502682 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:34.561497 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:00:34.568327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.568712 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:00:34.589231 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:00:34.596500 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.599443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.599752 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:00:34.681465 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:00:34.686315 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.687478 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.687710 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:00:34.773883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:34.774375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.774772 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:00:34.903600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:34.904254 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:00:34.904579 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:00:35.532676 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d748-0307-327f-000f-c0df00ae851a
[0m06:00:35.533491 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m06:00:35.534396 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:00:30.101046 => 06:00:35.534085
[0m06:00:35.534988 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:00:35.722391 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m06:00:35.723348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a39b3f08-e3fe-4d28-84f9-03611d10a435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f304c80>]}
[0m06:00:35.724505 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 5.63s]
[0m06:00:35.725753 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:35.728777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:35.729283 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:00:35.729723 [info ] [MainThread]: 
[0m06:00:35.730417 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m06:00:35.731166 [debug] [MainThread]: Command end result
[0m06:00:35.740594 [info ] [MainThread]: 
[0m06:00:35.741055 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:00:35.741300 [info ] [MainThread]: 
[0m06:00:35.741589 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m06:00:35.741856 [info ] [MainThread]: 
[0m06:00:35.742097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:00:35.742893 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.825533, "process_user_time": 2.213377, "process_kernel_time": 0.10977, "process_mem_max_rss": "218496", "process_out_blocks": "1864", "command_success": false, "process_in_blocks": "0"}
[0m06:00:35.743248 [debug] [MainThread]: Command `dbt snapshot` failed at 06:00:35.743176 after 8.83 seconds
[0m06:00:35.743572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a889b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49d5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f9fb30>]}
[0m06:00:35.743925 [debug] [MainThread]: Flushing usage events
[0m06:00:36.005462 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0d748-0307-3208-000f-c0df00ae65ea
[0m06:00:36.006284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m06:00:36.007090 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:00:30.077624 => 06:00:36.006803
[0m06:00:36.007653 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:00:36.149659 [debug] [Thread-1 (]: Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m06:00:36.150651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c139b4-a2b1-428c-b5c2-1f35075b4c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9e4260>]}
[0m06:00:36.151809 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.eia_rto_hourly_snapshot ..................... [[31mERROR[0m in 6.08s]
[0m06:00:36.152769 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:00:36.155922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:36.156369 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:00:36.156798 [info ] [MainThread]: 
[0m06:00:36.157217 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m06:00:36.157923 [debug] [MainThread]: Command end result
[0m06:00:36.170243 [info ] [MainThread]: 
[0m06:00:36.171026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:00:36.171385 [info ] [MainThread]: 
[0m06:00:36.171725 [error] [MainThread]:   Database Error in snapshot eia_rto_hourly_snapshot (snapshots/electricity.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/energy_consumption_analytics/snapshots/electricity.sql
[0m06:00:36.172126 [info ] [MainThread]: 
[0m06:00:36.172518 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:00:36.173525 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 9.25379, "process_user_time": 2.282135, "process_kernel_time": 0.094797, "process_mem_max_rss": "219148", "process_out_blocks": "1864", "command_success": false, "process_in_blocks": "0"}
[0m06:00:36.173980 [debug] [MainThread]: Command `dbt snapshot` failed at 06:00:36.173887 after 9.25 seconds
[0m06:00:36.174336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a7c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7aa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a190ce0>]}
[0m06:00:36.174689 [debug] [MainThread]: Flushing usage events
[0m06:07:32.072712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86529340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865284d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86529850>]}


============================== 06:07:32.075763 | 3295c5bb-ec9d-485a-82b3-4120775c4b81 ==============================
[0m06:07:32.075763 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:07:32.076203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:32.428543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff662a29c0>]}
[0m06:07:32.479466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807005c0>]}
[0m06:07:32.479862 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:07:32.483166 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:07:32.514968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:07:32.515220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:07:32.517941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653704d0>]}
[0m06:07:32.525276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6523d0d0>]}
[0m06:07:32.525614 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:07:32.526017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653a03e0>]}
[0m06:07:32.526957 [info ] [MainThread]: 
[0m06:07:32.527505 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:32.528137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:07:32.534231 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:07:32.534535 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:07:32.534749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:33.277396 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:07:33.279516 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:07:33.433065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m06:07:33.443513 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:07:33.444180 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:07:33.444693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:33.951206 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:07:33.954039 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:07:34.116316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:07:34.122143 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:07:34.122818 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:07:34.123272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:34.692420 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:07:34.695451 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:07:35.355963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m06:07:35.360541 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:07:35.361227 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:07:35.361734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:36.021101 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:07:36.022359 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:07:36.161383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff653a07d0>]}
[0m06:07:36.162248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:07:36.163063 [info ] [MainThread]: 
[0m06:07:36.170203 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:07:36.170603 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:07:36.171252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:07:36.171504 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:07:36.176396 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:07:36.171679 => 06:07:36.176260
[0m06:07:36.176645 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:07:36.207833 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:07:36.209169 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:07:36.209368 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace transient table USER_DB_MONKEY.snapshot.eia_rto_hourly_snapshot
         as
        (

    select *,
        md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

    ) sbq



        );
[0m06:07:36.209550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:38.345913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:07:38.371339 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:07:36.176821 => 06:07:38.371121
[0m06:07:38.371813 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:07:38.519954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3295c5bb-ec9d-485a-82b3-4120775c4b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f10dd0>]}
[0m06:07:38.521250 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 1[0m in 2.35s]
[0m06:07:38.522146 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:07:38.524585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:38.525259 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:07:38.525746 [info ] [MainThread]: 
[0m06:07:38.526565 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m06:07:38.527345 [debug] [MainThread]: Command end result
[0m06:07:38.536902 [info ] [MainThread]: 
[0m06:07:38.537506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:38.537774 [info ] [MainThread]: 
[0m06:07:38.538154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:07:38.538941 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.488567, "process_user_time": 2.486854, "process_kernel_time": 0.136991, "process_mem_max_rss": "217528", "process_out_blocks": "1844", "process_in_blocks": "0"}
[0m06:07:38.539285 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:07:38.539208 after 6.49 seconds
[0m06:07:38.539544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86675430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87449280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652b8710>]}
[0m06:07:38.539795 [debug] [MainThread]: Flushing usage events
[0m06:08:40.630352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67a9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e8fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab914cb0>]}


============================== 06:08:40.633521 | 4d5845c6-9a58-4f40-92b3-81eb521e4c98 ==============================
[0m06:08:40.633521 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:08:40.634152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m06:08:40.997531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854ef560>]}
[0m06:08:41.045767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba0c20>]}
[0m06:08:41.046182 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:08:41.049982 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:08:41.076308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:41.076501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:41.078688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67a2a50>]}
[0m06:08:41.084207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852d0a70>]}
[0m06:08:41.084396 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:08:41.084767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86068bf0>]}
[0m06:08:41.085528 [info ] [MainThread]: 
[0m06:08:41.085885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:08:41.086424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:08:41.091440 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:08:41.091603 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:08:41.091756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:41.619276 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:08:41.620517 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:08:41.751361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m06:08:41.761229 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:08:41.761791 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:08:41.762139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:42.241076 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:08:42.243919 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:08:42.389036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:08:42.393227 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:08:42.393776 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:08:42.394671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:42.784668 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:08:42.787892 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:08:42.914970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:08:42.921545 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:08:42.922560 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:08:42.923309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:44.331847 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:08:44.334623 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:08:44.471547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d11160>]}
[0m06:08:44.472890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:08:44.473513 [info ] [MainThread]: 
[0m06:08:44.485811 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:08:44.487460 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:08:44.488642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:08:44.489244 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:08:44.496257 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:08:44.489561 => 06:08:44.496055
[0m06:08:44.496660 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:08:44.528767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:44.529009 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:08:44.529206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:44.948572 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:08:44.960813 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:44.961511 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:08:45.076938 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:08:45.084000 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:45.084414 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:08:45.181750 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:08:45.193282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:45.193539 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:08:46.136754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:08:46.139690 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.140075 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:08:46.263973 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:08:46.265965 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.266190 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:08:46.370372 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:08:46.372034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.372276 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:08:46.468316 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:08:46.470782 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.470979 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:08:46.566040 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:08:46.571287 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.571634 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:08:46.650276 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:08:46.659834 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.663072 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.663569 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:08:46.790147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:08:46.791259 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:46.791937 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:08:47.606238 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m06:08:47.606580 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:08:47.606766 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m06:08:47.977093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:08:47.986020 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:08:44.496882 => 06:08:47.985933
[0m06:08:47.986249 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:08:48.109931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d5845c6-9a58-4f40-92b3-81eb521e4c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84749b20>]}
[0m06:08:48.110398 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 3.62s]
[0m06:08:48.110916 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:08:48.111814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:48.112005 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:08:48.112158 [info ] [MainThread]: 
[0m06:08:48.112451 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m06:08:48.112785 [debug] [MainThread]: Command end result
[0m06:08:48.117077 [info ] [MainThread]: 
[0m06:08:48.117337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:48.117481 [info ] [MainThread]: 
[0m06:08:48.117629 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:08:48.118066 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.5093517, "process_user_time": 2.634792, "process_kernel_time": 0.179897, "process_mem_max_rss": "217892", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m06:08:48.118273 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:08:48.118229 after 7.51 seconds
[0m06:08:48.118423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e8fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d8e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85282ff0>]}
[0m06:08:48.118570 [debug] [MainThread]: Flushing usage events
[0m06:28:56.174486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9baa1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c02b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c344bf0>]}


============================== 06:28:56.177507 | fea4e0e9-11a8-4790-84c3-73ef971390a1 ==============================
[0m06:28:56.177507 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:28:56.177967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:28:56.535278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ca2390>]}
[0m06:28:56.580956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bed880>]}
[0m06:28:56.581318 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:28:56.584425 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:28:56.611802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:28:56.611985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:28:56.614162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767b84a0>]}
[0m06:28:56.619948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7676dc70>]}
[0m06:28:56.620138 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:28:56.620431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7680e930>]}
[0m06:28:56.621235 [info ] [MainThread]: 
[0m06:28:56.621635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:28:56.622238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:28:56.627028 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:28:56.627186 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:28:56.627303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:57.166228 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:28:57.169081 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:28:57.325714 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:28:57.326605 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:28:57.327167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:57.866706 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:28:57.870410 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:28:58.016585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m06:28:58.021866 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:28:58.022093 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:28:58.022292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:58.454680 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:28:58.457543 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:28:58.585477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:28:58.591179 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:28:58.591668 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:28:58.592241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:59.127939 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:28:59.130597 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:28:59.307257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m06:28:59.311380 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:28:59.311982 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:28:59.312374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:59.699149 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:28:59.702263 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:28:59.849583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77138350>]}
[0m06:28:59.851163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:28:59.852553 [info ] [MainThread]: 
[0m06:28:59.865161 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m06:28:59.865858 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m06:28:59.866822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m06:28:59.867159 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m06:28:59.873402 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m06:28:59.875255 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 06:28:59.867372 => 06:28:59.875048
[0m06:28:59.875566 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m06:28:59.892241 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m06:28:59.893440 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m06:28:59.893657 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m06:28:59.893881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:01.751209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:29:01.769864 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 06:28:59.875767 => 06:29:01.769735
[0m06:29:01.770206 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m06:29:01.901244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75bd9910>]}
[0m06:29:01.902236 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 2.03s]
[0m06:29:01.902998 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m06:29:01.903935 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m06:29:01.904301 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m06:29:01.904906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m06:29:01.905191 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m06:29:01.907153 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m06:29:01.909231 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 06:29:01.905361 => 06:29:01.909027
[0m06:29:01.909535 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m06:29:01.921201 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m06:29:01.922935 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m06:29:01.923222 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m06:29:01.923477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:03.285751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:03.290093 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 06:29:01.909703 => 06:29:03.289764
[0m06:29:03.290830 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m06:29:03.420609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75bf3140>]}
[0m06:29:03.421773 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.52s]
[0m06:29:03.423143 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m06:29:03.423704 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m06:29:03.424286 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m06:29:03.425430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m06:29:03.426089 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m06:29:03.430353 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m06:29:03.431939 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 06:29:03.426492 => 06:29:03.431740
[0m06:29:03.432271 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m06:29:03.435457 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m06:29:03.437724 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m06:29:03.438204 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m06:29:03.438663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:04.575205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:04.579268 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 06:29:03.432503 => 06:29:04.579004
[0m06:29:04.579915 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m06:29:04.707016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75a5a630>]}
[0m06:29:04.708249 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.28s]
[0m06:29:04.709730 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m06:29:04.710421 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m06:29:04.711043 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m06:29:04.712290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m06:29:04.712785 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m06:29:04.717312 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:29:04.719417 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 06:29:04.713124 => 06:29:04.719190
[0m06:29:04.719827 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m06:29:04.724685 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:29:04.726626 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m06:29:04.727063 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m06:29:04.727507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:06.357180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:29:06.361136 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 06:29:04.720109 => 06:29:06.360884
[0m06:29:06.361707 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m06:29:06.848797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea4e0e9-11a8-4790-84c3-73ef971390a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75a87860>]}
[0m06:29:06.849995 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 2.14s]
[0m06:29:06.851527 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m06:29:06.854188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:06.854727 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m06:29:06.855320 [info ] [MainThread]: 
[0m06:29:06.856175 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m06:29:06.857414 [debug] [MainThread]: Command end result
[0m06:29:06.870707 [info ] [MainThread]: 
[0m06:29:06.871403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:06.871680 [info ] [MainThread]: 
[0m06:29:06.872114 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:29:06.873421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.719192, "process_user_time": 2.701492, "process_kernel_time": 0.147888, "process_mem_max_rss": "217256", "process_out_blocks": "4561", "process_in_blocks": "0"}
[0m06:29:06.873914 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:06.873800 after 10.72 seconds
[0m06:29:06.874291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c053ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d1f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4c4560>]}
[0m06:29:06.874595 [debug] [MainThread]: Flushing usage events
[0m06:29:12.247757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f6a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15009b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa113d970>]}


============================== 06:29:12.250482 | fc46c488-5930-4861-92ad-580682905171 ==============================
[0m06:29:12.250482 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:29:12.250906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:29:12.598176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c6ed20>]}
[0m06:29:12.644114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80125940>]}
[0m06:29:12.644406 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:29:12.647418 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:29:12.670865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:12.671030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:12.673174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802108f0>]}
[0m06:29:12.678176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc4c980>]}
[0m06:29:12.678366 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:29:12.678662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8046eea0>]}
[0m06:29:12.679481 [info ] [MainThread]: 
[0m06:29:12.679885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:29:12.680460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_snapshot'
[0m06:29:12.685820 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:29:12.685982 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:29:12.686130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:13.283545 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:29:13.285331 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:29:13.430715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:29:13.435288 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:29:13.435897 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:29:13.436362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:13.828111 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:29:13.829919 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:29:13.976549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:29:13.981877 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:29:13.982441 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:29:13.982942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:14.441291 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:29:14.445821 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:29:14.568390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc46c488-5930-4861-92ad-580682905171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2399490>]}
[0m06:29:14.569669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:29:14.570691 [info ] [MainThread]: 
[0m06:29:14.581339 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:29:14.582005 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m06:29:14.583164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m06:29:14.583603 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:29:14.598726 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:29:14.601262 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 06:29:14.583935 => 06:29:14.601107
[0m06:29:14.601541 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:29:14.613713 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:29:14.614921 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:29:14.615149 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m06:29:14.615350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:15.149632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:15.159103 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 06:29:14.601735 => 06:29:15.158677
[0m06:29:15.159798 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m06:29:15.885279 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 1.30s]
[0m06:29:15.885788 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:29:15.886074 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:29:15.886284 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m06:29:15.886664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m06:29:15.886914 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:29:15.889232 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:29:15.890120 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 06:29:15.887036 => 06:29:15.890038
[0m06:29:15.890282 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:29:15.891298 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:29:15.892175 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:29:15.892342 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m06:29:15.892509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:17.386348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:17.389767 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 06:29:15.890387 => 06:29:17.389451
[0m06:29:17.390386 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m06:29:17.526251 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 1.64s]
[0m06:29:17.527050 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:29:17.527445 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:29:17.527910 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m06:29:17.528882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m06:29:17.529226 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:29:17.535110 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:29:17.536460 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 06:29:17.529444 => 06:29:17.536314
[0m06:29:17.536716 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:29:17.538633 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:29:17.539565 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:29:17.539896 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m06:29:17.540145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:18.086179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:18.088417 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 06:29:17.536939 => 06:29:18.088178
[0m06:29:18.088798 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m06:29:18.256257 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.73s]
[0m06:29:18.257907 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:29:18.258626 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:29:18.259259 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m06:29:18.260690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m06:29:18.261298 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:29:18.266980 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:29:18.269319 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 06:29:18.261618 => 06:29:18.268915
[0m06:29:18.269791 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:29:18.272813 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:29:18.274345 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:29:18.274768 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m06:29:18.275143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:18.659111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:18.662815 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 06:29:18.270100 => 06:29:18.662515
[0m06:29:18.663444 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m06:29:18.809679 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.55s]
[0m06:29:18.811334 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:29:18.812044 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:29:18.812577 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m06:29:18.813687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m06:29:18.814179 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:29:18.820371 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:29:18.822236 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 06:29:18.814490 => 06:29:18.822013
[0m06:29:18.822602 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:29:18.827914 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:29:18.829732 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:29:18.830154 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m06:29:18.830517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:19.333413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:19.337002 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 06:29:18.822831 => 06:29:19.336665
[0m06:29:19.337613 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m06:29:19.505240 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.69s]
[0m06:29:19.506722 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:29:19.507332 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:29:19.507928 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m06:29:19.509106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m06:29:19.509739 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:29:19.515482 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:29:19.517555 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 06:29:19.510108 => 06:29:19.517236
[0m06:29:19.518101 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:29:19.521148 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:29:19.522577 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:29:19.522993 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m06:29:19.523393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:20.083699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:20.087598 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 06:29:19.518404 => 06:29:20.087262
[0m06:29:20.088239 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m06:29:20.269681 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.76s]
[0m06:29:20.271292 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:29:20.271985 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:29:20.272530 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m06:29:20.273450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m06:29:20.273937 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:29:20.279890 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:29:20.282352 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 06:29:20.274265 => 06:29:20.282164
[0m06:29:20.282733 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:29:20.285999 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:29:20.287752 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:29:20.288206 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m06:29:20.288568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:20.667779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:20.671245 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 06:29:20.283006 => 06:29:20.670948
[0m06:29:20.671825 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m06:29:20.795740 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.52s]
[0m06:29:20.797211 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:29:20.797986 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:29:20.798504 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m06:29:20.799612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m06:29:20.800139 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:29:20.806062 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:29:20.807735 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 06:29:20.800524 => 06:29:20.807520
[0m06:29:20.808116 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:29:20.811469 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:29:20.813373 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:29:20.813830 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m06:29:20.814307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:21.183980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:21.187798 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 06:29:20.808368 => 06:29:21.187496
[0m06:29:21.188417 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m06:29:21.371428 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.57s]
[0m06:29:21.372983 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:29:21.373617 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:29:21.374148 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m06:29:21.375267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m06:29:21.375816 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:29:21.381704 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:29:21.383720 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 06:29:21.376217 => 06:29:21.383480
[0m06:29:21.384198 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:29:21.387548 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:29:21.389769 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:29:21.390259 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m06:29:21.390664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:21.873542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:21.877188 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 06:29:21.384461 => 06:29:21.876860
[0m06:29:21.877824 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m06:29:22.049157 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.67s]
[0m06:29:22.050595 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:29:22.051286 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:29:22.051774 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m06:29:22.052795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m06:29:22.053239 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:29:22.058811 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:29:22.060234 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 06:29:22.053516 => 06:29:22.059979
[0m06:29:22.060652 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:29:22.065071 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:29:22.066191 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:29:22.066509 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m06:29:22.066814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:22.493284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:22.497001 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 06:29:22.060908 => 06:29:22.496661
[0m06:29:22.497630 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m06:29:22.632402 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.58s]
[0m06:29:22.634033 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:29:22.634825 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:29:22.635548 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m06:29:22.636817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m06:29:22.637364 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:29:22.643285 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:29:22.645156 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 06:29:22.637704 => 06:29:22.644879
[0m06:29:22.645643 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:29:22.648640 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:29:22.650219 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:29:22.650624 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m06:29:22.650970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:23.104648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:23.108050 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 06:29:22.645942 => 06:29:23.107724
[0m06:29:23.108701 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m06:29:23.236212 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.60s]
[0m06:29:23.237814 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:29:23.240350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:23.240874 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m06:29:23.241352 [info ] [MainThread]: 
[0m06:29:23.242152 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m06:29:23.244467 [debug] [MainThread]: Command end result
[0m06:29:23.256285 [info ] [MainThread]: 
[0m06:29:23.257074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:23.257516 [info ] [MainThread]: 
[0m06:29:23.258059 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m06:29:23.258994 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.032476, "process_user_time": 2.919465, "process_kernel_time": 0.133386, "process_mem_max_rss": "217236", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m06:29:23.259460 [debug] [MainThread]: Command `dbt test` succeeded at 06:29:23.259358 after 11.03 seconds
[0m06:29:23.259832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf8ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1144590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11469f0>]}
[0m06:29:23.260128 [debug] [MainThread]: Flushing usage events
[0m06:29:26.293977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81626240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8251db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81732a50>]}


============================== 06:29:26.296612 | 2247d961-fd7a-44dc-9a3d-bae7ddebaef1 ==============================
[0m06:29:26.296612 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:29:26.297022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:26.640812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60542ba0>]}
[0m06:29:26.689056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81638f50>]}
[0m06:29:26.689400 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:29:26.692663 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:29:26.716728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:26.716918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:26.719128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603b91f0>]}
[0m06:29:26.724253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60358a40>]}
[0m06:29:26.724453 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:29:26.724763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff604aade0>]}
[0m06:29:26.725529 [info ] [MainThread]: 
[0m06:29:26.725951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:29:26.726466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:29:26.731353 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:29:26.731527 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:29:26.731682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:27.288986 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:29:27.290554 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:29:27.423249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics_staging)
[0m06:29:27.433907 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:29:27.434541 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:29:27.434937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:27.879016 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:29:27.881827 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:29:28.043389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_snapshot)
[0m06:29:28.045153 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:29:28.045414 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:29:28.045896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:28.538262 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:29:28.541194 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:29:28.692415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:29:28.696866 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:29:28.697408 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:29:28.697834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:29.227704 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:29:29.230490 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:29:29.379684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60427740>]}
[0m06:29:29.381051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:29:29.382113 [info ] [MainThread]: 
[0m06:29:29.392515 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:29:29.393283 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:29:29.396483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:29:29.396966 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:29:29.403754 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:29:29.397243 => 06:29:29.403538
[0m06:29:29.404096 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:29:29.436633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:29.436888 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:29:29.437136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:29.841500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:29:29.852920 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:29.853671 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:29:30.048171 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:29:30.055687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:30.056172 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:29:30.155253 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:29:30.183162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:30.183614 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:29:31.549712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:29:31.554638 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:31.555342 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:29:31.684361 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:29:31.690049 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:31.690666 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:29:31.795489 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:29:31.801105 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:31.801918 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:29:31.951379 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:29:31.959092 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:31.960100 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:29:32.649277 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:29:32.654954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:32.655501 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:29:32.730175 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:29:32.733654 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:32.734974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:32.735147 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:29:32.841854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:32.842301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:32.842666 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:29:33.901732 [debug] [Thread-1 (]: SQL status: SUCCESS 6530 in 1.0 seconds
[0m06:29:33.902120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:29:33.902366 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m06:29:34.290046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:29:34.308353 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:29:29.404320 => 06:29:34.308199
[0m06:29:34.308672 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:29:34.467103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2247d961-fd7a-44dc-9a3d-bae7ddebaef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60095f40>]}
[0m06:29:34.468575 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 6530[0m in 5.07s]
[0m06:29:34.470087 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:29:34.472546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:34.473067 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:29:34.473588 [info ] [MainThread]: 
[0m06:29:34.474314 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m06:29:34.475223 [debug] [MainThread]: Command end result
[0m06:29:34.486970 [info ] [MainThread]: 
[0m06:29:34.487621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:34.487942 [info ] [MainThread]: 
[0m06:29:34.488282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:29:34.489100 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.215119, "process_user_time": 2.586231, "process_kernel_time": 0.100892, "process_mem_max_rss": "217264", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m06:29:34.489555 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:29:34.489447 after 8.22 seconds
[0m06:29:34.489949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8251db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84241700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff604a8200>]}
[0m06:29:34.490371 [debug] [MainThread]: Flushing usage events
[0m06:50:12.349888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa27740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb78b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa26ea0>]}


============================== 06:50:12.352921 | b2dca87b-3973-456d-a058-ef9fbf7aeb3b ==============================
[0m06:50:12.352921 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:50:12.353190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m06:50:12.700011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a752fc0>]}
[0m06:50:12.747080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adba300>]}
[0m06:50:12.747375 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:50:12.750447 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:50:12.778810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:12.778976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:12.781079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afa64e0>]}
[0m06:50:12.786848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6d10d0>]}
[0m06:50:12.787066 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:50:12.787236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8ed160>]}
[0m06:50:12.788004 [info ] [MainThread]: 
[0m06:50:12.788348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:50:12.788903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:50:12.793722 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:50:12.793881 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:50:12.793996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:13.434154 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:50:13.436262 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:50:13.584355 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:50:13.585142 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:50:13.585658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:14.038359 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m06:50:14.041072 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:50:14.178586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m06:50:14.188998 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:50:14.189554 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:50:14.189951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:14.680391 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:50:14.683370 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:50:14.834735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:50:14.838607 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:50:14.839133 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:50:14.841745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:15.296523 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:15.298136 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:50:15.472505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:50:15.477937 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:50:15.478510 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:50:15.479033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:15.985958 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:50:15.988688 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:50:16.555570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a506030>]}
[0m06:50:16.556958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:50:16.557542 [info ] [MainThread]: 
[0m06:50:16.568580 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m06:50:16.569392 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m06:50:16.570327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m06:50:16.570778 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m06:50:16.577866 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m06:50:16.579957 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 06:50:16.571122 => 06:50:16.579763
[0m06:50:16.580278 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m06:50:16.598279 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m06:50:16.599266 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m06:50:16.599499 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m06:50:16.599713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:17.270764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:17.294365 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 06:50:16.580503 => 06:50:17.294185
[0m06:50:17.294761 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m06:50:17.493979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a522f00>]}
[0m06:50:17.495256 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m06:50:17.496244 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m06:50:17.497609 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m06:50:17.498213 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m06:50:17.499152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m06:50:17.499617 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m06:50:17.503905 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m06:50:17.505818 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 06:50:17.499965 => 06:50:17.505555
[0m06:50:17.506180 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m06:50:17.524008 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m06:50:17.525565 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m06:50:17.525865 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m06:50:17.526141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:19.215919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:50:19.219835 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 06:50:17.506422 => 06:50:19.219595
[0m06:50:19.220395 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m06:50:19.411286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79bdf110>]}
[0m06:50:19.412449 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.91s]
[0m06:50:19.413351 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m06:50:19.414602 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m06:50:19.415205 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m06:50:19.416095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m06:50:19.416561 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m06:50:19.420864 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m06:50:19.422506 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 06:50:19.416914 => 06:50:19.422318
[0m06:50:19.422877 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m06:50:19.426166 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m06:50:19.428530 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m06:50:19.429005 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m06:50:19.429527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:20.957130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:50:20.961749 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 06:50:19.423117 => 06:50:20.961495
[0m06:50:20.962630 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m06:50:21.469992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a10590>]}
[0m06:50:21.471361 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 2.05s]
[0m06:50:21.472372 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m06:50:21.473049 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m06:50:21.473602 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m06:50:21.474572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m06:50:21.475161 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m06:50:21.480181 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:50:21.482636 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 06:50:21.475502 => 06:50:21.482443
[0m06:50:21.482989 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m06:50:21.486376 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:50:21.488584 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m06:50:21.489021 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (6, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m06:50:21.489447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:22.693155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:22.697694 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 06:50:21.483227 => 06:50:22.697424
[0m06:50:22.698416 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m06:50:22.846336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2dca87b-3973-456d-a058-ef9fbf7aeb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a175f0>]}
[0m06:50:22.847484 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 1.37s]
[0m06:50:22.848487 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m06:50:22.851403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:50:22.852061 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m06:50:22.852708 [info ] [MainThread]: 
[0m06:50:22.853264 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m06:50:22.854516 [debug] [MainThread]: Command end result
[0m06:50:22.867691 [info ] [MainThread]: 
[0m06:50:22.868227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:50:22.868573 [info ] [MainThread]: 
[0m06:50:22.869007 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:50:22.870256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.541714, "process_user_time": 2.706102, "process_kernel_time": 0.119954, "process_mem_max_rss": "216840", "process_out_blocks": "1881", "process_in_blocks": "0"}
[0m06:50:22.870748 [debug] [MainThread]: Command `dbt run` succeeded at 06:50:22.870637 after 10.54 seconds
[0m06:50:22.871111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa485a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d16a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a100b0>]}
[0m06:50:22.871427 [debug] [MainThread]: Flushing usage events
[0m06:50:28.890125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74740b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7764fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7766390>]}


============================== 06:50:28.892806 | 0430e5a6-5bd4-460d-88d6-1b877dc84b7c ==============================
[0m06:50:28.892806 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:50:28.893285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'send_anonymous_usage_stats': 'True'}
[0m06:50:29.245006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2fac90>]}
[0m06:50:29.293481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7764fb0>]}
[0m06:50:29.293810 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:50:29.296978 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:50:29.320299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:29.320460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:29.322604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7474470>]}
[0m06:50:29.328817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92168e00>]}
[0m06:50:29.329011 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:50:29.329306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92631940>]}
[0m06:50:29.330163 [info ] [MainThread]: 
[0m06:50:29.330614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:50:29.331205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m06:50:29.336754 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:50:29.336968 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:50:29.337155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:29.861046 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:50:29.862972 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:50:30.041327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m06:50:30.044193 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:50:30.044518 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:50:30.044787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:30.459074 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:30.462076 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:50:30.602523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:50:30.607041 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:50:30.607659 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:50:30.608144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:31.090924 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:50:31.093473 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:50:31.249050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0430e5a6-5bd4-460d-88d6-1b877dc84b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921eba10>]}
[0m06:50:31.250256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:50:31.251016 [info ] [MainThread]: 
[0m06:50:31.259851 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:50:31.260284 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m06:50:31.261082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m06:50:31.261506 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:50:31.273879 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:50:31.275769 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 06:50:31.261721 => 06:50:31.275633
[0m06:50:31.276010 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:50:31.287282 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:50:31.288484 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:50:31.288736 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m06:50:31.288959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:31.767577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:31.778671 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 06:50:31.276185 => 06:50:31.778241
[0m06:50:31.779317 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m06:50:31.899459 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.64s]
[0m06:50:31.900879 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:50:31.901732 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:50:31.902366 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m06:50:31.904026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m06:50:31.904715 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:50:31.912853 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:50:31.914480 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 06:50:31.905134 => 06:50:31.914256
[0m06:50:31.914908 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:50:31.917821 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:50:31.919541 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:50:31.919954 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m06:50:31.920323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:32.620240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:32.624032 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 06:50:31.915202 => 06:50:32.623722
[0m06:50:32.624662 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m06:50:32.774783 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.87s]
[0m06:50:32.776465 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:50:32.777270 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:50:32.777834 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m06:50:32.779060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m06:50:32.779576 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:50:32.788257 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:50:32.790775 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 06:50:32.779874 => 06:50:32.790469
[0m06:50:32.791275 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:50:32.794075 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:50:32.795389 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:50:32.795738 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m06:50:32.796073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:33.227292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:33.231470 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 06:50:32.791574 => 06:50:33.231148
[0m06:50:33.232050 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m06:50:33.404424 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.63s]
[0m06:50:33.405874 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:50:33.406539 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:50:33.407142 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m06:50:33.408328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m06:50:33.408896 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:50:33.414890 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:50:33.417688 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 06:50:33.409363 => 06:50:33.417381
[0m06:50:33.418203 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:50:33.421017 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:50:33.422451 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:50:33.422868 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m06:50:33.423231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:34.369520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:34.373060 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 06:50:33.418503 => 06:50:34.372709
[0m06:50:34.373702 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m06:50:34.521866 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 1.11s]
[0m06:50:34.523322 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:50:34.523814 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:50:34.524225 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m06:50:34.525211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m06:50:34.525928 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:50:34.532482 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:50:34.534011 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 06:50:34.526356 => 06:50:34.533804
[0m06:50:34.534398 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:50:34.536515 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:50:34.537878 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:50:34.538208 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m06:50:34.538507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:35.082368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:35.084875 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 06:50:34.534636 => 06:50:35.084657
[0m06:50:35.085308 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m06:50:35.225429 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.70s]
[0m06:50:35.227060 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:50:35.227802 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:50:35.228376 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m06:50:35.229551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m06:50:35.230035 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:50:35.235959 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:50:35.237734 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 06:50:35.230376 => 06:50:35.237521
[0m06:50:35.238124 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:50:35.241365 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:50:35.243061 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:50:35.243455 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m06:50:35.243803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:35.728334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:35.732008 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 06:50:35.238377 => 06:50:35.731707
[0m06:50:35.732762 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m06:50:35.865050 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 0.64s]
[0m06:50:35.866485 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:50:35.867152 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:50:35.867836 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m06:50:35.869425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m06:50:35.870126 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:50:35.876200 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:50:35.878016 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 06:50:35.870501 => 06:50:35.877789
[0m06:50:35.878567 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:50:35.881676 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:50:35.883325 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:50:35.883763 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m06:50:35.884142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:36.289571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:36.292957 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 06:50:35.878956 => 06:50:36.292663
[0m06:50:36.293534 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m06:50:36.408195 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.54s]
[0m06:50:36.409761 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:50:36.410564 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:50:36.411164 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m06:50:36.412361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m06:50:36.412895 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:50:36.418700 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:50:36.420380 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 06:50:36.413211 => 06:50:36.420192
[0m06:50:36.421051 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:50:36.424305 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:50:36.425597 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:50:36.425979 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m06:50:36.426377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:36.835679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:36.838134 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 06:50:36.421486 => 06:50:36.837843
[0m06:50:36.838693 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m06:50:36.983671 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.57s]
[0m06:50:36.985524 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:50:36.986446 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:50:36.987188 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m06:50:36.989030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m06:50:36.989730 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:50:36.996715 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:50:36.999584 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 06:50:36.990187 => 06:50:36.999261
[0m06:50:37.000078 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:50:37.002937 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:50:37.004437 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:50:37.004813 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m06:50:37.005178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:37.491483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:37.495301 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 06:50:37.000385 => 06:50:37.494938
[0m06:50:37.495930 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m06:50:37.646444 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.66s]
[0m06:50:37.647952 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:50:37.648635 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:50:37.649164 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m06:50:37.650162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m06:50:37.650625 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:50:37.658746 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:50:37.660305 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 06:50:37.650961 => 06:50:37.660073
[0m06:50:37.660680 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:50:37.663142 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:50:37.664351 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:50:37.664729 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m06:50:37.665047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:38.086250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:38.090249 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 06:50:37.660935 => 06:50:38.089886
[0m06:50:38.090882 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m06:50:38.293576 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.64s]
[0m06:50:38.294160 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:50:38.294381 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:50:38.294620 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m06:50:38.295035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m06:50:38.295243 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:50:38.297449 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:50:38.298200 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 06:50:38.295373 => 06:50:38.298110
[0m06:50:38.298374 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:50:38.299535 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:50:38.300445 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:50:38.300658 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m06:50:38.300823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:39.015454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:39.019287 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 06:50:38.298494 => 06:50:39.018928
[0m06:50:39.019921 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m06:50:39.147898 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.85s]
[0m06:50:39.149227 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:50:39.151664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:50:39.152078 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m06:50:39.152589 [info ] [MainThread]: 
[0m06:50:39.153219 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m06:50:39.154936 [debug] [MainThread]: Command end result
[0m06:50:39.164950 [info ] [MainThread]: 
[0m06:50:39.165408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:50:39.165633 [info ] [MainThread]: 
[0m06:50:39.165914 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m06:50:39.166755 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.296473, "process_user_time": 2.930327, "process_kernel_time": 0.137015, "process_mem_max_rss": "218000", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m06:50:39.167183 [debug] [MainThread]: Command `dbt test` succeeded at 06:50:39.167075 after 10.30 seconds
[0m06:50:39.167466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92232990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914105f0>]}
[0m06:50:39.167753 [debug] [MainThread]: Flushing usage events
[0m06:50:41.714641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c199190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c198350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1991f0>]}


============================== 06:50:41.717664 | 6e5adafe-7367-497f-b4f9-3938d9d6df44 ==============================
[0m06:50:41.717664 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:50:41.718101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'profiles_dir': '/opt/airflow/dbt/final_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:50:42.080927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938ce660>]}
[0m06:50:42.129401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c191070>]}
[0m06:50:42.129742 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:50:42.132897 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:50:42.151478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:42.151637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:42.153852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff770cfbc0>]}
[0m06:50:42.159948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76ee09b0>]}
[0m06:50:42.160135 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:50:42.160459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77993830>]}
[0m06:50:42.161151 [info ] [MainThread]: 
[0m06:50:42.161520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:50:42.162023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:50:42.166947 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:50:42.167105 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:50:42.167252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:42.610627 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m06:50:42.613468 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:50:43.444378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m06:50:43.454527 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:50:43.455261 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:50:43.455747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:45.225947 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m06:50:45.228490 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:50:45.368408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m06:50:45.372167 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:50:45.372846 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:50:45.373735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:45.781927 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:50:45.784834 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:50:45.917241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m06:50:45.921734 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:50:45.922325 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:50:45.922753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:50:47.273442 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:50:47.276298 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:50:48.283799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76e3e660>]}
[0m06:50:48.285235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:50:48.286456 [info ] [MainThread]: 
[0m06:50:48.297269 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:50:48.298049 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:50:48.300990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:50:48.301443 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:50:48.307863 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:50:48.301706 => 06:50:48.307673
[0m06:50:48.308218 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:50:48.339900 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:48.340157 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:50:48.340351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:48.817562 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:50:48.829253 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:48.829994 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:50:48.923894 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:48.933780 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:48.934515 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:50:49.075781 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:49.105302 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:49.105873 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:50:50.547727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:50:50.549863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:50.550178 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:50:50.650636 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:50:50.653960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:50.654344 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:50:50.771404 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:50.776973 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:50.777694 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:50:50.885274 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:50:50.893072 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:50.893864 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:50:50.997277 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:50:51.007055 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:51.007669 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:50:51.109005 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:50:51.119970 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:51.123410 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:51.123837 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:50:51.252560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:51.253469 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:51.254179 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:50:51.881198 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m06:50:51.882270 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:50:51.882855 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m06:50:52.290412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:50:52.314528 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:50:48.308432 => 06:50:52.314307
[0m06:50:52.314927 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:50:52.433887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e5adafe-7367-497f-b4f9-3938d9d6df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b2b0e0>]}
[0m06:50:52.435250 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 0[0m in 4.13s]
[0m06:50:52.436289 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:50:52.438430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:50:52.438786 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:50:52.439217 [info ] [MainThread]: 
[0m06:50:52.439566 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m06:50:52.440268 [debug] [MainThread]: Command end result
[0m06:50:52.448852 [info ] [MainThread]: 
[0m06:50:52.449305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:50:52.449591 [info ] [MainThread]: 
[0m06:50:52.449921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:50:52.450603 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.757894, "process_user_time": 2.629692, "process_kernel_time": 0.117986, "process_mem_max_rss": "217936", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m06:50:52.450978 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:50:52.450898 after 10.76 seconds
[0m06:50:52.451251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c736960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c36db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76adae10>]}
[0m06:50:52.451540 [debug] [MainThread]: Flushing usage events
[0m06:55:17.411189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7a91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aade450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7a85f0>]}


============================== 06:55:17.414174 | b2eb4f8e-cff8-4818-a289-76e39b201bcf ==============================
[0m06:55:17.414174 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:55:17.414581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/final_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:55:17.752506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69986ab0>]}
[0m06:55:17.798769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69986ab0>]}
[0m06:55:17.799116 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:55:17.802260 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:55:17.830138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:55:17.830405 [debug] [MainThread]: Partial parsing: updated file: energy_consumption_analytics://models/output/weekday_weekend.sql
[0m06:55:17.989265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6896cd70>]}
[0m06:55:17.994975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff694697f0>]}
[0m06:55:17.995180 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:55:17.995519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa98380>]}
[0m06:55:17.996338 [info ] [MainThread]: 
[0m06:55:17.996746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:55:17.997352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:55:18.002461 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:55:18.002617 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:55:18.002764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:55:18.530935 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:55:18.533098 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:55:19.241672 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:55:19.242020 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:55:19.242220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:19.616608 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m06:55:19.619560 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:55:19.740134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_analytics)
[0m06:55:19.751070 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:55:19.751715 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:55:19.752202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:20.161878 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:20.164685 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:55:20.283849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:55:20.286901 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:55:20.287206 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:55:20.287452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:20.713654 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:55:20.716331 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:55:20.839068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics_staging)
[0m06:55:20.843516 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:55:20.844015 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:55:20.844423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:21.239602 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:55:21.242481 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:55:21.376121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68933a10>]}
[0m06:55:21.377645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:55:21.379003 [info ] [MainThread]: 
[0m06:55:21.391406 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.stg_eia
[0m06:55:21.393786 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_staging.stg_eia .......................... [RUN]
[0m06:55:21.394740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now model.energy_consumption_analytics.stg_eia)
[0m06:55:21.395279 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.stg_eia
[0m06:55:21.401853 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.stg_eia"
[0m06:55:21.406688 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (compile): 06:55:21.395542 => 06:55:21.406442
[0m06:55:21.407044 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.stg_eia
[0m06:55:21.423646 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.stg_eia"
[0m06:55:21.424506 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.stg_eia"
[0m06:55:21.424736 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.stg_eia"} */
create or replace   view USER_DB_MONKEY.analytics_staging.stg_eia
  
   as (
    

SELECT 
    REGION,
    DATE,
    SERIES,
    VALUE
FROM USER_DB_MONKEY.staging.RTO_REGION_HOURLY_STAGING
  );
[0m06:55:21.424926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:22.120834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:22.143094 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.stg_eia (execute): 06:55:21.407215 => 06:55:22.142915
[0m06:55:22.143553 [debug] [Thread-1 (]: On model.energy_consumption_analytics.stg_eia: Close
[0m06:55:22.258913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6896ca40>]}
[0m06:55:22.260276 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_staging.stg_eia ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m06:55:22.262010 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.stg_eia
[0m06:55:22.263619 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.moving_avg
[0m06:55:22.264306 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.moving_avg .............................. [RUN]
[0m06:55:22.265569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.stg_eia, now model.energy_consumption_analytics.moving_avg)
[0m06:55:22.266119 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.moving_avg
[0m06:55:22.274417 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.moving_avg"
[0m06:55:22.276263 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (compile): 06:55:22.266445 => 06:55:22.275999
[0m06:55:22.276720 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.moving_avg
[0m06:55:22.294231 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.moving_avg"
[0m06:55:22.295623 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.moving_avg"
[0m06:55:22.295907 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.moving_avg"} */
create or replace transient table USER_DB_MONKEY.analytics.moving_avg
         as
        (with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_ma as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        avg(VALUE) over (
            partition by REGION, SERIES
            order by DATE
            rows between 6 preceding and current row
        ) as value_ma_7
    from temp
)

select *
from with_ma
        );
[0m06:55:22.296257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:23.657945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:23.662401 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.moving_avg (execute): 06:55:22.277032 => 06:55:23.662127
[0m06:55:23.663205 [debug] [Thread-1 (]: On model.energy_consumption_analytics.moving_avg: Close
[0m06:55:23.782777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69152480>]}
[0m06:55:23.783159 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.52s]
[0m06:55:23.783574 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.moving_avg
[0m06:55:23.783777 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.region_comp
[0m06:55:23.783992 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.region_comp ............................. [RUN]
[0m06:55:23.784375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.moving_avg, now model.energy_consumption_analytics.region_comp)
[0m06:55:23.784540 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.region_comp
[0m06:55:23.786034 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.region_comp"
[0m06:55:23.786664 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (compile): 06:55:23.784653 => 06:55:23.786579
[0m06:55:23.786829 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.region_comp
[0m06:55:23.787928 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.region_comp"
[0m06:55:23.788714 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.region_comp"
[0m06:55:23.788920 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.region_comp"} */
create or replace transient table USER_DB_MONKEY.analytics.region_comp
         as
        (

with temp as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

stats as (
    select
        DATE,
        SERIES,
        min(VALUE) as value_min,
        max(VALUE) as value_max,
        avg(VALUE) as value_avg
    from temp
    group by DATE, SERIES
),

ranked as (
    select
        b.REGION,
        b.DATE,
        b.SERIES,
        b.VALUE,
        rank() over (
            partition by b.DATE, b.SERIES
            order by b.VALUE desc
        ) as value_rank_desc
    from temp b
)

select
    r.REGION,
    r.DATE,
    r.SERIES,
    r.VALUE,
    r.value_rank_desc,
    s.value_min,
    s.value_max,
    s.value_avg
from ranked r
join stats s
  on r.DATE  = s.DATE
 and r.SERIES = s.SERIES
        );
[0m06:55:23.789132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:25.089199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:25.093368 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.region_comp (execute): 06:55:23.786938 => 06:55:25.093149
[0m06:55:25.093914 [debug] [Thread-1 (]: On model.energy_consumption_analytics.region_comp: Close
[0m06:55:25.225208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68931ac0>]}
[0m06:55:25.226516 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.region_comp ........................ [[32mSUCCESS 1[0m in 1.44s]
[0m06:55:25.228408 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.region_comp
[0m06:55:25.229043 [debug] [Thread-1 (]: Began running node model.energy_consumption_analytics.weekday_weekend
[0m06:55:25.229613 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.weekday_weekend ......................... [RUN]
[0m06:55:25.230812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_consumption_analytics.region_comp, now model.energy_consumption_analytics.weekday_weekend)
[0m06:55:25.231481 [debug] [Thread-1 (]: Began compiling node model.energy_consumption_analytics.weekday_weekend
[0m06:55:25.236037 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:55:25.237887 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (compile): 06:55:25.231901 => 06:55:25.237706
[0m06:55:25.238268 [debug] [Thread-1 (]: Began executing node model.energy_consumption_analytics.weekday_weekend
[0m06:55:25.241552 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_consumption_analytics.weekday_weekend"
[0m06:55:25.243835 [debug] [Thread-1 (]: Using snowflake connection "model.energy_consumption_analytics.weekday_weekend"
[0m06:55:25.244302 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_consumption_analytics.weekday_weekend"} */
create or replace transient table USER_DB_MONKEY.analytics.weekday_weekend
         as
        (-- models/output/rto_weekday_weekend_summary.sql


with base as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE
    from USER_DB_MONKEY.analytics_staging.stg_eia
),

with_flags as (
    select
        REGION,
        DATE,
        SERIES,
        VALUE,
        case
            when dayofweek(DATE) in (1, 7) then 'WEEKEND'
            else 'WEEKDAY'
        end as weekday_weekend
    from base
)

select
    REGION,
    SERIES,
    weekday_weekend,
    avg(VALUE) as avg_value,
    min(VALUE) as min_value,
    max(VALUE) as max_value
from with_flags
group by REGION, SERIES, weekday_weekend
        );
[0m06:55:25.244749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:27.240979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:55:27.245703 [debug] [Thread-1 (]: Timing info for model.energy_consumption_analytics.weekday_weekend (execute): 06:55:25.238525 => 06:55:27.245415
[0m06:55:27.246399 [debug] [Thread-1 (]: On model.energy_consumption_analytics.weekday_weekend: Close
[0m06:55:27.374906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2eb4f8e-cff8-4818-a289-76e39b201bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69162330>]}
[0m06:55:27.376261 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.weekday_weekend .................... [[32mSUCCESS 1[0m in 2.14s]
[0m06:55:27.378237 [debug] [Thread-1 (]: Finished running node model.energy_consumption_analytics.weekday_weekend
[0m06:55:27.380871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:55:27.381422 [debug] [MainThread]: Connection 'model.energy_consumption_analytics.weekday_weekend' was properly closed.
[0m06:55:27.382060 [info ] [MainThread]: 
[0m06:55:27.382890 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m06:55:27.383998 [debug] [MainThread]: Command end result
[0m06:55:27.398139 [info ] [MainThread]: 
[0m06:55:27.398911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:55:27.399280 [info ] [MainThread]: 
[0m06:55:27.399683 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:55:27.400706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.011776, "process_user_time": 2.854144, "process_kernel_time": 0.130052, "process_mem_max_rss": "223900", "process_out_blocks": "2769", "process_in_blocks": "0"}
[0m06:55:27.401237 [debug] [MainThread]: Command `dbt run` succeeded at 06:55:27.401133 after 10.01 seconds
[0m06:55:27.401560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b794560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a86ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b9e360>]}
[0m06:55:27.401867 [debug] [MainThread]: Flushing usage events
[0m06:55:32.913502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82599df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8259a840>]}


============================== 06:55:32.916174 | 3fffcdfb-046b-44cc-8060-87a142b6dfa6 ==============================
[0m06:55:32.916174 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:55:32.916581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/final_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:55:33.253611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61488ef0>]}
[0m06:55:33.301403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62c7fe90>]}
[0m06:55:33.301706 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:55:33.304853 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:55:33.329093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:55:33.329250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:55:33.331378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff614897f0>]}
[0m06:55:33.336634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61300b00>]}
[0m06:55:33.336813 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:55:33.337110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff616d6cc0>]}
[0m06:55:33.337945 [info ] [MainThread]: 
[0m06:55:33.338331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:55:33.338952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY_analytics_staging'
[0m06:55:33.344384 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:55:33.344547 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:55:33.344673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:55:34.307374 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:55:34.310066 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:55:34.504745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now list_USER_DB_MONKEY_analytics)
[0m06:55:34.508809 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:55:34.509318 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:55:34.509883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:34.996903 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:34.999633 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:55:35.213669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_snapshot)
[0m06:55:35.219290 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:55:35.219832 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:55:35.220245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:35.601912 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:55:35.603980 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:55:35.757673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fffcdfb-046b-44cc-8060-87a142b6dfa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6131fbc0>]}
[0m06:55:35.759067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:55:35.760070 [info ] [MainThread]: 
[0m06:55:35.771633 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:55:35.772171 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_eia_SERIES__D__DF__NG__TI ............... [RUN]
[0m06:55:35.773377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6)
[0m06:55:35.773908 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:55:35.789248 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:55:35.791610 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (compile): 06:55:35.774246 => 06:55:35.791448
[0m06:55:35.791901 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:55:35.803827 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:55:35.805034 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"
[0m06:55:35.805241 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        SERIES as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics_staging.stg_eia
    group by SERIES

)

select *
from all_values
where value_field not in (
    'D','DF','NG','TI'
)



      
    ) dbt_internal_test
[0m06:55:35.805419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:36.413318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:36.422109 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6 (execute): 06:55:35.792110 => 06:55:36.421717
[0m06:55:36.422836 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6: Close
[0m06:55:36.556761 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_eia_SERIES__D__DF__NG__TI ..................... [[32mPASS[0m in 0.78s]
[0m06:55:36.557449 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6
[0m06:55:36.557739 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:55:36.557976 [info ] [Thread-1 (]: 2 of 11 START test accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND  [RUN]
[0m06:55:36.558396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_stg_eia_SERIES__D__DF__NG__TI.67a89d4bf6, now test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501)
[0m06:55:36.558590 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:55:36.561132 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:55:36.561736 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (compile): 06:55:36.558699 => 06:55:36.561639
[0m06:55:36.561893 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:55:36.562948 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:55:36.563634 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"
[0m06:55:36.563816 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday_weekend as value_field,
        count(*) as n_records

    from USER_DB_MONKEY.analytics.weekday_weekend
    group by weekday_weekend

)

select *
from all_values
where value_field not in (
    'WEEKDAY','WEEKEND'
)



      
    ) dbt_internal_test
[0m06:55:36.564046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:37.036868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:37.038643 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501 (execute): 06:55:36.561994 => 06:55:37.038496
[0m06:55:37.038922 [debug] [Thread-1 (]: On test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501: Close
[0m06:55:37.162151 [info ] [Thread-1 (]: 2 of 11 PASS accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND . [[32mPASS[0m in 0.60s]
[0m06:55:37.163760 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501
[0m06:55:37.164339 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:55:37.164836 [info ] [Thread-1 (]: 3 of 11 START test not_null_moving_avg_DATE .................................... [RUN]
[0m06:55:37.165741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.accepted_values_weekday_weekend_weekday_weekend__WEEKDAY__WEEKEND.22d74cc501, now test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423)
[0m06:55:37.166144 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:55:37.170841 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:55:37.171887 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (compile): 06:55:37.166594 => 06:55:37.171725
[0m06:55:37.172146 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:55:37.173728 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:55:37.174560 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"
[0m06:55:37.174736 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics.moving_avg
where DATE is null



      
    ) dbt_internal_test
[0m06:55:37.174886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:37.939109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:37.943184 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423 (execute): 06:55:37.172406 => 06:55:37.942787
[0m06:55:37.943840 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423: Close
[0m06:55:38.107080 [info ] [Thread-1 (]: 3 of 11 PASS not_null_moving_avg_DATE .......................................... [[32mPASS[0m in 0.94s]
[0m06:55:38.108965 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423
[0m06:55:38.109589 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:55:38.109997 [info ] [Thread-1 (]: 4 of 11 START test not_null_moving_avg_REGION .................................. [RUN]
[0m06:55:38.111149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_DATE.4d1f528423, now test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d)
[0m06:55:38.111694 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:55:38.117823 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:55:38.120764 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (compile): 06:55:38.111991 => 06:55:38.120374
[0m06:55:38.121407 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:55:38.124029 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:55:38.125606 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"
[0m06:55:38.125967 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics.moving_avg
where REGION is null



      
    ) dbt_internal_test
[0m06:55:38.126344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:38.681180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:38.683277 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d (execute): 06:55:38.121725 => 06:55:38.683096
[0m06:55:38.683572 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d: Close
[0m06:55:38.816705 [info ] [Thread-1 (]: 4 of 11 PASS not_null_moving_avg_REGION ........................................ [[32mPASS[0m in 0.71s]
[0m06:55:38.818383 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d
[0m06:55:38.819096 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:55:38.819674 [info ] [Thread-1 (]: 5 of 11 START test not_null_moving_avg_SERIES .................................. [RUN]
[0m06:55:38.820916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_REGION.b2a9a5588d, now test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e)
[0m06:55:38.821457 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:55:38.830477 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:55:38.832229 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (compile): 06:55:38.821816 => 06:55:38.831945
[0m06:55:38.832664 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:55:38.835415 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:55:38.837206 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"
[0m06:55:38.837627 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics.moving_avg
where SERIES is null



      
    ) dbt_internal_test
[0m06:55:38.838040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:39.341484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:39.344622 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e (execute): 06:55:38.832943 => 06:55:39.344371
[0m06:55:39.345163 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e: Close
[0m06:55:39.516551 [info ] [Thread-1 (]: 5 of 11 PASS not_null_moving_avg_SERIES ........................................ [[32mPASS[0m in 0.70s]
[0m06:55:39.518229 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e
[0m06:55:39.518894 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:55:39.519476 [info ] [Thread-1 (]: 6 of 11 START test not_null_moving_avg_VALUE ................................... [RUN]
[0m06:55:39.520725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_SERIES.9698019e0e, now test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e)
[0m06:55:39.521317 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:55:39.527897 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:55:39.529913 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (compile): 06:55:39.521680 => 06:55:39.529460
[0m06:55:39.530497 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:55:39.533583 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:55:39.535109 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"
[0m06:55:39.535459 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics.moving_avg
where VALUE is null



      
    ) dbt_internal_test
[0m06:55:39.535779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:40.557719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:40.560729 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e (execute): 06:55:39.530787 => 06:55:40.560484
[0m06:55:40.561316 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e: Close
[0m06:55:40.684706 [info ] [Thread-1 (]: 6 of 11 PASS not_null_moving_avg_VALUE ......................................... [[32mPASS[0m in 1.16s]
[0m06:55:40.685585 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e
[0m06:55:40.685945 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:55:40.686348 [info ] [Thread-1 (]: 7 of 11 START test not_null_moving_avg_value_ma_7 .............................. [RUN]
[0m06:55:40.687180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_VALUE.57e0791a5e, now test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e)
[0m06:55:40.687572 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:55:40.691324 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:55:40.692452 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (compile): 06:55:40.687761 => 06:55:40.692309
[0m06:55:40.692706 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:55:40.694500 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:55:40.695717 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"
[0m06:55:40.696049 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_ma_7
from USER_DB_MONKEY.analytics.moving_avg
where value_ma_7 is null



      
    ) dbt_internal_test
[0m06:55:40.696333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:41.170167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:41.173488 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e (execute): 06:55:40.692859 => 06:55:41.173203
[0m06:55:41.173991 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e: Close
[0m06:55:41.343914 [info ] [Thread-1 (]: 7 of 11 PASS not_null_moving_avg_value_ma_7 .................................... [[32mPASS[0m in 0.66s]
[0m06:55:41.345487 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e
[0m06:55:41.346180 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:55:41.346779 [info ] [Thread-1 (]: 8 of 11 START test not_null_stg_eia_DATE ....................................... [RUN]
[0m06:55:41.348245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_moving_avg_value_ma_7.855ad0a76e, now test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c)
[0m06:55:41.348960 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:55:41.355096 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:55:41.358109 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (compile): 06:55:41.349381 => 06:55:41.357715
[0m06:55:41.358596 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:55:41.361653 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:55:41.363051 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"
[0m06:55:41.363433 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select DATE
from USER_DB_MONKEY.analytics_staging.stg_eia
where DATE is null



      
    ) dbt_internal_test
[0m06:55:41.363874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:41.855191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:41.858807 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c (execute): 06:55:41.358887 => 06:55:41.858477
[0m06:55:41.859441 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c: Close
[0m06:55:42.286306 [info ] [Thread-1 (]: 8 of 11 PASS not_null_stg_eia_DATE ............................................. [[32mPASS[0m in 0.94s]
[0m06:55:42.287862 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c
[0m06:55:42.288578 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:55:42.289173 [info ] [Thread-1 (]: 9 of 11 START test not_null_stg_eia_REGION ..................................... [RUN]
[0m06:55:42.290518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_DATE.e8e1b0c97c, now test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191)
[0m06:55:42.291115 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:55:42.297073 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:55:42.299834 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (compile): 06:55:42.291482 => 06:55:42.299503
[0m06:55:42.300418 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:55:42.303511 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:55:42.305203 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"
[0m06:55:42.305567 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select REGION
from USER_DB_MONKEY.analytics_staging.stg_eia
where REGION is null



      
    ) dbt_internal_test
[0m06:55:42.305908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:42.702774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:42.706612 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191 (execute): 06:55:42.300778 => 06:55:42.706213
[0m06:55:42.707338 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191: Close
[0m06:55:42.839714 [info ] [Thread-1 (]: 9 of 11 PASS not_null_stg_eia_REGION ........................................... [[32mPASS[0m in 0.55s]
[0m06:55:42.841688 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191
[0m06:55:42.842444 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:55:42.843024 [info ] [Thread-1 (]: 10 of 11 START test not_null_stg_eia_SERIES .................................... [RUN]
[0m06:55:42.844237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_REGION.928d04c191, now test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3)
[0m06:55:42.844722 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:55:42.853303 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:55:42.855918 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (compile): 06:55:42.845188 => 06:55:42.855620
[0m06:55:42.856438 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:55:42.859270 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:55:42.860925 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"
[0m06:55:42.861392 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SERIES
from USER_DB_MONKEY.analytics_staging.stg_eia
where SERIES is null



      
    ) dbt_internal_test
[0m06:55:42.861752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:43.380948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:43.382695 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3 (execute): 06:55:42.856736 => 06:55:43.382527
[0m06:55:43.383028 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3: Close
[0m06:55:43.519248 [info ] [Thread-1 (]: 10 of 11 PASS not_null_stg_eia_SERIES .......................................... [[32mPASS[0m in 0.68s]
[0m06:55:43.520877 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3
[0m06:55:43.521692 [debug] [Thread-1 (]: Began running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:55:43.522338 [info ] [Thread-1 (]: 11 of 11 START test not_null_stg_eia_VALUE ..................................... [RUN]
[0m06:55:43.523727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_consumption_analytics.not_null_stg_eia_SERIES.de96d80dc3, now test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb)
[0m06:55:43.524439 [debug] [Thread-1 (]: Began compiling node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:55:43.530886 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:55:43.533478 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (compile): 06:55:43.524832 => 06:55:43.533163
[0m06:55:43.533979 [debug] [Thread-1 (]: Began executing node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:55:43.536845 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:55:43.538518 [debug] [Thread-1 (]: Using snowflake connection "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"
[0m06:55:43.538877 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VALUE
from USER_DB_MONKEY.analytics_staging.stg_eia
where VALUE is null



      
    ) dbt_internal_test
[0m06:55:43.539211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:43.919257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:43.922457 [debug] [Thread-1 (]: Timing info for test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb (execute): 06:55:43.534352 => 06:55:43.922111
[0m06:55:43.923181 [debug] [Thread-1 (]: On test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb: Close
[0m06:55:44.054799 [info ] [Thread-1 (]: 11 of 11 PASS not_null_stg_eia_VALUE ........................................... [[32mPASS[0m in 0.53s]
[0m06:55:44.056451 [debug] [Thread-1 (]: Finished running node test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb
[0m06:55:44.059306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:55:44.059808 [debug] [MainThread]: Connection 'test.energy_consumption_analytics.not_null_stg_eia_VALUE.ae09281feb' was properly closed.
[0m06:55:44.060334 [info ] [MainThread]: 
[0m06:55:44.061070 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m06:55:44.063130 [debug] [MainThread]: Command end result
[0m06:55:44.076259 [info ] [MainThread]: 
[0m06:55:44.077130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:55:44.077547 [info ] [MainThread]: 
[0m06:55:44.078108 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m06:55:44.079067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.185575, "process_user_time": 2.937316, "process_kernel_time": 0.137014, "process_mem_max_rss": "217500", "process_out_blocks": "1930", "process_in_blocks": "0"}
[0m06:55:44.079466 [debug] [MainThread]: Command `dbt test` succeeded at 06:55:44.079378 after 11.19 seconds
[0m06:55:44.079791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c8be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff613a21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82599190>]}
[0m06:55:44.080141 [debug] [MainThread]: Flushing usage events
[0m06:55:47.030752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa646a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f7fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6468c20>]}


============================== 06:55:47.033414 | 9c84ee53-d030-4a4c-abee-50e5d5ff5f8e ==============================
[0m06:55:47.033414 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:55:47.033822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/final_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot --project-dir /opt/airflow/dbt/final_project --profiles-dir /opt/airflow/dbt/final_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:55:47.369477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8585a9c0>]}
[0m06:55:47.414998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85104c80>]}
[0m06:55:47.415307 [info ] [MainThread]: Registered adapter: snowflake=1.7.0
[0m06:55:47.418412 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:55:47.443166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:55:47.443333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:55:47.445441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856379b0>]}
[0m06:55:47.450147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851ccad0>]}
[0m06:55:47.450332 [info ] [MainThread]: Found 4 models, 11 tests, 1 snapshot, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m06:55:47.450640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852e6cc0>]}
[0m06:55:47.451361 [info ] [MainThread]: 
[0m06:55:47.451759 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:55:47.452254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_MONKEY'
[0m06:55:47.457463 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY"
[0m06:55:47.457619 [debug] [ThreadPool]: On list_USER_DB_MONKEY: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY"} */
show terse schemas in database USER_DB_MONKEY
    limit 10000
[0m06:55:47.457742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:55:48.787046 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m06:55:48.788912 [debug] [ThreadPool]: On list_USER_DB_MONKEY: Close
[0m06:55:48.969893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY, now list_USER_DB_MONKEY_snapshot)
[0m06:55:48.980096 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_snapshot"
[0m06:55:48.980783 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_snapshot"} */
show terse objects in USER_DB_MONKEY.snapshot limit 10000
[0m06:55:48.981313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:49.438762 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:55:49.441693 [debug] [ThreadPool]: On list_USER_DB_MONKEY_snapshot: Close
[0m06:55:49.588896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_snapshot, now list_USER_DB_MONKEY_analytics)
[0m06:55:49.593178 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics"
[0m06:55:49.593830 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics"} */
show terse objects in USER_DB_MONKEY.analytics limit 10000
[0m06:55:49.594875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:50.014509 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:50.017703 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics: Close
[0m06:55:50.211985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics, now list_USER_DB_MONKEY_analytics_staging)
[0m06:55:50.216683 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_MONKEY_analytics_staging"
[0m06:55:50.217281 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_USER_DB_MONKEY_analytics_staging"} */
show terse objects in USER_DB_MONKEY.analytics_staging limit 10000
[0m06:55:50.217809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:55:50.999355 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:55:51.000740 [debug] [ThreadPool]: On list_USER_DB_MONKEY_analytics_staging: Close
[0m06:55:51.132071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852d9280>]}
[0m06:55:51.133400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:55:51.134493 [info ] [MainThread]: 
[0m06:55:51.145274 [debug] [Thread-1 (]: Began running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:55:51.145658 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.eia_rto_hourly_snapshot ......................... [RUN]
[0m06:55:51.146750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_MONKEY_analytics_staging, now snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot)
[0m06:55:51.147296 [debug] [Thread-1 (]: Began compiling node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:55:51.153542 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (compile): 06:55:51.147580 => 06:55:51.153403
[0m06:55:51.153769 [debug] [Thread-1 (]: Began executing node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:55:51.184417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:51.184779 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
select * from (
        select VALUE from (
                



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:55:51.185018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:55:51.550330 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:55:51.561786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:51.562722 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:55:51.662439 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:51.667687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:51.668103 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:55:51.752701 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:51.772337 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:51.772645 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
create or replace temporary table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        



select
  REGION,
  DATE,
  SERIES,
  VALUE,
  REGION || SERIES || to_char(DATE, 'YYYY-MM-DD HH24:MI:SS') as ROW_KEY,
  current_timestamp() as updated_at
from USER_DB_MONKEY.analytics_staging.stg_eia


    ),

    snapshotted_data as (

        select *,
            ROW_KEY as dbt_unique_key

        from "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(ROW_KEY as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            ROW_KEY as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."VALUE" != source_data."VALUE"
        or
        (
            ((snapshotted_data."VALUE" is null) and not (source_data."VALUE" is null))
            or
            ((not snapshotted_data."VALUE" is null) and (source_data."VALUE" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:55:53.252658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:55:53.258842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.259509 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:55:53.351966 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:55:53.357286 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.357891 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:55:53.459822 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:53.465542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.466193 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:55:53.566002 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:55:53.574803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.575712 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT"
[0m06:55:53.670707 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:55:53.681210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.681811 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
describe table "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp"
[0m06:55:53.769316 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.0 seconds
[0m06:55:53.780436 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.784218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.784845 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
BEGIN
[0m06:55:53.904152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:53.904970 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:53.905473 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
merge into "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_MONKEY"."SNAPSHOT"."EIA_RTO_HOURLY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("REGION", "DATE", "SERIES", "VALUE", "ROW_KEY", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:55:54.682253 [debug] [Thread-1 (]: SQL status: SUCCESS 72 in 1.0 seconds
[0m06:55:54.683087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"
[0m06:55:54.683593 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot"} */
COMMIT
[0m06:55:55.093747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:55:55.114636 [debug] [Thread-1 (]: Timing info for snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot (execute): 06:55:51.153913 => 06:55:55.114416
[0m06:55:55.115062 [debug] [Thread-1 (]: On snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot: Close
[0m06:55:55.264131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c84ee53-d030-4a4c-abee-50e5d5ff5f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84409eb0>]}
[0m06:55:55.266440 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.eia_rto_hourly_snapshot ......................... [[32mSUCCESS 72[0m in 4.12s]
[0m06:55:55.268750 [debug] [Thread-1 (]: Finished running node snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot
[0m06:55:55.272225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:55:55.272760 [debug] [MainThread]: Connection 'snapshot.energy_consumption_analytics.eia_rto_hourly_snapshot' was properly closed.
[0m06:55:55.273239 [info ] [MainThread]: 
[0m06:55:55.274108 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m06:55:55.274907 [debug] [MainThread]: Command end result
[0m06:55:55.292568 [info ] [MainThread]: 
[0m06:55:55.293889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:55:55.294599 [info ] [MainThread]: 
[0m06:55:55.295166 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:55:55.296867 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.285604, "process_user_time": 2.590182, "process_kernel_time": 0.119146, "process_mem_max_rss": "218256", "process_out_blocks": "1863", "process_in_blocks": "0"}
[0m06:55:55.297532 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:55:55.297397 after 8.29 seconds
[0m06:55:55.297974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f7fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6747830>]}
[0m06:55:55.298356 [debug] [MainThread]: Flushing usage events
